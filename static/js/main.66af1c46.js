/*! For license information please see main.66af1c46.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),a=n(43),s=n(950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(i(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),T=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var N=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var R=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===R?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case k:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case T:return(e.displayName||"Context")+".Provider";case w:return(e._context.displayName||"Context")+".Consumer";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return O(e(t))}catch(es){}}return null}var P=Array.isArray,D=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},F=[],U=-1;function j(e){return{current:e}}function z(e){0>U||(e.current=F[U],F[U]=null,U--)}function V(e,t){U++,F[U]=e.current,e.current=t}var B=j(null),H=j(null),W=j(null),q=j(null);function $(e,t){switch(V(W,t),V(H,e),V(B,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?sh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=ih(t=sh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(B),V(B,e)}function G(){z(B),z(H),z(W)}function K(e){null!==e.memoizedState&&V(q,e);var t=B.current,n=ih(t,e.type);t!==n&&(V(H,e),V(B,n))}function Q(e){H.current===e&&(z(B),z(H)),q.current===e&&(z(q),Qh._currentValue=M)}var X=Object.prototype.hasOwnProperty,Y=r.unstable_scheduleCallback,J=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ae=r.unstable_UserBlockingPriority,se=r.unstable_NormalPriority,ie=r.unstable_LowPriority,oe=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,he=null;function fe(e){if("function"===typeof le&&ce(e),he&&"function"===typeof he.setStrictMode)try{he.setStrictMode(ue,e)}catch(t){}}var de=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(pe(e)/me|0)|0},pe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~s)?a=ye(r):0!==(i&=o)?a=ye(i):n||0!==(n=o&~e)&&(a=ye(n)):0!==(o=r&~s)?a=ye(o):0!==i?a=ye(i):n||0!==(n=r&~e)&&(a=ye(n)),0===a?0:0!==t&&t!==a&&0===(t&s)&&((s=a&-a)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:a}function we(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Te(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ee(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Se(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function ke(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _e(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function xe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-de(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ce(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-de(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Ae(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ne(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ie(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:hf(e.type)}var Re=Math.random().toString(36).slice(2),Oe="__reactFiber$"+Re,Pe="__reactProps$"+Re,De="__reactContainer$"+Re,Le="__reactEvents$"+Re,Me="__reactListeners$"+Re,Fe="__reactHandles$"+Re,Ue="__reactResources$"+Re,je="__reactMarker$"+Re;function ze(e){delete e[Oe],delete e[Pe],delete e[Le],delete e[Me],delete e[Fe]}function Ve(e){var t=e[Oe];if(t)return t;for(var n=e.parentNode;n;){if(t=n[De]||n[Oe]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=wh(e);null!==e;){if(n=e[Oe])return n;e=wh(e)}return t}n=(e=n).parentNode}return null}function Be(e){if(e=e[Oe]||e[De]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function He(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function We(e){var t=e[Ue];return t||(t=e[Ue]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function qe(e){e[je]=!0}var $e=new Set,Ge={};function Ke(e,t){Qe(e,t),Qe(e+"Capture",t)}function Qe(e,t){for(Ge[e]=t,e=0;e<t.length;e++)$e.add(t[e])}var Xe,Ye,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(a=t,X.call(et,a)||!X.call(Ze,a)&&(Je.test(a)?et[a]=!0:(Ze[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function at(e){if(void 0===Xe)try{throw Error()}catch(es){var t=es.stack.trim().match(/\n( *(at )?)/);Xe=t&&t[1]||"",Ye=-1<es.stack.indexOf("\n    at")?" (<anonymous>)":-1<es.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Xe+e+Ye}var st=!1;function it(e,t){if(!e||st)return"";st=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(es){var r=es}Reflect.construct(e,[],n)}else{try{n.call()}catch(a){r=a}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(i){if(i&&r&&"string"===typeof i.stack)return[i.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{st=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?at(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return at(e.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return it(e.type,!1);case 11:return it(e.type.render,!1);case 1:return it(e.type,!0);case 31:return at("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(es){return"\nError generating stack: "+es.message+"\n"+es.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function dt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function mt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,n,r,a,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?yt(e,i,ct(t)):null!=n?yt(e,i,ct(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=s&&(e.defaultChecked=!!s),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,n,r,a,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i)}function yt(e,t,n){"number"===t&&dt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(i(92));if(P(r)){if(1<r.length)throw Error(i(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function _t(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&kt(e,a,r)}else for(var s in t)t.hasOwnProperty(s)&&kt(e,s,t[s])}function xt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nt(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var It=null;function Rt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Pt=null;function Dt(e){var t=Be(e);if(t&&(e=t.stateNode)){var n=e[Pe]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[Pe]||null;if(!a)throw Error(i(90));gt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ft(r)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Lt=!1;function Mt(e,t,n){if(Lt)return e(t,n);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==Ot||null!==Pt)&&(Bc(),Ot&&(t=Ot,e=Pt,Pt=Ot=null,Dt(t),e)))for(t=0;t<e.length;t++)Dt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Pe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Ut=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),jt=!1;if(Ut)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){jt=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch(Lf){jt=!1}var Vt=null,Bt=null,Ht=null;function Wt(){if(Ht)return Ht;var e,t,n=Bt,r=n.length,a="value"in Vt?Vt.value:Vt.textContent,s=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[s-t];t++);return Ht=a.slice(e,1<t?1-t:void 0)}function qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function $t(){return!0}function Gt(){return!1}function Kt(e){function t(t,n,r,a,s){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?$t:Gt,this.isPropagationStopped=Gt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),t}var Qt,Xt,Yt,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Kt(Jt),en=f({},Jt,{view:0,detail:0}),tn=Kt(en),nn=f({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yt&&(Yt&&"mousemove"===e.type?(Qt=e.screenX-Yt.screenX,Xt=e.screenY-Yt.screenY):Xt=Qt=0,Yt=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Xt}}),rn=Kt(nn),an=Kt(f({},nn,{dataTransfer:0})),sn=Kt(f({},en,{relatedTarget:0})),on=Kt(f({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Kt(f({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Kt(f({},Jt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fn[e])&&!!t[e]}function pn(){return dn}var mn=Kt(f({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?hn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Kt(f({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Kt(f({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=Kt(f({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=Kt(f({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=Kt(f({},Jt,{newState:0,oldState:0})),Tn=[9,13,27,32],En=Ut&&"CompositionEvent"in window,Sn=null;Ut&&"documentMode"in document&&(Sn=document.documentMode);var kn=Ut&&"TextEvent"in window&&!Sn,_n=Ut&&(!En||Sn&&8<Sn&&11>=Sn),xn=String.fromCharCode(32),Cn=!1;function An(e,t){switch(e){case"keyup":return-1!==Tn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var In=!1;var Rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Rn[e.type]:"textarea"===t}function Pn(e,t,n,r){Ot?Pt?Pt.push(r):Pt=[r]:Ot=r,0<(t=qu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Dn=null,Ln=null;function Mn(e){Fu(e,0)}function Fn(e){if(ft(He(e)))return e}function Un(e,t){if("change"===e)return t}var jn=!1;if(Ut){var zn;if(Ut){var Vn="oninput"in document;if(!Vn){var Bn=document.createElement("div");Bn.setAttribute("oninput","return;"),Vn="function"===typeof Bn.oninput}zn=Vn}else zn=!1;jn=zn&&(!document.documentMode||9<document.documentMode)}function Hn(){Dn&&(Dn.detachEvent("onpropertychange",Wn),Ln=Dn=null)}function Wn(e){if("value"===e.propertyName&&Fn(Ln)){var t=[];Pn(t,Ln,e,Rt(e)),Mt(Mn,t)}}function qn(e,t,n){"focusin"===e?(Hn(),Ln=n,(Dn=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Hn()}function $n(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Ln)}function Gn(e,t){if("click"===e)return Fn(t)}function Kn(e,t){if("input"===e||"change"===e)return Fn(t)}var Qn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Xn(e,t){if(Qn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!X.call(t,a)||!Qn(e[a],t[a]))return!1}return!0}function Yn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jn(e,t){var n,r=Yn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Yn(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=dt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=dt((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Ut&&"documentMode"in document&&11>=document.documentMode,rr=null,ar=null,sr=null,ir=!1;function or(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ir||null==rr||rr!==dt(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Xn(sr,r)||(sr=r,0<(r=qu(ar,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},hr={};function fr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return ur[e]=n[t];return e}Ut&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var dr=fr("animationend"),pr=fr("animationiteration"),mr=fr("animationstart"),gr=fr("transitionrun"),vr=fr("transitionstart"),yr=fr("transitioncancel"),br=fr("transitionend"),wr=new Map,Tr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Er(e,t){wr.set(e,t),Ke(t,[e])}Tr.push("scrollEnd");var Sr=new WeakMap;function kr(e,t){if("object"===typeof e&&null!==e){var n=Sr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Sr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var _r=[],xr=0,Cr=0;function Ar(){for(var e=xr,t=Cr=xr=0;t<e;){var n=_r[t];_r[t++]=null;var r=_r[t];_r[t++]=null;var a=_r[t];_r[t++]=null;var s=_r[t];if(_r[t++]=null,null!==r&&null!==a){var i=r.pending;null===i?a.next=a:(a.next=i.next,i.next=a),r.pending=a}0!==s&&Or(n,a,s)}}function Nr(e,t,n,r){_r[xr++]=e,_r[xr++]=t,_r[xr++]=n,_r[xr++]=r,Cr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Ir(e,t,n,r){return Nr(e,t,n,r),Pr(e)}function Rr(e,t){return Nr(e,null,null,t),Pr(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(a=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,a&&null!==t&&(a=31-de(n),null===(r=(e=s.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),s):null}function Pr(e){if(50<Pc)throw Pc=0,Dc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Dr={};function Lr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(e,t,n,r){return new Lr(e,t,n,r)}function Fr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ur(e,t){var n=e.alternate;return null===n?((n=Mr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function jr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zr(e,t,n,r,a,s){var o=0;if(r=e,"function"===typeof e)Fr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,B.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Mr(31,n,t,a)).elementType=C,e.lanes=s,e;case g:return Vr(n.children,a,s,t);case v:o=8,a|=24;break;case y:return(e=Mr(12,n,t,2|a)).elementType=y,e.lanes=s,e;case S:return(e=Mr(13,n,t,a)).elementType=S,e.lanes=s,e;case k:return(e=Mr(19,n,t,a)).elementType=k,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case T:o=10;break e;case w:o=9;break e;case E:o=11;break e;case _:o=14;break e;case x:o=16,r=null;break e}o=29,n=Error(i(130,null===e?"null":typeof e,"")),r=null}return(t=Mr(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Vr(e,t,n,r){return(e=Mr(7,e,r,t)).lanes=n,e}function Br(e,t,n){return(e=Mr(6,e,null,t)).lanes=n,e}function Hr(e,t,n){return(t=Mr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wr=[],qr=0,$r=null,Gr=0,Kr=[],Qr=0,Xr=null,Yr=1,Jr="";function Zr(e,t){Wr[qr++]=Gr,Wr[qr++]=$r,$r=e,Gr=t}function ea(e,t,n){Kr[Qr++]=Yr,Kr[Qr++]=Jr,Kr[Qr++]=Xr,Xr=e;var r=Yr;e=Jr;var a=32-de(r)-1;r&=~(1<<a),n+=1;var s=32-de(t)+a;if(30<s){var i=a-a%5;s=(r&(1<<i)-1).toString(32),r>>=i,a-=i,Yr=1<<32-de(t)+a|n<<a|r,Jr=s+e}else Yr=1<<s|n<<a|r,Jr=e}function ta(e){null!==e.return&&(Zr(e,1),ea(e,1,0))}function na(e){for(;e===$r;)$r=Wr[--qr],Wr[qr]=null,Gr=Wr[--qr],Wr[qr]=null;for(;e===Xr;)Xr=Kr[--Qr],Kr[Qr]=null,Jr=Kr[--Qr],Kr[Qr]=null,Yr=Kr[--Qr],Kr[Qr]=null}var ra=null,aa=null,sa=!1,ia=null,oa=!1,la=Error(i(519));function ca(e){throw ma(kr(Error(i(418,"")),e)),la}function ua(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Oe]=e,t[Pe]=r,n){case"dialog":Uu("cancel",t),Uu("close",t);break;case"iframe":case"object":case"embed":Uu("load",t);break;case"video":case"audio":for(n=0;n<Lu.length;n++)Uu(Lu[n],t);break;case"source":Uu("error",t);break;case"img":case"image":case"link":Uu("error",t),Uu("load",t);break;case"details":Uu("toggle",t);break;case"input":Uu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":Uu("invalid",t);break;case"textarea":Uu("invalid",t),Tt(t,r.value,r.defaultValue,r.children),ht(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Yu(t.textContent,n)?(null!=r.popover&&(Uu("beforetoggle",t),Uu("toggle",t)),null!=r.onScroll&&Uu("scroll",t),null!=r.onScrollEnd&&Uu("scrollend",t),null!=r.onClick&&(t.onclick=Ju),t=!0):t=!1,t||ca(e)}function ha(e){for(ra=e.return;ra;)switch(ra.tag){case 5:case 13:return void(oa=!1);case 27:case 3:return void(oa=!0);default:ra=ra.return}}function fa(e){if(e!==ra)return!1;if(!sa)return ha(e),sa=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||oh(e.type,e.memoizedProps)),t=!t),t&&aa&&ca(e),ha(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){aa=yh(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}aa=null}}else 27===n?(n=aa,ph(e.type)?(e=bh,bh=null,aa=e):aa=n):aa=ra?yh(e.stateNode.nextSibling):null;return!0}function da(){aa=ra=null,sa=!1}function pa(){var e=ia;return null!==e&&(null===wc?wc=e:wc.push.apply(wc,e),ia=null),e}function ma(e){null===ia?ia=[e]:ia.push(e)}var ga=j(null),va=null,ya=null;function ba(e,t,n){V(ga,t._currentValue),t._currentValue=n}function wa(e){e._currentValue=ga.current,z(ga)}function Ta(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ea(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var s=a.dependencies;if(null!==s){var o=a.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ta(s.return,n,e),r||(o=null);break e}s=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),Ta(o,n,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Sa(e,t,n,r){e=null;for(var a=t,s=!1;null!==a;){if(!s)if(0!==(524288&a.flags))s=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=a.type;Qn(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===q.current){if(null===(o=a.alternate))throw Error(i(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(Qh):e=[Qh])}a=a.return}null!==e&&Ea(t,e,n,r),t.flags|=262144}function ka(e){for(e=e.firstContext;null!==e;){if(!Qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _a(e){va=e,ya=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function xa(e){return Aa(va,e)}function Ca(e,t){return null===va&&_a(e),Aa(e,t)}function Aa(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ya){if(null===e)throw Error(i(308));ya=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ya=ya.next=t;return n}var Na="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ia=r.unstable_scheduleCallback,Ra=r.unstable_NormalPriority,Oa={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pa(){return{controller:new Na,data:new Map,refCount:0}}function Da(e){e.refCount--,0===e.refCount&&Ia(Ra,function(){e.controller.abort()})}var La=null,Ma=0,Fa=0,Ua=null;function ja(){if(0===--Ma&&null!==La){null!==Ua&&(Ua.status="fulfilled");var e=La;La=null,Fa=0,Ua=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var za=D.S;D.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===La){var n=La=[];Ma=0,Fa=Iu(),Ua={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ma++,t.then(ja,ja)}(0,t),null!==za&&za(e,t)};var Va=j(null);function Ba(){var e=Va.current;return null!==e?e:ac.pooledCache}function Ha(e,t){V(Va,null===t?Va.current:t.pool)}function Wa(){var e=Ba();return null===e?null:{parent:Oa._currentValue,pool:e}}var qa=Error(i(460)),$a=Error(i(474)),Ga=Error(i(542)),Ka={then:function(){}};function Qa(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Xa(){}function Ya(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Xa,Xa),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ts(e=t.reason),e;default:if("string"===typeof t.status)t.then(Xa,Xa);else{if(null!==(e=ac)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ts(e=t.reason),e}throw Ja=t,qa}}var Ja=null;function Za(){if(null===Ja)throw Error(i(459));var e=Ja;return Ja=null,e}function ts(e){if(e===qa||e===Ga)throw Error(i(483))}var ns=!1;function rs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function as(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ss(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function is(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&rc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Pr(e),Or(e,null,n),t}return Nr(e,r,t,n),Pr(e)}function os(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}function ls(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?a=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?a=s=t:s=s.next=t}else a=s=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var cs=!1;function us(){if(cs){if(null!==Ua)throw Ua}}function hs(e,t,n,r){cs=!1;var a=e.updateQueue;ns=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=a.baseState;for(i=0,u=c=l=null,o=s;;){var d=-536870913&o.lane,p=d!==o.lane;if(p?(ic&d)===d:(r&d)===d){0!==d&&d===Fa&&(cs=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;d=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(v,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=g.payload)?m.call(v,h,d):m)||void 0===d)break e;h=f({},h,d);break e;case 2:ns=!0}}null!==(d=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[d]:p.push(d))}else p={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,i|=d;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(p=o).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===s&&(a.shared.lanes=0),pc|=i,e.lanes=i,e.memoizedState=h}}function fs(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function ds(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)fs(n[e],t)}var ps=j(null),ms=j(0);function gs(e,t){V(ms,e=fc),V(ps,t),fc=e|t.baseLanes}function vs(){V(ms,fc),V(ps,ps.current)}function ys(){fc=ms.current,z(ps),z(ms)}var bs=0,ws=null,Ts=null,Es=null,Ss=!1,ks=!1,_s=!1,xs=0,Cs=0,As=null,Ns=0;function Is(){throw Error(i(321))}function Rs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qn(e[n],t[n]))return!1;return!0}function Os(e,t,n,r,a,s){return bs=s,ws=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?$i:Gi,_s=!1,s=n(r,a),_s=!1,ks&&(s=Ds(t,n,r,a)),Ps(e),s}function Ps(e){D.H=qi;var t=null!==Ts&&null!==Ts.next;if(bs=0,Es=Ts=ws=null,Ss=!1,Cs=0,As=null,t)throw Error(i(300));null===e||Ao||null!==(e=e.dependencies)&&ka(e)&&(Ao=!0)}function Ds(e,t,n,r){ws=e;var a=0;do{if(ks&&(As=null),Cs=0,ks=!1,25<=a)throw Error(i(301));if(a+=1,Es=Ts=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}D.H=Ki,s=t(n,r)}while(ks);return s}function Ls(){var e=D.H,t=e.useState()[0];return t="function"===typeof t.then?Vs(t):t,e=e.useState()[0],(null!==Ts?Ts.memoizedState:null)!==e&&(ws.flags|=1024),t}function Ms(){var e=0!==xs;return xs=0,e}function Fs(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Us(e){if(Ss){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ss=!1}bs=0,Es=Ts=ws=null,ks=!1,Cs=xs=0,As=null}function js(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Es?ws.memoizedState=Es=e:Es=Es.next=e,Es}function zs(){if(null===Ts){var e=ws.alternate;e=null!==e?e.memoizedState:null}else e=Ts.next;var t=null===Es?ws.memoizedState:Es.next;if(null!==t)Es=t,Ts=e;else{if(null===e){if(null===ws.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Ts=e).memoizedState,baseState:Ts.baseState,baseQueue:Ts.baseQueue,queue:Ts.queue,next:null},null===Es?ws.memoizedState=Es=e:Es=Es.next=e}return Es}function Vs(e){var t=Cs;return Cs+=1,null===As&&(As=[]),e=Ya(As,e,t),t=ws,null===(null===Es?t.memoizedState:Es.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?$i:Gi),e}function Bs(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Vs(e);if(e.$$typeof===T)return xa(e)}throw Error(i(438,String(e)))}function Hs(e){var t=null,n=ws.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=ws.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},ws.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function Ws(e,t){return"function"===typeof t?t(e):t}function qs(e){return $s(zs(),Ts,e)}function $s(e,t,n){var r=e.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=n;var a=e.baseQueue,s=r.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}t.baseQueue=a=s,r.pending=null}if(s=e.baseState,null===a)e.memoizedState=s;else{var l=o=null,c=null,u=t=a.next,h=!1;do{var f=-536870913&u.lane;if(f!==u.lane?(ic&f)===f:(bs&f)===f){var d=u.revertLane;if(0===d)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Fa&&(h=!0);else{if((bs&d)===d){u=u.next,d===Fa&&(h=!0);continue}f={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,ws.lanes|=d,pc|=d}f=u.action,_s&&n(s,f),s=u.hasEagerState?u.eagerState:n(s,f)}else d={lane:f,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=s):c=c.next=d,ws.lanes|=f,pc|=f;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!Qn(s,e.memoizedState)&&(Ao=!0,h&&null!==(n=Ua)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Gs(e){var t=zs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);Qn(s,t.memoizedState)||(Ao=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ks(e,t,n){var r=ws,a=zs(),s=sa;if(s){if(void 0===n)throw Error(i(407));n=n()}else n=t();var o=!Qn((Ts||a).memoizedState,n);if(o&&(a.memoizedState=n,Ao=!0),a=a.queue,vi(2048,8,Ys.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||null!==Es&&1&Es.memoizedState.tag){if(r.flags|=2048,pi(9,{destroy:void 0,resource:void 0},Xs.bind(null,r,a,n,t),null),null===ac)throw Error(i(349));s||0!==(124&bs)||Qs(r,t,n)}return n}function Qs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ws.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},ws.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Xs(e,t,n,r){t.value=n,t.getSnapshot=r,Js(t)&&Zs(e)}function Ys(e,t,n){return n(function(){Js(t)&&Zs(e)})}function Js(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qn(e,n)}catch(r){return!0}}function Zs(e){var t=Rr(e,2);null!==t&&Fc(t,e,2)}function ei(e){var t=js();if("function"===typeof e){var n=e;if(e=n(),_s){fe(!0);try{n()}finally{fe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:e},t}function ti(e,t,n,r){return e.baseState=n,$s(e,Ts,"function"===typeof r?r:Ws)}function ni(e,t,n,r,a){if(Bi(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==D.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,ri(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ri(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var s=D.T,i={};D.T=i;try{var o=n(a,r),l=D.S;null!==l&&l(i,o),ai(e,t,o)}catch(c){ii(e,t,c)}finally{D.T=s}}else try{ai(e,t,s=n(a,r))}catch(u){ii(e,t,u)}}function ai(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){si(e,t,n)},function(n){return ii(e,t,n)}):si(e,t,n)}function si(e,t,n){t.status="fulfilled",t.value=n,oi(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ri(e,n)))}function ii(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,oi(t),t=t.next}while(t!==r)}e.action=null}function oi(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function li(e,t){return t}function ci(e,t){if(sa){var n=ac.formState;if(null!==n){e:{var r=ws;if(sa){if(aa){t:{for(var a=aa,s=oa;8!==a.nodeType;){if(!s){a=null;break t}if(null===(a=yh(a.nextSibling))){a=null;break t}}a="F!"===(s=a.data)||"F"===s?a:null}if(a){aa=yh(a.nextSibling),r="F!"===a.data;break e}}ca(r)}r=!1}r&&(t=n[0])}}return(n=js()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:t},n.queue=r,n=ji.bind(null,ws,r),r.dispatch=n,r=ei(!1),s=Vi.bind(null,ws,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=js()).queue=a,n=ni.bind(null,ws,a,s,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function ui(e){return hi(zs(),Ts,e)}function hi(e,t,n){if(t=$s(e,t,li)[0],e=qs(Ws)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Vs(t)}catch(es){if(es===qa)throw Ga;throw es}else r=t;var a=(t=zs()).queue,s=a.dispatch;return n!==t.memoizedState&&(ws.flags|=2048,pi(9,{destroy:void 0,resource:void 0},fi.bind(null,a,n),null)),[r,s,e]}function fi(e,t){e.action=t}function di(e){var t=zs(),n=Ts;if(null!==n)return hi(t,n,e);zs(),t=t.memoizedState;var r=(n=zs()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function pi(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=ws.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},ws.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function mi(){return zs().memoizedState}function gi(e,t,n,r){var a=js();r=void 0===r?null:r,ws.flags|=e,a.memoizedState=pi(1|t,{destroy:void 0,resource:void 0},n,r)}function vi(e,t,n,r){var a=zs();r=void 0===r?null:r;var s=a.memoizedState.inst;null!==Ts&&null!==r&&Rs(r,Ts.memoizedState.deps)?a.memoizedState=pi(t,s,n,r):(ws.flags|=e,a.memoizedState=pi(1|t,s,n,r))}function yi(e,t){gi(8390656,8,e,t)}function bi(e,t){vi(2048,8,e,t)}function wi(e,t){return vi(4,2,e,t)}function Ti(e,t){return vi(4,4,e,t)}function Ei(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Si(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,vi(4,4,Ei.bind(null,t,e),n)}function ki(){}function _i(e,t){var n=zs();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Rs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function xi(e,t){var n=zs();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Rs(t,r[1]))return r[0];if(r=e(),_s){fe(!0);try{e()}finally{fe(!1)}}return n.memoizedState=[r,t],r}function Ci(e,t,n){return void 0===n||0!==(1073741824&bs)?e.memoizedState=t:(e.memoizedState=n,e=Mc(),ws.lanes|=e,pc|=e,n)}function Ai(e,t,n,r){return Qn(n,t)?n:null!==ps.current?(e=Ci(e,n,r),Qn(e,t)||(Ao=!0),e):0===(42&bs)?(Ao=!0,e.memoizedState=n):(e=Mc(),ws.lanes|=e,pc|=e,t)}function Ni(e,t,n,r,a){var s=L.p;L.p=0!==s&&8>s?s:8;var i=D.T,o={};D.T=o,Vi(e,!1,t,n);try{var l=a(),c=D.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)zi(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Lc());else zi(e,t,r,Lc())}catch(u){zi(e,t,{then:function(){},status:"rejected",reason:u},Lc())}finally{L.p=s,D.T=i}}function Ii(){}function Ri(e,t,n,r){if(5!==e.tag)throw Error(i(476));var a=Oi(e).queue;Ni(e,a,t,M,null===n?Ii:function(){return Pi(e),n(r)})}function Oi(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Pi(e){zi(e,Oi(e).next.queue,{},Lc())}function Di(){return xa(Qh)}function Li(){return zs().memoizedState}function Mi(){return zs().memoizedState}function Fi(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Lc(),r=is(t,e=ss(n),n);return null!==r&&(Fc(r,t,n),os(r,t,n)),t={cache:Pa()},void(e.payload=t)}t=t.return}}function Ui(e,t,n){var r=Lc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Bi(e)?Hi(t,n):null!==(n=Ir(e,t,n,r))&&(Fc(n,e,r),Wi(n,t,r))}function ji(e,t,n){zi(e,t,n,Lc())}function zi(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Bi(e))Hi(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,n);if(a.hasEagerState=!0,a.eagerState=o,Qn(o,i))return Nr(e,t,a,0),null===ac&&Ar(),!1}catch(l){}if(null!==(n=Ir(e,t,a,r)))return Fc(n,e,r),Wi(n,t,r),!0}return!1}function Vi(e,t,n,r){if(r={lane:2,revertLane:Iu(),action:r,hasEagerState:!1,eagerState:null,next:null},Bi(e)){if(t)throw Error(i(479))}else null!==(t=Ir(e,n,r,2))&&Fc(t,e,2)}function Bi(e){var t=e.alternate;return e===ws||null!==t&&t===ws}function Hi(e,t){ks=Ss=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Wi(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}var qi={readContext:xa,use:Bs,useCallback:Is,useContext:Is,useEffect:Is,useImperativeHandle:Is,useLayoutEffect:Is,useInsertionEffect:Is,useMemo:Is,useReducer:Is,useRef:Is,useState:Is,useDebugValue:Is,useDeferredValue:Is,useTransition:Is,useSyncExternalStore:Is,useId:Is,useHostTransitionStatus:Is,useFormState:Is,useActionState:Is,useOptimistic:Is,useMemoCache:Is,useCacheRefresh:Is},$i={readContext:xa,use:Bs,useCallback:function(e,t){return js().memoizedState=[e,void 0===t?null:t],e},useContext:xa,useEffect:yi,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,gi(4194308,4,Ei.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gi(4194308,4,e,t)},useInsertionEffect:function(e,t){gi(4,2,e,t)},useMemo:function(e,t){var n=js();t=void 0===t?null:t;var r=e();if(_s){fe(!0);try{e()}finally{fe(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=js();if(void 0!==n){var a=n(t);if(_s){fe(!0);try{n(t)}finally{fe(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=Ui.bind(null,ws,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},js().memoizedState=e},useState:function(e){var t=(e=ei(e)).queue,n=ji.bind(null,ws,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ki,useDeferredValue:function(e,t){return Ci(js(),e,t)},useTransition:function(){var e=ei(!1);return e=Ni.bind(null,ws,e.queue,!0,!1),js().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=ws,a=js();if(sa){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===ac)throw Error(i(349));0!==(124&ic)||Qs(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,yi(Ys.bind(null,r,s,e),[e]),r.flags|=2048,pi(9,{destroy:void 0,resource:void 0},Xs.bind(null,r,s,n,t),null),n},useId:function(){var e=js(),t=ac.identifierPrefix;if(sa){var n=Jr;t="\xab"+t+"R"+(n=(Yr&~(1<<32-de(Yr)-1)).toString(32)+n),0<(n=xs++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ns++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Di,useFormState:ci,useActionState:ci,useOptimistic:function(e){var t=js();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Vi.bind(null,ws,!0,n),n.dispatch=t,[e,t]},useMemoCache:Hs,useCacheRefresh:function(){return js().memoizedState=Fi.bind(null,ws)}},Gi={readContext:xa,use:Bs,useCallback:_i,useContext:xa,useEffect:bi,useImperativeHandle:Si,useInsertionEffect:wi,useLayoutEffect:Ti,useMemo:xi,useReducer:qs,useRef:mi,useState:function(){return qs(Ws)},useDebugValue:ki,useDeferredValue:function(e,t){return Ai(zs(),Ts.memoizedState,e,t)},useTransition:function(){var e=qs(Ws)[0],t=zs().memoizedState;return["boolean"===typeof e?e:Vs(e),t]},useSyncExternalStore:Ks,useId:Li,useHostTransitionStatus:Di,useFormState:ui,useActionState:ui,useOptimistic:function(e,t){return ti(zs(),0,e,t)},useMemoCache:Hs,useCacheRefresh:Mi},Ki={readContext:xa,use:Bs,useCallback:_i,useContext:xa,useEffect:bi,useImperativeHandle:Si,useInsertionEffect:wi,useLayoutEffect:Ti,useMemo:xi,useReducer:Gs,useRef:mi,useState:function(){return Gs(Ws)},useDebugValue:ki,useDeferredValue:function(e,t){var n=zs();return null===Ts?Ci(n,e,t):Ai(n,Ts.memoizedState,e,t)},useTransition:function(){var e=Gs(Ws)[0],t=zs().memoizedState;return["boolean"===typeof e?e:Vs(e),t]},useSyncExternalStore:Ks,useId:Li,useHostTransitionStatus:Di,useFormState:di,useActionState:di,useOptimistic:function(e,t){var n=zs();return null!==Ts?ti(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Hs,useCacheRefresh:Mi},Qi=null,Xi=0;function Yi(e){var t=Xi;return Xi+=1,null===Qi&&(Qi=[]),Ya(Qi,e,t)}function Ji(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zi(e,t){if(t.$$typeof===d)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function eo(e){return(0,e._init)(e._payload)}function to(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Ur(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Br(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===g?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===x&&eo(s)===t.type)?(Ji(t=a(t,n.props),n),t.return=e,t):(Ji(t=zr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Hr(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Vr(n,e.mode,r,s)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Br(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Ji(n=zr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Hr(t,e.mode,n)).return=e,t;case x:return f(e,t=(0,t._init)(t._payload),n)}if(P(t)||I(t))return(t=Vr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return f(e,Yi(t),n);if(t.$$typeof===T)return f(e,Ca(e,t),n);Zi(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===a?c(e,t,n,r):null;case m:return n.key===a?u(e,t,n,r):null;case x:return d(e,t,n=(a=n._init)(n._payload),r)}if(P(n)||I(n))return null!==a?null:h(e,t,n,r,null);if("function"===typeof n.then)return d(e,t,Yi(n),r);if(n.$$typeof===T)return d(e,t,Ca(e,n),r);Zi(e,n)}return null}function v(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case x:return v(e,t,n,r=(0,r._init)(r._payload),a)}if(P(r)||I(r))return h(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return v(e,t,n,Yi(r),a);if(r.$$typeof===T)return v(e,t,n,Ca(t,r),a);Zi(t,r)}return null}function y(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===g){if(7===c.tag){n(l,c.sibling),(h=a(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===x&&eo(b)===c.type){n(l,c.sibling),Ji(h=a(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((h=Vr(u.props.children,l.mode,h,u.key)).return=l,l=h):(Ji(h=zr(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return o(l);case m:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=a(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=Hr(u,l.mode,h)).return=l,l=h}return o(l);case x:return y(l,c,u=(b=u._init)(u._payload),h)}if(P(u))return function(a,i,o,l){for(var c=null,u=null,h=i,p=i=0,m=null;null!==h&&p<o.length;p++){h.index>p?(m=h,h=null):m=h.sibling;var g=d(a,h,o[p],l);if(null===g){null===h&&(h=m);break}e&&h&&null===g.alternate&&t(a,h),i=s(g,i,p),null===u?c=g:u.sibling=g,u=g,h=m}if(p===o.length)return n(a,h),sa&&Zr(a,p),c;if(null===h){for(;p<o.length;p++)null!==(h=f(a,o[p],l))&&(i=s(h,i,p),null===u?c=h:u.sibling=h,u=h);return sa&&Zr(a,p),c}for(h=r(h);p<o.length;p++)null!==(m=v(h,a,p,o[p],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?p:m.key),i=s(m,i,p),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach(function(e){return t(a,e)}),sa&&Zr(a,p),c}(l,c,u,h);if(I(u)){if("function"!==typeof(b=I(u)))throw Error(i(150));return function(a,o,l,c){if(null==l)throw Error(i(151));for(var u=null,h=null,p=o,m=o=0,g=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var b=d(a,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(a,p),o=s(b,o,m),null===h?u=b:h.sibling=b,h=b,p=g}if(y.done)return n(a,p),sa&&Zr(a,m),u;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=f(a,y.value,c))&&(o=s(y,o,m),null===h?u=y:h.sibling=y,h=y);return sa&&Zr(a,m),u}for(p=r(p);!y.done;m++,y=l.next())null!==(y=v(p,a,m,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?m:y.key),o=s(y,o,m),null===h?u=y:h.sibling=y,h=y);return e&&p.forEach(function(e){return t(a,e)}),sa&&Zr(a,m),u}(l,c,u=b.call(u),h)}if("function"===typeof u.then)return y(l,c,Yi(u),h);if(u.$$typeof===T)return y(l,c,Ca(l,u),h);Zi(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=a(c,u)).return=l,l=h):(n(l,c),(h=Br(u,l.mode,h)).return=l,l=h),o(l)):n(l,c)}return function(e,t,n,r){try{Xi=0;var a=y(e,t,n,r);return Qi=null,a}catch(es){if(es===qa||es===Ga)throw es;var s=Mr(29,es,null,e.mode);return s.lanes=r,s.return=e,s}}}var no=to(!0),ro=to(!1),ao=j(null),so=null;function io(e){var t=e.alternate;V(uo,1&uo.current),V(ao,e),null===so&&(null===t||null!==ps.current||null!==t.memoizedState)&&(so=e)}function oo(e){if(22===e.tag){if(V(uo,uo.current),V(ao,e),null===so){var t=e.alternate;null!==t&&null!==t.memoizedState&&(so=e)}}else lo()}function lo(){V(uo,uo.current),V(ao,ao.current)}function co(e){z(ao),so===e&&(so=null),z(uo)}var uo=j(0);function ho(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||vh(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function fo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var po={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Lc(),a=ss(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=is(e,a,r))&&(Fc(t,e,r),os(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Lc(),a=ss(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=is(e,a,r))&&(Fc(t,e,r),os(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lc(),r=ss(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=is(e,r,n))&&(Fc(t,e,n),os(t,e,n))}};function mo(e,t,n,r,a,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Xn(n,r)||!Xn(a,s))}function go(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&po.enqueueReplaceState(t,t.state,null)}function vo(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=f({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var yo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function bo(e){yo(e)}function wo(e){console.error(e)}function To(e){yo(e)}function Eo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function So(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function ko(e,t,n){return(n=ss(n)).tag=3,n.payload={element:null},n.callback=function(){Eo(e,t)},n}function _o(e){return(e=ss(e)).tag=3,e}function xo(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var s=r.value;e.payload=function(){return a(s)},e.callback=function(){So(t,n,r)}}var i=n.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){So(t,n,r),"function"!==typeof a&&(null===_c?_c=new Set([this]):_c.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Co=Error(i(461)),Ao=!1;function No(e,t,n,r){t.child=null===e?ro(t,null,n,r):no(t,e.child,n,r)}function Io(e,t,n,r,a){n=n.render;var s=t.ref;if("ref"in r){var i={};for(var o in r)"ref"!==o&&(i[o]=r[o])}else i=r;return _a(t),r=Os(e,t,n,i,s,a),o=Ms(),null===e||Ao?(sa&&o&&ta(t),t.flags|=1,No(e,t,r,a),t.child):(Fs(e,t,a),Xo(e,t,a))}function Ro(e,t,n,r,a){if(null===e){var s=n.type;return"function"!==typeof s||Fr(s)||void 0!==s.defaultProps||null!==n.compare?((e=zr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Oo(e,t,s,r,a))}if(s=e.child,!Yo(e,a)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:Xn)(i,r)&&e.ref===t.ref)return Xo(e,t,a)}return t.flags|=1,(e=Ur(s,r)).ref=t.ref,e.return=t,t.child=e}function Oo(e,t,n,r,a){if(null!==e){var s=e.memoizedProps;if(Xn(s,r)&&e.ref===t.ref){if(Ao=!1,t.pendingProps=r=s,!Yo(e,a))return t.lanes=e.lanes,Xo(e,t,a);0!==(131072&e.flags)&&(Ao=!0)}}return Mo(e,t,n,r,a)}function Po(e,t,n){var r=t.pendingProps,a=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==s?s.baseLanes|n:n,null!==e){for(a=t.child=e.child,s=0;null!==a;)s=s|a.lanes|a.childLanes,a=a.sibling;t.childLanes=s&~r}else t.childLanes=0,t.child=null;return Do(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Do(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ha(0,null!==s?s.cachePool:null),null!==s?gs(t,s):vs(),oo(t)}else null!==s?(Ha(0,s.cachePool),gs(t,s),lo(),t.memoizedState=null):(null!==e&&Ha(0,null),vs(),lo());return No(e,t,a,n),t.child}function Do(e,t,n,r){var a=Ba();return a=null===a?null:{parent:Oa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Ha(0,null),vs(),oo(t),null!==e&&Sa(e,t,r,!0),null}function Lo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(i(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Mo(e,t,n,r,a){return _a(t),n=Os(e,t,n,r,void 0,a),r=Ms(),null===e||Ao?(sa&&r&&ta(t),t.flags|=1,No(e,t,n,a),t.child):(Fs(e,t,a),Xo(e,t,a))}function Fo(e,t,n,r,a,s){return _a(t),t.updateQueue=null,n=Ds(t,r,n,a),Ps(e),r=Ms(),null===e||Ao?(sa&&r&&ta(t),t.flags|=1,No(e,t,n,s),t.child):(Fs(e,t,s),Xo(e,t,s))}function Uo(e,t,n,r,a){if(_a(t),null===t.stateNode){var s=Dr,i=n.contextType;"object"===typeof i&&null!==i&&(s=xa(i)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=po,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},rs(t),i=n.contextType,s.context="object"===typeof i&&null!==i?xa(i):Dr,s.state=t.memoizedState,"function"===typeof(i=n.getDerivedStateFromProps)&&(fo(t,n,i,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&po.enqueueReplaceState(s,s.state,null),hs(t,r,s,a),us(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=vo(n,o);s.props=l;var c=s.context,u=n.contextType;i=Dr,"object"===typeof u&&null!==u&&(i=xa(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&go(t,s,r,i),ns=!1;var f=t.memoizedState;s.state=f,hs(t,r,s,a),us(),c=t.memoizedState,o||f!==c||ns?("function"===typeof h&&(fo(t,n,h,r),c=t.memoizedState),(l=ns||mo(t,n,l,r,f,c,i))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=i,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,as(e,t),u=vo(n,i=t.memoizedProps),s.props=u,h=t.pendingProps,f=s.context,c=n.contextType,l=Dr,"object"===typeof c&&null!==c&&(l=xa(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==h||f!==l)&&go(t,s,r,l),ns=!1,f=t.memoizedState,s.state=f,hs(t,r,s,a),us();var d=t.memoizedState;i!==h||f!==d||ns||null!==e&&null!==e.dependencies&&ka(e.dependencies)?("function"===typeof o&&(fo(t,n,o,r),d=t.memoizedState),(u=ns||mo(t,n,u,r,f,d,l)||null!==e&&null!==e.dependencies&&ka(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,d,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,d,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),s.props=r,s.state=d,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,Lo(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=no(t,e.child,null,a),t.child=no(t,null,n,a)):No(e,t,n,a),t.memoizedState=s.state,e=t.child):e=Xo(e,t,a),e}function jo(e,t,n,r){return da(),t.flags|=256,No(e,t,n,r),t.child}var zo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vo(e){return{baseLanes:e,cachePool:Wa()}}function Bo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=vc),e}function Ho(e,t,n){var r,a=t.pendingProps,s=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&uo.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(sa){if(s?io(t):lo(),sa){var l,c=aa;if(l=c){e:{for(l=c,c=oa;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=yh(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Xr?{id:Yr,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},(l=Mr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ra=t,aa=null,l=!0):l=!1}l||ca(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return vh(c)?t.lanes=32:t.lanes=536870912,null;co(t)}return c=a.children,a=a.fallback,s?(lo(),c=qo({mode:"hidden",children:c},s=t.mode),a=Vr(a,s,n,null),c.return=t,a.return=t,c.sibling=a,t.child=c,(s=t.child).memoizedState=Vo(n),s.childLanes=Bo(e,r,n),t.memoizedState=zo,a):(io(t),Wo(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(io(t),t.flags&=-257,t=$o(e,t,n)):null!==t.memoizedState?(lo(),t.child=e.child,t.flags|=128,t=null):(lo(),s=a.fallback,c=t.mode,a=qo({mode:"visible",children:a.children},c),(s=Vr(s,c,n,null)).flags|=2,a.return=t,s.return=t,a.sibling=s,t.child=a,no(t,e.child,null,n),(a=t.child).memoizedState=Vo(n),a.childLanes=Bo(e,r,n),t.memoizedState=zo,t=s);else if(io(t),vh(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(a=Error(i(419))).stack="",a.digest=r,ma({value:a,source:null,stack:null}),t=$o(e,t,n)}else if(Ao||Sa(e,t,n,!1),r=0!==(n&e.childLanes),Ao||r){if(null!==(r=ac)&&(0!==(a=0!==((a=0!==(42&(a=n&-n))?1:Ae(a))&(r.suspendedLanes|n))?0:a)&&a!==l.retryLane))throw l.retryLane=a,Rr(e,a),Fc(r,e,a),Co;"$?"===c.data||Kc(),t=$o(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,aa=yh(c.nextSibling),ra=t,sa=!0,ia=null,oa=!1,null!==e&&(Kr[Qr++]=Yr,Kr[Qr++]=Jr,Kr[Qr++]=Xr,Yr=e.id,Jr=e.overflow,Xr=t),(t=Wo(t,a.children)).flags|=4096);return t}return s?(lo(),s=a.fallback,c=t.mode,u=(l=e.child).sibling,(a=Ur(l,{mode:"hidden",children:a.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?s=Ur(u,s):(s=Vr(s,c,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,null===(c=e.child.memoizedState)?c=Vo(n):(null!==(l=c.cachePool)?(u=Oa._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Wa(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=Bo(e,r,n),t.memoizedState=zo,a):(io(t),e=(n=e.child).sibling,(n=Ur(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Wo(e,t){return(t=qo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function qo(e,t){return(e=Mr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function $o(e,t,n){return no(t,e.child,null,n),(e=Wo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Go(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ta(e.return,t,n)}function Ko(e,t,n,r,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function Qo(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;if(No(e,t,r.children,n),0!==(2&(r=uo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Go(e,n,t);else if(19===e.tag)Go(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(V(uo,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ho(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ko(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ho(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ko(t,!0,n,null,s);break;case"together":Ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Sa(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ur(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ur(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Yo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!ka(e))}function Jo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ao=!0;else{if(!Yo(e,n)&&0===(128&t.flags))return Ao=!1,function(e,t,n){switch(t.tag){case 3:$(t,t.stateNode.containerInfo),ba(0,Oa,e.memoizedState.cache),da();break;case 27:case 5:K(t);break;case 4:$(t,t.stateNode.containerInfo);break;case 10:ba(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(io(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ho(e,t,n):(io(t),null!==(e=Xo(e,t,n))?e.sibling:null);io(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Sa(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return Qo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),V(uo,uo.current),r)break;return null;case 22:case 23:return t.lanes=0,Po(e,t,n);case 24:ba(0,Oa,e.memoizedState.cache)}return Xo(e,t,n)}(e,t,n);Ao=0!==(131072&e.flags)}else Ao=!1,sa&&0!==(1048576&t.flags)&&ea(t,Gr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,a=r._init;if(r=a(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((a=r.$$typeof)===E){t.tag=11,t=Io(null,t,r,e,n);break e}if(a===_){t.tag=14,t=Ro(null,t,r,e,n);break e}}throw t=O(r)||r,Error(i(306,t,""))}Fr(r)?(e=vo(r,e),t.tag=1,t=Uo(null,t,r,e,n)):(t.tag=0,t=Mo(null,t,r,e,n))}return t;case 0:return Mo(e,t,t.type,t.pendingProps,n);case 1:return Uo(e,t,r=t.type,a=vo(r,t.pendingProps),n);case 3:e:{if($(t,t.stateNode.containerInfo),null===e)throw Error(i(387));r=t.pendingProps;var s=t.memoizedState;a=s.element,as(e,t),hs(t,r,null,n);var o=t.memoizedState;if(r=o.cache,ba(0,Oa,r),r!==s.cache&&Ea(t,[Oa],n,!0),us(),r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=jo(e,t,r,n);break e}if(r!==a){ma(a=kr(Error(i(424)),t)),t=jo(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(aa=yh(e.firstChild),ra=t,sa=!0,ia=null,oa=!0,n=ro(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),r===a){t=Xo(e,t,n);break e}No(e,t,r,n)}t=t.child}return t;case 26:return Lo(e,t),null===e?(n=Nh(t.type,null,t.pendingProps,null))?t.memoizedState=n:sa||(n=t.type,e=t.pendingProps,(r=ah(W.current).createElement(n))[Oe]=t,r[Pe]=e,th(r,n,e),qe(r),t.stateNode=r):t.memoizedState=Nh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return K(t),null===e&&sa&&(r=t.stateNode=Th(t.type,t.pendingProps,W.current),ra=t,oa=!0,a=aa,ph(t.type)?(bh=a,aa=yh(r.firstChild)):aa=a),No(e,t,t.pendingProps.children,n),Lo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&sa&&((a=r=aa)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===s)return e}if(null===(e=yh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,oa))?(t.stateNode=r,ra=t,aa=yh(r.firstChild),oa=!1,a=!0):a=!1),a||ca(t)),K(t),a=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,r=s.children,oh(a,s)?r=null:null!==o&&oh(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=Os(e,t,Ls,null,null,n),Qh._currentValue=a),Lo(e,t),No(e,t,r,n),t.child;case 6:return null===e&&sa&&((e=n=aa)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=yh(e.nextSibling)))return null}return e}(n,t.pendingProps,oa))?(t.stateNode=n,ra=t,aa=null,e=!0):e=!1),e||ca(t)),null;case 13:return Ho(e,t,n);case 4:return $(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=no(t,null,r,n):No(e,t,r,n),t.child;case 11:return Io(e,t,t.type,t.pendingProps,n);case 7:return No(e,t,t.pendingProps,n),t.child;case 8:case 12:return No(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,ba(0,t.type,r.value),No(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,_a(t),r=r(a=xa(a)),t.flags|=1,No(e,t,r,n),t.child;case 14:return Ro(e,t,t.type,t.pendingProps,n);case 15:return Oo(e,t,t.type,t.pendingProps,n);case 19:return Qo(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=qo(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Ur(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Po(e,t,n);case 24:return _a(t),r=xa(Oa),null===e?(null===(a=Ba())&&(a=ac,s=Pa(),a.pooledCache=s,s.refCount++,null!==s&&(a.pooledCacheLanes|=n),a=s),t.memoizedState={parent:r,cache:a},rs(t),ba(0,Oa,a)):(0!==(e.lanes&n)&&(as(e,t),hs(t,null,null,n),us()),a=e.memoizedState,s=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),ba(0,Oa,r)):(r=s.cache,ba(0,Oa,r),r!==a.cache&&Ea(t,[Oa],n,!0))),No(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Zo(e){e.flags|=4}function el(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Bh(t)){if(null!==(t=ao.current)&&((4194048&ic)===ic?null!==so:(62914560&ic)!==ic&&0===(536870912&ic)||t!==so))throw Ja=Ka,$a;e.flags|=8192}}function tl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Se():536870912,e.lanes|=t,yc|=t)}function nl(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function al(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return rl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),wa(Oa),G(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(fa(t)?Zo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pa())),rl(t),null;case 26:return n=t.memoizedState,null===e?(Zo(t),null!==n?(rl(t),el(t,n)):(rl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Zo(t),rl(t),el(t,n)):(rl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Zo(t),rl(t),t.flags&=-16777217),null;case 27:Q(t),n=W.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Zo(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return rl(t),null}e=B.current,fa(t)?ua(t):(e=Th(a,r,n),t.stateNode=e,Zo(t))}return rl(t),null;case 5:if(Q(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Zo(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return rl(t),null}if(e=B.current,fa(t))ua(t);else{switch(a=ah(W.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?a.createElement(n,{is:r.is}):a.createElement(n)}}e[Oe]=t,e[Pe]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(th(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Zo(t)}}return rl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Zo(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(e=W.current,fa(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=ra))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[Oe]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Yu(e.nodeValue,n)))||ca(t)}else(e=ah(e).createTextNode(r))[Oe]=t,t.stateNode=e}return rl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=fa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[Oe]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;rl(t),a=!1}else a=pa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(co(t),t):(co(t),null)}if(co(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool);var s=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==a&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),tl(t,t.updateQueue),rl(t),null;case 4:return G(),null===e&&Vu(t.stateNode.containerInfo),rl(t),null;case 10:return wa(t.type),rl(t),null;case 19:if(z(uo),null===(a=t.memoizedState))return rl(t),null;if(r=0!==(128&t.flags),null===(s=a.rendering))if(r)nl(a,!1);else{if(0!==dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ho(e))){for(t.flags|=128,nl(a,!1),e=s.updateQueue,t.updateQueue=e,tl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)jr(n,e),n=n.sibling;return V(uo,1&uo.current|2),t.child}e=e.sibling}null!==a.tail&&te()>Sc&&(t.flags|=128,r=!0,nl(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ho(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,tl(t,e),nl(a,!0),null===a.tail&&"hidden"===a.tailMode&&!s.alternate&&!sa)return rl(t),null}else 2*te()-a.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,nl(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=a.last)?e.sibling=s:t.child=s,a.last=s)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=te(),t.sibling=null,e=uo.current,V(uo,r?1&e|2:1&e),t):(rl(t),null);case 22:case 23:return co(t),ys(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(rl(t),6&t.subtreeFlags&&(t.flags|=8192)):rl(t),null!==(n=t.updateQueue)&&tl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&z(Va),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),wa(Oa),rl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function sl(e,t){switch(na(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return wa(Oa),G(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 13:if(co(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return z(uo),null;case 4:return G(),null;case 10:return wa(t.type),null;case 22:case 23:return co(t),ys(),null!==e&&z(Va),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return wa(Oa),null;default:return null}}function il(e,t){switch(na(t),t.tag){case 3:wa(Oa),G();break;case 26:case 27:case 5:Q(t);break;case 4:G();break;case 13:co(t);break;case 19:z(uo);break;case 10:wa(t.type);break;case 22:case 23:co(t),ys(),null!==e&&z(Va);break;case 24:wa(Oa)}}function ol(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var s=n.create,i=n.inst;r=s(),i.destroy=r}n=n.next}while(n!==a)}}catch(o){hu(t,t.return,o)}}function ll(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var s=a.next;r=s;do{if((r.tag&e)===e){var i=r.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,a=t;var l=n,c=o;try{c()}catch(u){hu(a,l,u)}}}r=r.next}while(r!==s)}}catch(u){hu(t,t.return,u)}}function cl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ds(t,n)}catch(r){hu(e,e.return,r)}}}function ul(e,t,n){n.props=vo(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){hu(e,t,r)}}function hl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(a){hu(e,t,a)}}function fl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){hu(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){hu(e,t,s)}else n.current=null}function dl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){hu(e,e.return,a)}}function pl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,o=null,l=null,c=null,u=null,h=null;for(p in n){var f=n[p];if(n.hasOwnProperty(p)&&null!=f)switch(p){case"checked":case"value":break;case"defaultValue":c=f;default:r.hasOwnProperty(p)||Zu(e,t,p,null,r,f)}}for(var d in r){var p=r[d];if(f=n[d],r.hasOwnProperty(d)&&(null!=p||null!=f))switch(d){case"type":s=p;break;case"name":a=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(i(137,t));break;default:p!==f&&Zu(e,t,d,p,r,f)}}return void gt(e,o,l,c,u,h,s,a);case"select":for(s in p=o=l=d=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||Zu(e,t,s,null,r,c)}for(a in r)if(s=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=s||null!=c))switch(a){case"value":d=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&Zu(e,t,a,s,r,c)}return t=l,n=o,r=p,void(null!=d?bt(e,!!n,d,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=d=null,n)if(a=n[l],n.hasOwnProperty(l)&&null!=a&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zu(e,t,l,null,r,a)}for(o in r)if(a=r[o],s=n[o],r.hasOwnProperty(o)&&(null!=a||null!=s))switch(o){case"value":d=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(i(91));break;default:a!==s&&Zu(e,t,o,a,r,s)}return void wt(e,d,p);case"option":for(var m in n)if(d=n[m],n.hasOwnProperty(m)&&null!=d&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Zu(e,t,m,null,r,d);for(c in r)if(d=r[c],p=n[c],r.hasOwnProperty(c)&&d!==p&&(null!=d||null!=p))if("selected"===c)e.selected=d&&"function"!==typeof d&&"symbol"!==typeof d;else Zu(e,t,c,d,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)d=n[g],n.hasOwnProperty(g)&&null!=d&&!r.hasOwnProperty(g)&&Zu(e,t,g,null,r,d);for(u in r)if(d=r[u],p=n[u],r.hasOwnProperty(u)&&d!==p&&(null!=d||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(i(137,t));break;default:Zu(e,t,u,d,r,p)}return;default:if(xt(t)){for(var v in n)d=n[v],n.hasOwnProperty(v)&&void 0!==d&&!r.hasOwnProperty(v)&&eh(e,t,v,void 0,r,d);for(h in r)d=r[h],p=n[h],!r.hasOwnProperty(h)||d===p||void 0===d&&void 0===p||eh(e,t,h,d,r,p);return}}for(var y in n)d=n[y],n.hasOwnProperty(y)&&null!=d&&!r.hasOwnProperty(y)&&Zu(e,t,y,null,r,d);for(f in r)d=r[f],p=n[f],!r.hasOwnProperty(f)||d===p||null==d&&null==p||Zu(e,t,f,d,r,p)}(r,e.type,n,t),r[Pe]=t}catch(a){hu(e,e.return,a)}}function ml(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&ph(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ml(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&ph(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ju));else if(4!==r&&(27===r&&ph(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&ph(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}function bl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);th(t,r,n),t[Oe]=e,t[Pe]=n}catch(s){hu(e,e.return,s)}}var wl=!1,Tl=!1,El=!1,Sl="function"===typeof WeakSet?WeakSet:Set,kl=null;function _l(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Ul(e,n),4&r&&ol(5,n);break;case 1:if(Ul(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){hu(n,n.return,i)}else{var a=vo(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){hu(n,n.return,o)}}64&r&&cl(n),512&r&&hl(n,n.return);break;case 3:if(Ul(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ds(e,t)}catch(i){hu(n,n.return,i)}}break;case 27:null===t&&4&r&&bl(n);case 26:case 5:Ul(e,n),null===t&&4&r&&dl(n),512&r&&hl(n,n.return);break;case 12:Ul(e,n);break;case 13:Ul(e,n),4&r&&Rl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=mu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||wl)){t=null!==t&&null!==t.memoizedState||Tl,a=wl;var s=Tl;wl=r,(Tl=t)&&!s?zl(e,n,0!==(8772&n.subtreeFlags)):Ul(e,n),wl=a,Tl=s}break;case 30:break;default:Ul(e,n)}}function xl(e){var t=e.alternate;null!==t&&(e.alternate=null,xl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ze(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Cl=null,Al=!1;function Nl(e,t,n){for(n=n.child;null!==n;)Il(e,t,n),n=n.sibling}function Il(e,t,n){if(he&&"function"===typeof he.onCommitFiberUnmount)try{he.onCommitFiberUnmount(ue,n)}catch(s){}switch(n.tag){case 26:Tl||fl(n,t),Nl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Tl||fl(n,t);var r=Cl,a=Al;ph(n.type)&&(Cl=n.stateNode,Al=!1),Nl(e,t,n),Eh(n.stateNode),Cl=r,Al=a;break;case 5:Tl||fl(n,t);case 6:if(r=Cl,a=Al,Cl=null,Nl(e,t,n),Al=a,null!==(Cl=r))if(Al)try{(9===Cl.nodeType?Cl.body:"HTML"===Cl.nodeName?Cl.ownerDocument.body:Cl).removeChild(n.stateNode)}catch(i){hu(n,t,i)}else try{Cl.removeChild(n.stateNode)}catch(i){hu(n,t,i)}break;case 18:null!==Cl&&(Al?(mh(9===(e=Cl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Nf(e)):mh(Cl,n.stateNode));break;case 4:r=Cl,a=Al,Cl=n.stateNode.containerInfo,Al=!0,Nl(e,t,n),Cl=r,Al=a;break;case 0:case 11:case 14:case 15:Tl||ll(2,n,t),Tl||ll(4,n,t),Nl(e,t,n);break;case 1:Tl||(fl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&ul(n,t,r)),Nl(e,t,n);break;case 21:Nl(e,t,n);break;case 22:Tl=(r=Tl)||null!==n.memoizedState,Nl(e,t,n),Tl=r;break;default:Nl(e,t,n)}}function Rl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Nf(e)}catch(n){hu(t,t.return,n)}}function Ol(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){var r=gu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Pl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(ph(l.type)){Cl=l.stateNode,Al=!1;break e}break;case 5:Cl=l.stateNode,Al=!1;break e;case 3:case 4:Cl=l.stateNode.containerInfo,Al=!0;break e}l=l.return}if(null===Cl)throw Error(i(160));Il(s,o,a),Cl=null,Al=!1,null!==(s=a.alternate)&&(s.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ll(t,e),t=t.sibling}var Dl=null;function Ll(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Pl(t,e),Ml(e),4&r&&(ll(3,e,e.return),ol(3,e),ll(5,e,e.return));break;case 1:Pl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),64&r&&wl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=Dl;if(Pl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(s=a.getElementsByTagName("title")[0])||s[je]||s[Oe]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=a.createElement(r),a.head.insertBefore(s,a.querySelector("head > title"))),th(s,r,n),s[Oe]=e,qe(s),r=s;break e;case"link":var o=zh("link","href",a).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}th(s=a.createElement(r),r,n),a.head.appendChild(s);break;case"meta":if(o=zh("meta","content",a).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}th(s=a.createElement(r),r,n),a.head.appendChild(s);break;default:throw Error(i(468,r))}s[Oe]=e,qe(s),r=s}e.stateNode=r}else Vh(a,e.type,e.stateNode);else e.stateNode=Lh(a,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?Vh(a,e.type,e.stateNode):Lh(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&pl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Pl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),null!==n&&4&r&&pl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Pl(t,e),Ml(e),512&r&&(Tl||null===n||fl(n,n.return)),32&e.flags){a=e.stateNode;try{Et(a,"")}catch(p){hu(e,e.return,p)}}4&r&&null!=e.stateNode&&pl(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(El=!0);break;case 6:if(Pl(t,e),Ml(e),4&r){if(null===e.stateNode)throw Error(i(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){hu(e,e.return,p)}}break;case 3:if(jh=null,a=Dl,Dl=_h(t.containerInfo),Pl(t,e),Dl=a,Ml(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Nf(t.containerInfo)}catch(p){hu(e,e.return,p)}El&&(El=!1,Fl(e));break;case 4:r=Dl,Dl=_h(e.stateNode.containerInfo),Pl(t,e),Ml(e),Dl=r;break;case 12:default:Pl(t,e),Ml(e);break;case 13:Pl(t,e),Ml(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Ec=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ol(e,r)));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=wl,h=Tl;if(wl=u||a,Tl=h||c,Pl(t,e),Tl=h,wl=u,Ml(e),8192&r)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||wl||Tl||jl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,a)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,d=void 0!==f&&null!==f&&f.hasOwnProperty("display")?f.display:null;l.style.display=null==d||"boolean"===typeof d?"":(""+d).trim()}}catch(p){hu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(p){hu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Ol(e,n))));break;case 19:Pl(t,e),Ml(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ol(e,r)));case 30:case 21:}}function Ml(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(ml(r)){n=r;break}r=r.return}if(null==n)throw Error(i(160));switch(n.tag){case 27:var a=n.stateNode;yl(e,gl(e),a);break;case 5:var s=n.stateNode;32&n.flags&&(Et(s,""),n.flags&=-33),yl(e,gl(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;vl(e,gl(e),o);break;default:throw Error(i(161))}}catch(l){hu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Fl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Fl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Ul(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)_l(e,t.alternate,t),t=t.sibling}function jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ll(4,t,t.return),jl(t);break;case 1:fl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&ul(t,t.return,n),jl(t);break;case 27:Eh(t.stateNode);case 26:case 5:fl(t,t.return),jl(t);break;case 22:null===t.memoizedState&&jl(t);break;default:jl(t)}e=e.sibling}}function zl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:zl(a,s,n),ol(4,s);break;case 1:if(zl(a,s,n),"function"===typeof(a=(r=s).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){hu(r,r.return,c)}if(null!==(a=(r=s).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)fs(l[a],o)}catch(c){hu(r,r.return,c)}}n&&64&i&&cl(s),hl(s,s.return);break;case 27:bl(s);case 26:case 5:zl(a,s,n),n&&null===r&&4&i&&dl(s),hl(s,s.return);break;case 12:zl(a,s,n);break;case 13:zl(a,s,n),n&&4&i&&Rl(a,s);break;case 22:null===s.memoizedState&&zl(a,s,n),hl(s,s.return);break;case 30:break;default:zl(a,s,n)}t=t.sibling}}function Vl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Da(n))}function Bl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e))}function Hl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Wl(e,t,n,r),t=t.sibling}function Wl(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Hl(e,t,n,r),2048&a&&ol(9,t);break;case 1:case 13:default:Hl(e,t,n,r);break;case 3:Hl(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Da(e)));break;case 12:if(2048&a){Hl(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){hu(t,t.return,l)}}else Hl(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Hl(e,t,n,r):$l(e,t):2&s._visibility?Hl(e,t,n,r):(s._visibility|=2,ql(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&a&&Vl(i,t);break;case 24:Hl(e,t,n,r),2048&a&&Bl(t.alternate,t)}}function ql(e,t,n,r,a){for(a=a&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,i=t,o=n,l=r,c=i.flags;switch(i.tag){case 0:case 11:case 15:ql(s,i,o,l,a),ol(8,i);break;case 23:break;case 22:var u=i.stateNode;null!==i.memoizedState?2&u._visibility?ql(s,i,o,l,a):$l(s,i):(u._visibility|=2,ql(s,i,o,l,a)),a&&2048&c&&Vl(i.alternate,i);break;case 24:ql(s,i,o,l,a),a&&2048&c&&Bl(i.alternate,i);break;default:ql(s,i,o,l,a)}t=t.sibling}}function $l(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:$l(n,r),2048&a&&Vl(r.alternate,r);break;case 24:$l(n,r),2048&a&&Bl(r.alternate,r);break;default:$l(n,r)}t=t.sibling}}var Gl=8192;function Kl(e){if(e.subtreeFlags&Gl)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 26:Kl(e),e.flags&Gl&&null!==e.memoizedState&&function(e,t,n){if(null===Hh)throw Error(i(475));var r=Hh;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var a=Ih(n.href),s=e.querySelector(Rh(a));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=qh.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=s,void qe(s);s=e.ownerDocument||e,n=Oh(n),(a=Sh.get(a))&&Fh(n,a),qe(s=s.createElement("link"));var o=s;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),th(s,"link",n),t.instance=s}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=qh.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Dl,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Dl;Dl=_h(e.stateNode.containerInfo),Kl(e),Dl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Gl,Gl=16777216,Kl(e),Gl=t):Kl(e))}}function Xl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Yl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];kl=r,ec(r,e)}Xl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Jl(e),e=e.sibling}function Jl(e){switch(e.tag){case 0:case 11:case 15:Yl(e),2048&e.flags&&ll(9,e,e.return);break;case 3:case 12:default:Yl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):Yl(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];kl=r,ec(r,e)}Xl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ll(8,t,t.return),Zl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function ec(e,t){for(;null!==kl;){var n=kl;switch(n.tag){case 0:case 11:case 15:ll(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Da(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,kl=r;else e:for(n=e;null!==kl;){var a=(r=kl).sibling,s=r.return;if(xl(r),r===n){kl=null;break e}if(null!==a){a.return=s,kl=a;break e}kl=s}}}var tc={getCacheForType:function(e){var t=xa(Oa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},nc="function"===typeof WeakMap?WeakMap:Map,rc=0,ac=null,sc=null,ic=0,oc=0,lc=null,cc=!1,uc=!1,hc=!1,fc=0,dc=0,pc=0,mc=0,gc=0,vc=0,yc=0,bc=null,wc=null,Tc=!1,Ec=0,Sc=1/0,kc=null,_c=null,xc=0,Cc=null,Ac=null,Nc=0,Ic=0,Rc=null,Oc=null,Pc=0,Dc=null;function Lc(){if(0!==(2&rc)&&0!==ic)return ic&-ic;if(null!==D.T){return 0!==Fa?Fa:Iu()}return Ie()}function Mc(){0===vc&&(vc=0===(536870912&ic)||sa?Ee():536870912);var e=ao.current;return null!==e&&(e.flags|=32),vc}function Fc(e,t,n){(e!==ac||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Wc(e,0),Vc(e,ic,vc,!1)),_e(e,n),0!==(2&rc)&&e===ac||(e===ac&&(0===(2&rc)&&(mc|=n),4===dc&&Vc(e,ic,vc,!1)),Su(e))}function Uc(e,t,n){if(0!==(6&rc))throw Error(i(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||we(e,t),a=r?function(e,t){var n=rc;rc|=2;var r=$c(),a=Gc();ac!==e||ic!==t?(kc=null,Sc=te()+500,Wc(e,t)):uc=we(e,t);e:for(;;)try{if(0!==oc&&null!==sc){t=sc;var s=lc;t:switch(oc){case 1:oc=0,lc=null,eu(e,t,s,1);break;case 2:case 9:if(Qa(s)){oc=0,lc=null,Zc(t);break}t=function(){2!==oc&&9!==oc||ac!==e||(oc=7),Su(e)},s.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Qa(s)?(oc=0,lc=null,Zc(t)):(oc=0,lc=null,eu(e,t,s,7));break;case 5:var o=null;switch(sc.tag){case 26:o=sc.memoizedState;case 5:case 27:var l=sc;if(!o||Bh(o)){oc=0,lc=null;var c=l.sibling;if(null!==c)sc=c;else{var u=l.return;null!==u?(sc=u,tu(u)):sc=null}break t}}oc=0,lc=null,eu(e,t,s,5);break;case 6:oc=0,lc=null,eu(e,t,s,6);break;case 8:Hc(),dc=6;break e;default:throw Error(i(462))}}Yc();break}catch(h){qc(e,h)}return ya=va=null,D.H=r,D.A=a,rc=n,null!==sc?0:(ac=null,ic=0,Ar(),dc)}(e,t):Qc(e,t,!0),s=r;;){if(0===a){uc&&!r&&Vc(e,t,0,!1);break}if(n=e.current.alternate,!s||zc(n)){if(2===a){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=bc;var c=l.current.memoizedState.isDehydrated;if(c&&(Wc(l,o).flags|=256),2!==(o=Qc(l,o,!1))){if(hc&&!c){l.errorRecoveryDisabledLanes|=s,mc|=s,a=4;break e}s=wc,wc=a,null!==s&&(null===wc?wc=s:wc.push.apply(wc,s))}a=o}if(s=!1,2!==a)continue}}if(1===a){Wc(e,0),Vc(e,t,0,!0);break}e:{switch(r=e,s=a){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Vc(r,t,vc,!cc);break e;case 2:wc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(a=Ec+300-te())){if(Vc(r,t,vc,!cc),0!==be(r,0,!0))break e;r.timeoutHandle=ch(jc.bind(null,r,n,wc,kc,Tc,t,vc,mc,yc,cc,s,2,-0,0),a)}else jc(r,n,wc,kc,Tc,t,vc,mc,yc,cc,s,0,-0,0)}break}a=Qc(e,t,!1),s=!1}Su(e)}function jc(e,t,n,r,a,s,o,l,c,u,h,f,d,p){if(e.timeoutHandle=-1,(8192&(f=t.subtreeFlags)||16785408===(16785408&f))&&(Hh={stylesheets:null,count:0,unsuspend:Wh},Ql(t),null!==(f=function(){if(null===Hh)throw Error(i(475));var e=Hh;return e.stylesheets&&0===e.count&&Gh(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Gh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=f(ru.bind(null,e,t,s,n,r,a,o,l,c,h,1,d,p)),void Vc(e,s,o,!u);ru(e,t,s,n,r,a,o,l,c)}function zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!Qn(s(),a))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vc(e,t,n,r){t&=~gc,t&=~mc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var s=31-de(a),i=1<<s;r[s]=-1,a&=~i}0!==n&&xe(e,n,t)}function Bc(){return 0!==(6&rc)||(ku(0,!1),!1)}function Hc(){if(null!==sc){if(0===oc)var e=sc.return;else ya=va=null,Us(e=sc),Qi=null,Xi=0,e=sc;for(;null!==e;)il(e.alternate,e),e=e.return;sc=null}}function Wc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,uh(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Hc(),ac=e,sc=n=Ur(e.current,null),ic=t,oc=0,lc=null,cc=!1,uc=we(e,t),hc=!1,yc=vc=gc=mc=pc=dc=0,wc=bc=null,Tc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-de(r),s=1<<a;t|=e[a],r&=~s}return fc=t,Ar(),n}function qc(e,t){ws=null,D.H=qi,t===qa||t===Ga?(t=Za(),oc=3):t===$a?(t=Za(),oc=4):oc=t===Co?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,lc=t,null===sc&&(dc=1,Eo(e,kr(t,e.current)))}function $c(){var e=D.H;return D.H=qi,null===e?qi:e}function Gc(){var e=D.A;return D.A=tc,e}function Kc(){dc=4,cc||(4194048&ic)!==ic&&null!==ao.current||(uc=!0),0===(134217727&pc)&&0===(134217727&mc)||null===ac||Vc(ac,ic,vc,!1)}function Qc(e,t,n){var r=rc;rc|=2;var a=$c(),s=Gc();ac===e&&ic===t||(kc=null,Wc(e,t)),t=!1;var i=dc;e:for(;;)try{if(0!==oc&&null!==sc){var o=sc,l=lc;switch(oc){case 8:Hc(),i=6;break e;case 3:case 2:case 9:case 6:null===ao.current&&(t=!0);var c=oc;if(oc=0,lc=null,eu(e,o,l,c),n&&uc){i=0;break e}break;default:c=oc,oc=0,lc=null,eu(e,o,l,c)}}Xc(),i=dc;break}catch(u){qc(e,u)}return t&&e.shellSuspendCounter++,ya=va=null,rc=r,D.H=a,D.A=s,null===sc&&(ac=null,ic=0,Ar()),i}function Xc(){for(;null!==sc;)Jc(sc)}function Yc(){for(;null!==sc&&!Z();)Jc(sc)}function Jc(e){var t=Jo(e.alternate,e,fc);e.memoizedProps=e.pendingProps,null===t?tu(e):sc=t}function Zc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Fo(n,t,t.pendingProps,t.type,void 0,ic);break;case 11:t=Fo(n,t,t.pendingProps,t.type.render,t.ref,ic);break;case 5:Us(t);default:il(n,t),t=Jo(n,t=sc=jr(t,fc),fc)}e.memoizedProps=e.pendingProps,null===t?tu(e):sc=t}function eu(e,t,n,r){ya=va=null,Us(t),Qi=null,Xi=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Sa(t,n,a,!0),null!==(n=ao.current)){switch(n.tag){case 13:return null===so?Kc():null===n.alternate&&0===dc&&(dc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===Ka?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),fu(e,r,a)),!1;case 22:return n.flags|=65536,r===Ka?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),fu(e,r,a)),!1}throw Error(i(435,n.tag))}return fu(e,r,a),Kc(),!1}if(sa)return null!==(t=ao.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==la&&ma(kr(e=Error(i(422),{cause:r}),n))):(r!==la&&ma(kr(t=Error(i(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=kr(r,n),ls(e,a=ko(e.stateNode,r,a)),4!==dc&&(dc=2)),!1;var s=Error(i(520),{cause:r});if(s=kr(s,n),null===bc?bc=[s]:bc.push(s),4!==dc&&(dc=2),null===t)return!0;r=kr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,ls(n,e=ko(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===_c||!_c.has(s))))return n.flags|=65536,a&=-a,n.lanes|=a,xo(a=_o(a),e,n,r),ls(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,ic))return dc=1,Eo(e,kr(n,e.current)),void(sc=null)}catch(s){if(null!==a)throw sc=a,s;return dc=1,Eo(e,kr(n,e.current)),void(sc=null)}32768&t.flags?(sa||1===r?e=!0:uc||0!==(536870912&ic)?e=!1:(cc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ao.current)&&13===r.tag&&(r.flags|=16384))),nu(t,e)):tu(t)}function tu(e){var t=e;do{if(0!==(32768&t.flags))return void nu(t,cc);e=t.return;var n=al(t.alternate,t,fc);if(null!==n)return void(sc=n);if(null!==(t=t.sibling))return void(sc=t);sc=t=e}while(null!==t);0===dc&&(dc=5)}function nu(e,t){do{var n=sl(e.alternate,e);if(null!==n)return n.flags&=32767,void(sc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(sc=e);sc=e=n}while(null!==e);dc=6,sc=null}function ru(e,t,n,r,a,s,o,l,c){e.cancelPendingCommit=null;do{lu()}while(0!==xc);if(0!==(6&rc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,a,s){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var u=31-de(n),h=1<<u;o[u]=0,l[u]=-1;var f=c[u];if(null!==f)for(c[u]=null,u=0;u<f.length;u++){var d=f[u];null!==d&&(d.lane&=-536870913)}n&=~h}0!==r&&xe(e,r,0),0!==s&&0===a&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,n,s|=Cr,o,l,c),e===ac&&(sc=ac=null,ic=0),Ac=t,Cc=e,Nc=n,Ic=s,Rc=a,Oc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,Y(se,function(){return cu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=D.T,D.T=null,a=L.p,L.p=2,o=rc,rc|=4;try{!function(e,t){if(e=e.containerInfo,nh=rf,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==a&&3!==f.nodeType||(l=o+a),f!==s||0!==r&&3!==f.nodeType||(c=o+r),3===f.nodeType&&(o+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++u===a&&(l=o),d===s&&++h===r&&(c=o),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rh={focusedElem:e,selectionRange:n},rf=!1,kl=t;null!==kl;)if(e=(t=kl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,kl=e;else for(;null!==kl;){switch(s=(t=kl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,a=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var m=vo(n.type,a,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){hu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))gh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,kl=e;break}kl=t.return}}(e,t)}finally{rc=o,L.p=a,D.T=r}}xc=1,au(),su(),iu()}}function au(){if(1===xc){xc=0;var e=Cc,t=Ac,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=D.T,D.T=null;var r=L.p;L.p=2;var a=rc;rc|=4;try{Ll(t,e);var s=rh,i=er(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&Zn(o.ownerDocument.documentElement,o)){if(null!==l&&tr(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,f=h&&h.defaultView||window;if(f.getSelection){var d=f.getSelection(),p=o.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!d.extend&&m>g&&(i=g,g=m,m=i);var v=Jn(o,m),y=Jn(o,g);if(v&&y&&(1!==d.rangeCount||d.anchorNode!==v.node||d.anchorOffset!==v.offset||d.focusNode!==y.node||d.focusOffset!==y.offset)){var b=h.createRange();b.setStart(v.node,v.offset),d.removeAllRanges(),m>g?(d.addRange(b),d.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),d.addRange(b))}}}}for(h=[],d=o;d=d.parentNode;)1===d.nodeType&&h.push({element:d,left:d.scrollLeft,top:d.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<h.length;o++){var w=h[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}rf=!!nh,rh=nh=null}finally{rc=a,L.p=r,D.T=n}}e.current=t,xc=2}}function su(){if(2===xc){xc=0;var e=Cc,t=Ac,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=D.T,D.T=null;var r=L.p;L.p=2;var a=rc;rc|=4;try{_l(e,t.alternate,t)}finally{rc=a,L.p=r,D.T=n}}xc=3}}function iu(){if(4===xc||3===xc){xc=0,ee();var e=Cc,t=Ac,n=Nc,r=Oc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?xc=5:(xc=0,Ac=Cc=null,ou(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(_c=null),Ne(n),t=t.stateNode,he&&"function"===typeof he.onCommitFiberRoot)try{he.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=D.T,a=L.p,L.p=2,D.T=null;try{for(var s=e.onRecoverableError,i=0;i<r.length;i++){var o=r[i];s(o.value,{componentStack:o.stack})}}finally{D.T=t,L.p=a}}0!==(3&Nc)&&lu(),Su(e),a=e.pendingLanes,0!==(4194090&n)&&0!==(42&a)?e===Dc?Pc++:(Pc=0,Dc=e):Pc=0,ku(0,!1)}}function ou(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Da(t)))}function lu(e){return au(),su(),iu(),cu()}function cu(){if(5!==xc)return!1;var e=Cc,t=Ic;Ic=0;var n=Ne(Nc),r=D.T,a=L.p;try{L.p=32>n?32:n,D.T=null,n=Rc,Rc=null;var s=Cc,o=Nc;if(xc=0,Ac=Cc=null,Nc=0,0!==(6&rc))throw Error(i(331));var l=rc;if(rc|=4,Jl(s.current),Wl(s,s.current,o,n),rc=l,ku(0,!1),he&&"function"===typeof he.onPostCommitFiberRoot)try{he.onPostCommitFiberRoot(ue,s)}catch(c){}return!0}finally{L.p=a,D.T=r,ou(e,t)}}function uu(e,t,n){t=kr(n,t),null!==(e=is(e,t=ko(e.stateNode,t,2),2))&&(_e(e,2),Su(e))}function hu(e,t,n){if(3===e.tag)uu(e,e,n);else for(;null!==t;){if(3===t.tag){uu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===_c||!_c.has(r))){e=kr(n,e),null!==(r=is(t,n=_o(2),2))&&(xo(n,r,t,e),_e(r,2),Su(r));break}}t=t.return}}function fu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new nc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(hc=!0,a.add(n),e=du.bind(null,e,t,n),t.then(e,e))}function du(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ac===e&&(ic&n)===n&&(4===dc||3===dc&&(62914560&ic)===ic&&300>te()-Ec?0===(2&rc)&&Wc(e,0):gc|=n,yc===ic&&(yc=0)),Su(e)}function pu(e,t){0===t&&(t=Se()),null!==(e=Rr(e,t))&&(_e(e,t),Su(e))}function mu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),pu(e,n)}function gu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==r&&r.delete(t),pu(e,n)}var vu=null,yu=null,bu=!1,wu=!1,Tu=!1,Eu=0;function Su(e){e!==yu&&null===e.next&&(null===yu?vu=yu=e:yu=yu.next=e),wu=!0,bu||(bu=!0,fh(function(){0!==(6&rc)?Y(re,_u):xu()}))}function ku(e,t){if(!Tu&&wu){Tu=!0;do{for(var n=!1,r=vu;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var s=0;else{var i=r.suspendedLanes,o=r.pingedLanes;s=(1<<31-de(42|e)+1)-1,s=201326741&(s&=a&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,Nu(r,s))}else s=ic,0===(3&(s=be(r,r===ac?s:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||we(r,s)||(n=!0,Nu(r,s));r=r.next}}while(n);Tu=!1}}function _u(){xu()}function xu(){wu=bu=!1;var e=0;0!==Eu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==lh&&(lh=e,!0);return lh=null,!1}()&&(e=Eu),Eu=0);for(var t=te(),n=null,r=vu;null!==r;){var a=r.next,s=Cu(r,t);0===s?(r.next=null,null===n?vu=a:n.next=a,null===a&&(yu=n)):(n=r,(0!==e||0!==(3&s))&&(wu=!0)),r=a}ku(e,!1)}function Cu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-de(s),o=1<<i,l=a[i];-1===l?0!==(o&n)&&0===(o&r)||(a[i]=Te(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(n=ic,n=be(e,e===(t=ac)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&J(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||we(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&J(r),Ne(n)){case 2:case 8:n=ae;break;case 32:default:n=se;break;case 268435456:n=oe}return r=Au.bind(null,e),n=Y(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&J(r),e.callbackPriority=2,e.callbackNode=null,2}function Au(e,t){if(0!==xc&&5!==xc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(lu()&&e.callbackNode!==n)return null;var r=ic;return 0===(r=be(e,e===ac?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Uc(e,r,t),Cu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Au.bind(null,e):null)}function Nu(e,t){if(lu())return null;Uc(e,t,!0)}function Iu(){return 0===Eu&&(Eu=Ee()),Eu}function Ru(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Nt(""+e)}function Ou(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Pu=0;Pu<Tr.length;Pu++){var Du=Tr[Pu];Er(Du.toLowerCase(),"on"+(Du[0].toUpperCase()+Du.slice(1)))}Er(dr,"onAnimationEnd"),Er(pr,"onAnimationIteration"),Er(mr,"onAnimationStart"),Er("dblclick","onDoubleClick"),Er("focusin","onFocus"),Er("focusout","onBlur"),Er(gr,"onTransitionRun"),Er(vr,"onTransitionStart"),Er(yr,"onTransitionCancel"),Er(br,"onTransitionEnd"),Qe("onMouseEnter",["mouseout","mouseover"]),Qe("onMouseLeave",["mouseout","mouseover"]),Qe("onPointerEnter",["pointerout","pointerover"]),Qe("onPointerLeave",["pointerout","pointerover"]),Ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lu));function Fu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(u){yo(u)}a.currentTarget=null,s=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;s=o,a.currentTarget=c;try{s(a)}catch(u){yo(u)}a.currentTarget=null,s=l}}}}function Uu(e,t){var n=t[Le];void 0===n&&(n=t[Le]=new Set);var r=e+"__bubble";n.has(r)||(Bu(t,e,2,!1),n.add(r))}function ju(e,t,n){var r=0;t&&(r|=4),Bu(n,e,r,t)}var zu="_reactListening"+Math.random().toString(36).slice(2);function Vu(e){if(!e[zu]){e[zu]=!0,$e.forEach(function(t){"selectionchange"!==t&&(Mu.has(t)||ju(t,!1,e),ju(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zu]||(t[zu]=!0,ju("selectionchange",!1,t))}}function Bu(e,t,n,r){switch(hf(t)){case 2:var a=af;break;case 8:a=sf;break;default:a=of}n=a.bind(null,t,n,e),a=void 0,!jt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hu(e,t,n,r,a){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===a)break;if(4===i)for(i=r.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===a)return;i=i.return}for(;null!==o;){if(null===(i=Ve(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){r=s=i;continue e}o=o.parentNode}}r=r.return}Mt(function(){var r=s,a=Rt(n),i=[];e:{var o=wr.get(e);if(void 0!==o){var c=Zt,u=e;switch(e){case"keypress":if(0===qt(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case dr:case pr:case mr:c=on;break;case br:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=wn}var h=0!==(4&t),f=!h&&("scroll"===e||"scrollend"===e),d=h?null!==o?o+"Capture":null:o;h=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===d||null!=(g=Ft(m,d))&&h.push(Wu(m,g,p)),f)break;m=m.return}0<h.length&&(o=new c(o,u,null,n,a),i.push({event:o,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===It||!(u=n.relatedTarget||n.fromElement)||!Ve(u)&&!u[De])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Ve(u):null)&&(f=l(u),h=u.tag,u!==f||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=r),c!==u)){if(h=rn,g="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=gn,g="onPointerLeave",d="onPointerEnter",m="pointer"),f=null==c?o:He(c),p=null==u?o:He(u),(o=new h(g,m+"leave",c,n,a)).target=f,o.relatedTarget=p,g=null,Ve(a)===r&&((h=new h(d,m+"enter",u,n,a)).target=p,h.relatedTarget=f,g=h),f=g,c&&u)e:{for(d=u,m=0,p=h=c;p;p=$u(p))m++;for(p=0,g=d;g;g=$u(g))p++;for(;0<m-p;)h=$u(h),m--;for(;0<p-m;)d=$u(d),p--;for(;m--;){if(h===d||null!==d&&h===d.alternate)break e;h=$u(h),d=$u(d)}h=null}else h=null;null!==c&&Gu(i,o,c,h,!1),null!==u&&null!==f&&Gu(i,f,u,h,!0)}if("select"===(c=(o=r?He(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=Un;else if(On(o))if(jn)v=Kn;else{v=$n;var y=qn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&xt(r.elementType)&&(v=Un):v=Gn;switch(v&&(v=v(e,r))?Pn(i,v,n,a):(y&&y(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&yt(o,"number",o.value)),y=r?He(r):window,e){case"focusin":(On(y)||"true"===y.contentEditable)&&(rr=y,ar=r,sr=null);break;case"focusout":sr=ar=rr=null;break;case"mousedown":ir=!0;break;case"contextmenu":case"mouseup":case"dragend":ir=!1,or(i,n,a);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":or(i,n,a)}var b;if(En)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else In?An(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(_n&&"ko"!==n.locale&&(In||"onCompositionStart"!==w?"onCompositionEnd"===w&&In&&(b=Wt()):(Bt="value"in(Vt=a)?Vt.value:Vt.textContent,In=!0)),0<(y=qu(r,w)).length&&(w=new cn(w,e,null,n,a),i.push({event:w,listeners:y}),b?w.data=b:null!==(b=Nn(n))&&(w.data=b))),(b=kn?function(e,t){switch(e){case"compositionend":return Nn(t);case"keypress":return 32!==t.which?null:(Cn=!0,xn);case"textInput":return(e=t.data)===xn&&Cn?null:e;default:return null}}(e,n):function(e,t){if(In)return"compositionend"===e||!En&&An(e,t)?(e=Wt(),Ht=Bt=Vt=null,In=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=qu(r,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,a),i.push({event:y,listeners:w}),y.data=b)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var s=Ru((a[Pe]||null).action),i=r.submitter;i&&null!==(t=(t=i[Pe]||null)?Ru(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new Zt("action","action",null,r,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Eu){var e=i?Ou(a,i):new FormData(a);Ri(n,{pending:!0,data:e,method:a.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Ou(a,i):new FormData(a),Ri(n,{pending:!0,data:e,method:a.method,action:s},s,e))},currentTarget:a}]})}}(i,e,r,n,a)}Fu(i,t)})}function Wu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===s||(null!=(a=Ft(e,n))&&r.unshift(Wu(e,a,s)),null!=(a=Ft(e,t))&&r.push(Wu(e,a,s))),3===e.tag)return r;e=e.return}return[]}function $u(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Gu(e,t,n,r,a){for(var s=t._reactName,i=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Ft(n,s))&&i.unshift(Wu(n,c,l)):a||null!=(c=Ft(n,s))&&i.push(Wu(n,c,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Ku=/\r\n?/g,Qu=/\u0000|\uFFFD/g;function Xu(e){return("string"===typeof e?e:""+e).replace(Ku,"\n").replace(Qu,"")}function Yu(e,t){return t=Xu(t),Xu(e)===t}function Ju(){}function Zu(e,t,n,r,a,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":_t(e,r,s);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Nt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Zu(e,t,"name",a.name,a,null),Zu(e,t,"formEncType",a.formEncType,a,null),Zu(e,t,"formMethod",a.formMethod,a,null),Zu(e,t,"formTarget",a.formTarget,a,null)):(Zu(e,t,"encType",a.encType,a,null),Zu(e,t,"method",a.method,a,null),Zu(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Nt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Ju);break;case"onScroll":null!=r&&Uu("scroll",e);break;case"onScrollEnd":null!=r&&Uu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Nt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Uu("beforetoggle",e),Uu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Ct.get(n)||n,r)}}function eh(e,t,n,r,a,s){switch(n){case"style":_t(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(i(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&Uu("scroll",e);break;case"onScrollEnd":null!=r&&Uu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ge.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(s=null!=(s=e[Pe]||null)?s[n]:null)&&e.removeEventListener(t,s,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function th(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Uu("error",e),Uu("load",e);var r,a=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":a=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Zu(e,t,r,o,n,null)}}return s&&Zu(e,t,"srcSet",n.srcSet,n,null),void(a&&Zu(e,t,"src",n.src,n,null));case"input":Uu("invalid",e);var l=r=o=s=null,c=null,u=null;for(a in n)if(n.hasOwnProperty(a)){var h=n[a];if(null!=h)switch(a){case"name":s=h;break;case"type":o=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(i(137,t));break;default:Zu(e,t,a,h,n,null)}}return vt(e,r,l,c,u,o,s,!1),void ht(e);case"select":for(s in Uu("invalid",e),a=o=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:Zu(e,t,s,l,n,null)}return t=r,n=o,e.multiple=!!a,void(null!=t?bt(e,!!a,t,!1):null!=n&&bt(e,!!a,n,!0));case"textarea":for(o in Uu("invalid",e),r=s=a=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":a=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:Zu(e,t,o,l,n,null)}return Tt(e,a,s,r),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else Zu(e,t,c,a,n,null);return;case"dialog":Uu("beforetoggle",e),Uu("toggle",e),Uu("cancel",e),Uu("close",e);break;case"iframe":case"object":Uu("load",e);break;case"video":case"audio":for(a=0;a<Lu.length;a++)Uu(Lu[a],e);break;case"image":Uu("error",e),Uu("load",e);break;case"details":Uu("toggle",e);break;case"embed":case"source":case"link":Uu("error",e),Uu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(a=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Zu(e,t,u,a,n,null)}return;default:if(xt(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(a=n[h])&&eh(e,t,h,a,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(a=n[l])&&Zu(e,t,l,a,n,null))}var nh=null,rh=null;function ah(e){return 9===e.nodeType?e:e.ownerDocument}function sh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ih(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function oh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var lh=null;var ch="function"===typeof setTimeout?setTimeout:void 0,uh="function"===typeof clearTimeout?clearTimeout:void 0,hh="function"===typeof Promise?Promise:void 0,fh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof hh?function(e){return hh.resolve(null).then(e).catch(dh)}:ch;function dh(e){setTimeout(function(){throw e})}function ph(e){return"head"===e}function mh(e,t){var n=t,r=0,a=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0<r&&8>r){n=r;var i=e.ownerDocument;if(1&n&&Eh(i.documentElement),2&n&&Eh(i.body),4&n)for(Eh(n=i.head),i=n.firstChild;i;){var o=i.nextSibling,l=i.nodeName;i[je]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=o}}if(0===a)return e.removeChild(s),void Nf(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:r=n.charCodeAt(0)-48;else r=0;n=s}while(n);Nf(t)}function gh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":gh(n),ze(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function vh(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function yh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var bh=null;function wh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Th(e,t,n){switch(t=ah(n),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Eh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);ze(e)}var Sh=new Map,kh=new Set;function _h(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var xh=L.d;L.d={f:function(){var e=xh.f(),t=Bc();return e||t},r:function(e){var t=Be(e);null!==t&&5===t.tag&&"form"===t.type?Pi(t):xh.r(e)},D:function(e){xh.D(e),Ah("dns-prefetch",e,null)},C:function(e,t){xh.C(e,t),Ah("preconnect",e,t)},L:function(e,t,n){xh.L(e,t,n);var r=Ch;if(r&&e&&t){var a='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+mt(n.imageSizes)+'"]')):a+='[href="'+mt(e)+'"]';var s=a;switch(t){case"style":s=Ih(e);break;case"script":s=Ph(e)}Sh.has(s)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sh.set(s,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Rh(s))||"script"===t&&r.querySelector(Dh(s))||(th(t=r.createElement("link"),"link",e),qe(t),r.head.appendChild(t)))}},m:function(e,t){xh.m(e,t);var n=Ch;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',s=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Ph(e)}if(!Sh.has(s)&&(e=f({rel:"modulepreload",href:e},t),Sh.set(s,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Dh(s)))return}th(r=n.createElement("link"),"link",e),qe(r),n.head.appendChild(r)}}},X:function(e,t){xh.X(e,t);var n=Ch;if(n&&e){var r=We(n).hoistableScripts,a=Ph(e),s=r.get(a);s||((s=n.querySelector(Dh(a)))||(e=f({src:e,async:!0},t),(t=Sh.get(a))&&Uh(e,t),qe(s=n.createElement("script")),th(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(a,s))}},S:function(e,t,n){xh.S(e,t,n);var r=Ch;if(r&&e){var a=We(r).hoistableStyles,s=Ih(e);t=t||"default";var i=a.get(s);if(!i){var o={loading:0,preload:null};if(i=r.querySelector(Rh(s)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sh.get(s))&&Fh(e,n);var l=i=r.createElement("link");qe(l),th(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Mh(i,t,r)}i={type:"stylesheet",instance:i,count:1,state:o},a.set(s,i)}}},M:function(e,t){xh.M(e,t);var n=Ch;if(n&&e){var r=We(n).hoistableScripts,a=Ph(e),s=r.get(a);s||((s=n.querySelector(Dh(a)))||(e=f({src:e,async:!0,type:"module"},t),(t=Sh.get(a))&&Uh(e,t),qe(s=n.createElement("script")),th(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(a,s))}}};var Ch="undefined"===typeof document?null:document;function Ah(e,t,n){var r=Ch;if(r&&"string"===typeof t&&t){var a=mt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),kh.has(a)||(kh.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(th(t=r.createElement("link"),"link",e),qe(t),r.head.appendChild(t)))}}function Nh(e,t,n,r){var a,s,o,l,c=(c=W.current)?_h(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Ih(n.href),(r=(n=We(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Ih(n.href);var u=We(c).hoistableStyles,h=u.get(e);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=c.querySelector(Rh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),Sh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sh.set(e,n),u||(a=c,s=e,o=n,l=h.state,a.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=a.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),th(s,"link",o),qe(s),a.head.appendChild(s))))),t&&null===r)throw Error(i(528,""));return h}if(t&&null!==r)throw Error(i(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Ph(n),(r=(n=We(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Ih(e){return'href="'+mt(e)+'"'}function Rh(e){return'link[rel="stylesheet"]['+e+"]"}function Oh(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Ph(e){return'[src="'+mt(e)+'"]'}function Dh(e){return"script[async]"+e}function Lh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,qe(r),r;var a=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return qe(r=(e.ownerDocument||e).createElement("style")),th(r,"style",a),Mh(r,n.precedence,e),t.instance=r;case"stylesheet":a=Ih(n.href);var s=e.querySelector(Rh(a));if(s)return t.state.loading|=4,t.instance=s,qe(s),s;r=Oh(n),(a=Sh.get(a))&&Fh(r,a),qe(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),th(s,"link",r),t.state.loading|=4,Mh(s,n.precedence,e),t.instance=s;case"script":return s=Ph(n.src),(a=e.querySelector(Dh(s)))?(t.instance=a,qe(a),a):(r=n,(a=Sh.get(s))&&Uh(r=f({},n),a),qe(a=(e=e.ownerDocument||e).createElement("script")),th(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Mh(r,n.precedence,e));return t.instance}function Mh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,s=a,i=0;i<r.length;i++){var o=r[i];if(o.dataset.precedence===t)s=o;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Fh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Uh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var jh=null;function zh(e,t,n){if(null===jh){var r=new Map,a=jh=new Map;a.set(n,r)}else(r=(a=jh).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var s=n[a];if(!(s[je]||s[Oe]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=r.get(i);o?o.push(s):r.set(i,[s])}}return r}function Vh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Bh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Hh=null;function Wh(){}function qh(){if(this.count--,0===this.count)if(this.stylesheets)Gh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var $h=null;function Gh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,$h=new Map,t.forEach(Kh,e),$h=null,qh.call(e))}function Kh(e,t){if(!(4&t.state.loading)){var n=$h.get(e);if(n)var r=n.get(null);else{n=new Map,$h.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var i=a[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),r=i)}r&&n.set(null,r)}i=(a=t.instance).getAttribute("data-precedence"),(s=n.get(i)||r)===r&&n.set(null,a),n.set(i,a),this.count++,r=qh.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),s?s.parentNode.insertBefore(a,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var Qh={$$typeof:T,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function Xh(e,t,n,r,a,s,i,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.hiddenUpdates=ke(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Yh(e,t,n,r,a,s,i,o,l,c,u,h){return e=new Xh(e,t,n,i,o,l,c,h),t=1,!0===s&&(t|=24),s=Mr(3,null,null,t),e.current=s,s.stateNode=e,(t=Pa()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},rs(s),e}function Jh(e){return e?e=Dr:Dr}function Zh(e,t,n,r,a,s){a=Jh(a),null===r.context?r.context=a:r.pendingContext=a,(r=ss(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=is(e,r,t))&&(Fc(n,0,t),os(n,e,t))}function ef(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function tf(e,t){ef(e,t),(e=e.alternate)&&ef(e,t)}function nf(e){if(13===e.tag){var t=Rr(e,67108864);null!==t&&Fc(t,0,67108864),tf(e,67108864)}}var rf=!0;function af(e,t,n,r){var a=D.T;D.T=null;var s=L.p;try{L.p=2,of(e,t,n,r)}finally{L.p=s,D.T=a}}function sf(e,t,n,r){var a=D.T;D.T=null;var s=L.p;try{L.p=8,of(e,t,n,r)}finally{L.p=s,D.T=a}}function of(e,t,n,r){if(rf){var a=lf(r);if(null===a)Hu(e,t,r,cf,n),wf(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return df=Tf(df,e,t,n,r,a),!0;case"dragenter":return pf=Tf(pf,e,t,n,r,a),!0;case"mouseover":return mf=Tf(mf,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return gf.set(s,Tf(gf.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,vf.set(s,Tf(vf.get(s)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(wf(e,r),4&t&&-1<bf.indexOf(e)){for(;null!==a;){var s=Be(a);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=ye(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-de(i);o.entanglements[1]|=l,i&=~l}Su(s),0===(6&rc)&&(Sc=te()+500,ku(0,!1))}}break;case 13:null!==(o=Rr(s,2))&&Fc(o,0,2),Bc(),tf(s,2)}if(null===(s=lf(r))&&Hu(e,t,r,cf,n),s===a)break;a=s}null!==a&&r.stopPropagation()}else Hu(e,t,r,null,n)}}function lf(e){return uf(e=Rt(e))}var cf=null;function uf(e){if(cf=null,null!==(e=Ve(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cf=e,null}function hf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ae:return 8;case se:case ie:return 32;case oe:return 268435456;default:return 32}default:return 32}}var ff=!1,df=null,pf=null,mf=null,gf=new Map,vf=new Map,yf=[],bf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wf(e,t){switch(e){case"focusin":case"focusout":df=null;break;case"dragenter":case"dragleave":pf=null;break;case"mouseover":case"mouseout":mf=null;break;case"pointerover":case"pointerout":gf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vf.delete(t.pointerId)}}function Tf(e,t,n,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=Be(t))&&nf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ef(e){var t=Ve(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}(e.priority,function(){if(13===n.tag){var e=Lc();e=Ae(e);var t=Rr(n,e);null!==t&&Fc(t,0,e),tf(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Sf(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=lf(e.nativeEvent);if(null!==n)return null!==(t=Be(n))&&nf(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);It=r,n.target.dispatchEvent(r),It=null,t.shift()}return!0}function kf(e,t,n){Sf(e)&&n.delete(t)}function _f(){ff=!1,null!==df&&Sf(df)&&(df=null),null!==pf&&Sf(pf)&&(pf=null),null!==mf&&Sf(mf)&&(mf=null),gf.forEach(kf),vf.forEach(kf)}function xf(e,t){e.blockedOn===t&&(e.blockedOn=null,ff||(ff=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,_f)))}var Cf=null;function Af(e){Cf!==e&&(Cf=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Cf===e&&(Cf=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===uf(r||n))continue;break}var s=Be(n);null!==s&&(e.splice(t,3),t-=3,Ri(s,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Nf(e){function t(t){return xf(t,e)}null!==df&&xf(df,e),null!==pf&&xf(pf,e),null!==mf&&xf(mf,e),gf.forEach(t),vf.forEach(t);for(var n=0;n<yf.length;n++){var r=yf[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<yf.length&&null===(n=yf[0]).blockedOn;)Ef(n),null===n.blockedOn&&yf.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],s=n[r+1],i=a[Pe]||null;if("function"===typeof s)i||Af(n);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(a=s,i=s[Pe]||null)o=i.formAction;else if(null!==uf(a))continue}else o=i.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),Af(n)}}}function If(e){this._internalRoot=e}function Rf(e){this._internalRoot=e}Rf.prototype.render=If.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Zh(t.current,Lc(),e,t,null,null)},Rf.prototype.unmount=If.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zh(e.current,2,null,e,null,null),Bc(),t[De]=null}},Rf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ie();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yf.length&&0!==t&&t<yf[n].priority;n++);yf.splice(n,0,e),0===n&&Ef(e)}};var Of=a.version;if("19.1.1"!==Of)throw Error(i(527,Of,"19.1.1"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return u(a),e;if(s===r)return u(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=s;break}if(c===r){o=!0,r=a,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=a;break}if(c===r){o=!0,r=s,n=a;break}c=c.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Pf={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{ue=Df.inject(Pf),he=Df}catch(Mf){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var n=!1,r="",a=bo,s=wo,l=To;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Yh(e,1,!1,null,0,n,r,a,s,l,0,null),e[De]=t.current,Vu(e),new If(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(i(299));var r=!1,a="",s=bo,l=wo,c=To,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Yh(e,1,!0,t,0,r,a,s,l,c,0,u)).context=Jh(null),n=t.current,(a=ss(r=Ae(r=Lc()))).callback=null,is(n,a,r),n=r,t.current.lanes=n,_e(t,n),Su(t),e[De]=t.current,Vu(e),new Rf(t)},t.version="19.1.1"},43:(e,t,n)=>{e.exports=n(288)},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var T=Array.isArray,E={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function k(e,t,r,a,s,i){return r=i.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:i}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(){}function N(e,t,a,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case f:return N((u=e._init)(e._payload),t,a,s,i)}}if(u)return i=i(e),u=""===s?"."+C(e,0):s,T(i)?(a="",null!=u&&(a=u.replace(x,"$&/")+"/"),N(i,t,a,"",function(e){return e})):null!=i&&(_(i)&&(l=i,c=a+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(x,"$&/")+"/")+u,i=k(l.type,c,void 0,0,0,l.props)),t.push(i)),1;u=0;var h,p=""===s?".":s+":";if(T(e))for(var m=0;m<e.length;m++)u+=N(s=e[m],t,a,o=p+C(s,m),i);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=d&&h[d]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(s=e.next()).done;)u+=N(s=s.value,t,a,o=p+C(s,m++),i);else if("object"===o){if("function"===typeof e.then)return N(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(A,A):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var r=[],a=0;return N(e,r,"","",function(e){return t.call(n,e,a++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function P(){}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=i,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(a=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];r.children=i}return k(e.type,a,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,a={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var i=arguments.length-2;if(1===i)a.children=n;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(r in i=e.defaultProps)void 0===a[r]&&(a[r]=i[r]);return k(e,s,void 0,0,0,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var r=e(),a=E.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(P,O)}catch(s){O(s)}finally{E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=E.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.1.1"},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var r=n(43);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=n,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:s}):"script"===n&&i.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},799:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=a,t.jsxs=a},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<s(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,i=a>>>1;r<i;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<a&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,d=3,p=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function T(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function E(e){if(g=!1,T(e),!m)if(null!==r(c))m=!0,k||(k=!0,S());else{var t=r(u);null!==t&&O(E,t.startTime-e)}}var S,k=!1,_=-1,x=5,C=-1;function A(){return!!v||!(t.unstable_now()-C<x)}function N(){if(v=!1,k){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(_),_=-1),p=!0;var s=d;try{t:{for(T(e),f=r(c);null!==f&&!(f.expirationTime>e&&A());){var i=f.callback;if("function"===typeof i){f.callback=null,d=f.priorityLevel;var o=i(f.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){f.callback=o,T(e),n=!0;break t}f===r(c)&&a(c),T(e)}else a(c);f=r(c)}if(null!==f)n=!0;else{var l=r(u);null!==l&&O(E,l.startTime-e),n=!1}}break e}finally{f=null,d=s,p=!1}n=void 0}}finally{n?S():k=!1}}}if("function"===typeof w)S=function(){w(N)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,R=I.port2;I.port1.onmessage=N,S=function(){R.postMessage(null)}}else S=function(){y(N,0)};function O(e,n){_=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,a,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(b(_),_=-1):g=!0,O(E,s-i))):(e.sortIndex=o,n(c,e),m||p||(m=!0,k||(k=!0,S()))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var r=n(43),a=n(391);const s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],s=a+1<e.length,i=s?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,u=(3&t)<<4|i>>4;let h=(15&i)<<2|l>>6,f=63&l;o||(f=64,s||(h=64)),r.push(n[c],n[u],n[h],n[f])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const s=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&s)}else if(a>239&&a<365){const s=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],s=a<e.length?n[e.charAt(a)]:0;++a;const i=a<e.length?n[e.charAt(a)]:64;++a;const l=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==s||null==i||null==l)throw new o;const c=t<<2|s>>4;if(r.push(c),64!==i){const e=s<<4&240|i>>2;if(r.push(e),64!==l){const e=i<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l=function(e){return function(e){const t=s(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},c=function(e){try{return i.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function u(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const h=()=>{try{return u().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/quizegon-quiz",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&c(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},f=e=>h()?.emulatorHosts?.[e],d=()=>h()?.config,p=e=>h()?.[`_${e}`];class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function g(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function v(e){return(await fetch(e,{credentials:"include"})).ok}const y={};let b=!1;function w(e,t){if("undefined"===typeof window||"undefined"===typeof document||!g(window.location.host)||y[e]===t||y[e]||b)return;function n(e){return`__firebase__banner__${e}`}y[e]=t;const r="__firebase__banner",a=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(y))y[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),i=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,i,l,n),document.body.appendChild(t)}a?(i.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function T(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function E(){const e=h()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function S(){return!E()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){try{return"object"===typeof indexedDB}catch(e){return!1}}class _ extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,x.prototype.create)}}class x{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],a=r?function(e,t){return e.replace(C,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",s=`${this.serviceName}: ${a} (${n}).`;return new _(n,s,t)}}const C=/\{\$([^}]+)}/g;function A(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],s=t[a];if(N(n)&&N(s)){if(!A(n,s))return!1}else if(n!==s)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function N(e){return null!==e&&"object"===typeof e}function I(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function R(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function O(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class P{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=D),void 0===r.error&&(r.error=D),void 0===r.complete&&(r.complete=D);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function D(){}function L(e){return e&&e._delegate?e._delegate:e}class M{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const F="[DEFAULT]";class U{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new m;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:F})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&s.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const a=this.instances.get(n);return a&&e(a,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===F?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;return this.component?this.component.multipleInstances?e:F:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class j{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new U(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const z=[];var V;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(V||(V={}));const B={debug:V.DEBUG,verbose:V.VERBOSE,info:V.INFO,warn:V.WARN,error:V.ERROR,silent:V.SILENT},H=V.INFO,W={[V.DEBUG]:"log",[V.VERBOSE]:"log",[V.INFO]:"info",[V.WARN]:"warn",[V.ERROR]:"error"},q=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=W[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i];console[r](`[${n}]  ${e.name}:`,...s)};class G{constructor(e){this.name=e,this._logLevel=H,this._logHandler=q,this._userLogHandler=null,z.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in V))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?B[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,V.DEBUG,...t),this._logHandler(this,V.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,V.VERBOSE,...t),this._logHandler(this,V.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,V.INFO,...t),this._logHandler(this,V.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,V.WARN,...t),this._logHandler(this,V.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,V.ERROR,...t),this._logHandler(this,V.ERROR,...t)}}let K,Q;const X=new WeakMap,Y=new WeakMap,J=new WeakMap,Z=new WeakMap,ee=new WeakMap;let te={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Y.get(e);if("objectStoreNames"===t)return e.objectStoreNames||J.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ae(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ne(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Q||(Q=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(se(this),n),ae(X.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ae(e.apply(se(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const s=e.call(se(this),t,...r);return J.set(s,t.sort?t.sort():[t]),ae(s)}}function re(e){return"function"===typeof e?ne(e):(e instanceof IDBTransaction&&function(e){if(Y.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",s),e.removeEventListener("abort",s)},a=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",s),e.addEventListener("abort",s)});Y.set(e,t)}(e),t=e,(K||(K=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,te):e);var t}function ae(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",s)},a=()=>{t(ae(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&X.set(t,e)}).catch(()=>{}),ee.set(t,e),t}(e);if(Z.has(e))return Z.get(e);const t=re(e);return t!==e&&(Z.set(e,t),ee.set(t,e)),t}const se=e=>ee.get(e);const ie=["get","getKey","getAll","getAllKeys","count"],oe=["put","add","delete","clear"],le=new Map;function ce(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(le.get(t))return le.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=oe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!ie.includes(n))return;const s=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let s=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),a&&t.done]))[0]};return le.set(t,s),s}te=(e=>({...e,get:(t,n,r)=>ce(t,n)||e.get(t,n,r),has:(t,n)=>!!ce(t,n)||e.has(t,n)}))(te);class ue{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const he="@firebase/app",fe="0.14.0",de=new G("@firebase/app"),pe="@firebase/app-compat",me="@firebase/analytics-compat",ge="@firebase/analytics",ve="@firebase/app-check-compat",ye="@firebase/app-check",be="@firebase/auth",we="@firebase/auth-compat",Te="@firebase/database",Ee="@firebase/data-connect",Se="@firebase/database-compat",ke="@firebase/functions",_e="@firebase/functions-compat",xe="@firebase/installations",Ce="@firebase/installations-compat",Ae="@firebase/messaging",Ne="@firebase/messaging-compat",Ie="@firebase/performance",Re="@firebase/performance-compat",Oe="@firebase/remote-config",Pe="@firebase/remote-config-compat",De="@firebase/storage",Le="@firebase/storage-compat",Me="@firebase/firestore",Fe="@firebase/ai",Ue="@firebase/firestore-compat",je="firebase",ze="[DEFAULT]",Ve={[he]:"fire-core",[pe]:"fire-core-compat",[ge]:"fire-analytics",[me]:"fire-analytics-compat",[ye]:"fire-app-check",[ve]:"fire-app-check-compat",[be]:"fire-auth",[we]:"fire-auth-compat",[Te]:"fire-rtdb",[Ee]:"fire-data-connect",[Se]:"fire-rtdb-compat",[ke]:"fire-fn",[_e]:"fire-fn-compat",[xe]:"fire-iid",[Ce]:"fire-iid-compat",[Ae]:"fire-fcm",[Ne]:"fire-fcm-compat",[Ie]:"fire-perf",[Re]:"fire-perf-compat",[Oe]:"fire-rc",[Pe]:"fire-rc-compat",[De]:"fire-gcs",[Le]:"fire-gcs-compat",[Me]:"fire-fst",[Ue]:"fire-fst-compat",[Fe]:"fire-vertex","fire-js":"fire-js",[je]:"fire-js-all"},Be=new Map,He=new Map,We=new Map;function qe(e,t){try{e.container.addComponent(t)}catch(n){de.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function $e(e){const t=e.name;if(We.has(t))return de.debug(`There were multiple attempts to register component ${t}.`),!1;We.set(t,e);for(const n of Be.values())qe(n,e);for(const n of He.values())qe(n,e);return!0}function Ge(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ke(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Qe=new x("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Xe{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new M("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qe.create("app-deleted",{appName:this._name})}}const Ye="12.0.0";function Je(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r={name:ze,automaticDataCollectionEnabled:!0,...t},a=r.name;if("string"!==typeof a||!a)throw Qe.create("bad-app-name",{appName:String(a)});if(n||(n=d()),!n)throw Qe.create("no-options");const s=Be.get(a);if(s){if(A(n,s.options)&&A(r,s.config))return s;throw Qe.create("duplicate-app",{appName:a})}const i=new j(a);for(const l of We.values())i.addComponent(l);const o=new Xe(n,r,i);return Be.set(a,o),o}function Ze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze;const t=Be.get(e);if(!t&&e===ze&&d())return Je();if(!t)throw Qe.create("no-app",{appName:e});return t}function et(e,t,n){let r=Ve[e]??e;n&&(r+=`-${n}`);const a=r.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=[`Unable to register library "${r}" with version "${t}":`];return a&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void de.warn(e.join(" "))}$e(new M(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const tt="firebase-heartbeat-store";let nt=null;function rt(){return nt||(nt=function(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=ae(i);return r&&i.addEventListener("upgradeneeded",e=>{r(ae(i.result),e.oldVersion,e.newVersion,ae(i.transaction),e)}),n&&i.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(tt)}catch(n){console.warn(n)}}}).catch(e=>{throw Qe.create("idb-open",{originalErrorMessage:e.message})})),nt}async function at(e,t){try{const n=(await rt()).transaction(tt,"readwrite"),r=n.objectStore(tt);await r.put(t,st(e)),await n.done}catch(n){if(n instanceof _)de.warn(n.message);else{const e=Qe.create("idb-set",{originalErrorMessage:n?.message});de.warn(e.message)}}}function st(e){return`${e.name}!${e.options.appId}`}class it{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new lt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=ot();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){de.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=ot(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find(e=>e.agent===a.agent);if(e){if(e.dates.push(a.date),ct(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),ct(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=l(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return de.warn(e),""}}}function ot(){return(new Date).toISOString().substring(0,10)}class lt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!k()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{t(a.error?.message||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await rt()).transaction(tt),n=await t.objectStore(tt).get(st(e));return await t.done,n}catch(t){if(t instanceof _)de.warn(t.message);else{const e=Qe.create("idb-get",{originalErrorMessage:t?.message});de.warn(e.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return at(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return at(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function ct(e){return l(JSON.stringify({version:2,heartbeats:e})).length}var ut;ut="",$e(new M("platform-logger",e=>new ue(e),"PRIVATE")),$e(new M("heartbeat",e=>new it(e),"PRIVATE")),et(he,fe,ut),et(he,fe,"esm2020"),et("fire-js","");function ht(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ft=ht,dt=new x("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),pt=new G("@firebase/auth");function mt(e){if(pt.logLevel<=V.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];pt.error(`Auth (${Ye}): ${e}`,...n)}}function gt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw wt(e,...n)}function vt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wt(e,...n)}function yt(e,t,n){const r={...ft(),[t]:n};return new x("auth","Firebase",r).create(t,{appName:e.name})}function bt(e){return yt(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return dt.create(e,...n)}function Tt(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw wt(t,...r)}}function Et(e){const t="INTERNAL ASSERTION FAILED: "+e;throw mt(t),new Error(t)}function St(e,t){e||Et(t)}function kt(){return"undefined"!==typeof self&&self.location?.href||""}function _t(){return"http:"===xt()||"https:"===xt()}function xt(){return"undefined"!==typeof self&&self.location?.protocol||null}function Ct(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(_t()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class At{constructor(e,t){this.shortDelay=e,this.longDelay=t,St(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(T())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Ct()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Nt(e,t){St(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class It{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Rt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ot=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Pt=new At(3e4,6e4);function Dt(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function Lt(e,t,n,r){return Mt(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let a={},s={};r&&("GET"===t?s=r:a={body:JSON.stringify(r)});const i=I({key:e.config.apiKey,...s}).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l={method:t,headers:o,...a};return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&g(e.emulatorConfig.host)&&(l.credentials="include"),It.fetch()(await Ut(e,e.config.apiHost,n,i),l)})}async function Mt(e,t,n){e._canInitEmulator=!1;const r={...Rt,...t};try{const t=new zt(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw Vt(e,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const t=a.ok?s.errorMessage:s.error.message,[n,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Vt(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Vt(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Vt(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw yt(e,o,i);gt(e,o)}}catch(a){if(a instanceof _)throw a;gt(e,"network-request-failed",{message:String(a)})}}async function Ft(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Lt(e,t,n,r,a);return"mfaPendingCredential"in s&&gt(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function Ut(e,t,n,r){const a=`${t}${n}?${r}`,s=e,i=s.config.emulator?Nt(e.config,a):`${e.config.apiScheme}://${a}`;if(Ot.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(i).toString()}return i}function jt(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zt{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(vt(this.auth,"network-request-failed")),Pt.get())})}}function Vt(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=vt(e,t,r);return a.customData._tokenResponse=n,a}function Bt(e){return void 0!==e&&void 0!==e.enterprise}class Ht{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return jt(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Wt(e,t){return Lt(e,"GET","/v2/recaptchaConfig",Dt(e,t))}async function qt(e,t){return Lt(e,"POST","/v1/accounts:lookup",t)}function $t(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Gt(e){return 1e3*Number(e)}function Kt(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return mt("JWT malformed, contained fewer than 3 sections"),null;try{const e=c(n);return e?JSON.parse(e):(mt("Failed to decode base64 JWT payload"),null)}catch(a){return mt("Caught error parsing JWT payload as JSON",a?.toString()),null}}function Qt(e){const t=Kt(e);return Tt(t,"internal-error"),Tt("undefined"!==typeof t.exp,"internal-error"),Tt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Xt(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof _&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Yt{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class Jt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$t(this.lastLoginAt),this.creationTime=$t(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Zt(e){const t=e.auth,n=await e.getIdToken(),r=await Xt(e,qt(t,{idToken:n}));Tt(r?.users.length,t,"internal-error");const a=r.users[0];e._notifyReloadListener(a);const s=a.providerUserInfo?.length?en(a.providerUserInfo):[],i=(o=e.providerData,l=s,[...o.filter(e=>!l.some(t=>t.providerId===e.providerId)),...l]);var o,l;const c=e.isAnonymous,u=!(e.email&&a.passwordHash)&&!i?.length,h=!!c&&u,f={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new Jt(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function en(e){return e.map(e=>{let{providerId:t,...n}=e;return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class tn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Tt(e.idToken,"internal-error"),Tt("undefined"!==typeof e.idToken,"internal-error"),Tt("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Qt(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Tt(0!==e.length,"internal-error");const t=Qt(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await Mt(e,{},async()=>{const n=I({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,s=await Ut(e,r,"/v1/token",`key=${a}`),i=await e._getAdditionalHeaders();i["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:i,body:n};return e.emulatorConfig&&g(e.emulatorConfig.host)&&(o.credentials="include"),It.fetch()(s,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,s=new tn;return n&&(Tt("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Tt("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),a&&(Tt("number"===typeof a,"internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tn,this.toJSON())}_performRefresh(){return Et("not implemented")}}function nn(e,t){Tt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class rn{constructor(e){let{uid:t,auth:n,stsTokenManager:r,...a}=e;this.providerId="firebase",this.proactiveRefresh=new Yt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Jt(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Xt(this,this.stsTokenManager.getToken(this.auth,e));return Tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=L(e),r=await n.getIdToken(t),a=Kt(r);Tt(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const s="object"===typeof a.firebase?a.firebase:void 0,i=s?.sign_in_provider;return{claims:a,token:r,authTime:$t(Gt(a.auth_time)),issuedAtTime:$t(Gt(a.iat)),expirationTime:$t(Gt(a.exp)),signInProvider:i||null,signInSecondFactor:s?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=L(e);await Zt(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new rn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Zt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ke(this.auth.app))return Promise.reject(bt(this.auth));const e=await this.getIdToken();return await Xt(this,async function(e,t){return Lt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,a=t.phoneNumber??void 0,s=t.photoURL??void 0,i=t.tenantId??void 0,o=t._redirectEventId??void 0,l=t.createdAt??void 0,c=t.lastLoginAt??void 0,{uid:u,emailVerified:h,isAnonymous:f,providerData:d,stsTokenManager:p}=t;Tt(u&&p,e,"internal-error");const m=tn.fromJSON(this.name,p);Tt("string"===typeof u,e,"internal-error"),nn(n,e.name),nn(r,e.name),Tt("boolean"===typeof h,e,"internal-error"),Tt("boolean"===typeof f,e,"internal-error"),nn(a,e.name),nn(s,e.name),nn(i,e.name),nn(o,e.name),nn(l,e.name),nn(c,e.name);const g=new rn({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:f,photoURL:s,phoneNumber:a,tenantId:i,stsTokenManager:m,createdAt:l,lastLoginAt:c});return d&&Array.isArray(d)&&(g.providerData=d.map(e=>({...e}))),o&&(g._redirectEventId=o),g}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new tn;r.updateFromServerResponse(t);const a=new rn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Zt(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Tt(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?en(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!a?.length,i=new tn;i.updateFromIdToken(n);const o=new rn({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Jt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!a?.length};return Object.assign(o,l),o}}const an=new Map;function sn(e){St(e instanceof Function,"Expected a class definition");let t=an.get(e);return t?(St(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,an.set(e,t),t)}class on{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}on.type="NONE";const ln=on;function cn(e,t,n){return`firebase:${e}:${t}:${n}`}class un{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=cn(this.userKey,r.apiKey,a),this.fullPersistenceKey=cn("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await qt(this.auth,{idToken:e}).catch(()=>{});return t?rn._fromGetAccountInfoResponse(this.auth,t,e):null}return rn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new un(sn(ln),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let a=r[0]||sn(ln);const s=cn(n,e.config.apiKey,e.name);let i=null;for(const l of t)try{const t=await l._get(s);if(t){let n;if("string"===typeof t){const r=await qt(e,{idToken:t}).catch(()=>{});if(!r)break;n=await rn._fromGetAccountInfoResponse(e,r,t)}else n=rn._fromJSON(e,t);l!==a&&(i=n),a=l;break}}catch{}const o=r.filter(e=>e._shouldAllowMigration);return a._shouldAllowMigration&&o.length?(a=o[0],i&&await a._set(s,i.toJSON()),await Promise.all(t.map(async e=>{if(e!==a)try{await e._remove(s)}catch{}})),new un(a,e,n)):new un(a,e,n)}}function hn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(mn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(vn(t))return"Blackberry";if(yn(t))return"Webos";if(dn(t))return"Safari";if((t.includes("chrome/")||pn(t))&&!t.includes("edge/"))return"Chrome";if(gn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function fn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/firefox\//i.test(e)}function dn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:T()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/crios\//i.test(e)}function mn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/iemobile/i.test(e)}function gn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/android/i.test(e)}function vn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/blackberry/i.test(e)}function yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/webos/i.test(e)}function bn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function wn(){return function(){const e=T();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Tn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T();return bn(e)||gn(e)||yn(e)||vn(e)||/windows phone/i.test(e)||mn(e)}function En(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=hn(T());break;case"Worker":t=`${hn(T())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ye}/${r}`}class Sn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(a){r(a)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}class kn{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class _n{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cn(this),this.idTokenSubscription=new Cn(this),this.beforeStateQueue=new Sn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=sn(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await un.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(n){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await qt(this,{idToken:e}),n=await rn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ke(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,a=n?._redirectEventId,s=await this.tryRedirectSignIn(e);t&&t!==a||!s?.user||(n=s.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Zt(e)}catch(t){if("auth/network-request-failed"!==t?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ke(this.app))return Promise.reject(bt(this));const t=e?L(e):null;return t&&Tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ke(this.app)?Promise.reject(bt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ke(this.app)?Promise.reject(bt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sn(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Lt(e,"GET","/v2/passwordPolicy",Dt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new kn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new x("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Lt(e,"POST","/v2/accounts:revokeToken",Dt(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&sn(e)||this._popupRedirectResolver;Tt(t,this,"argument-error"),this.redirectPersistenceManager=await un.create(this,[sn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let s=!1;const i=this._isInitialized?Promise.resolve():this._initializationPromise;if(Tt(i,this,"internal-error"),i.then(()=>{s||a(this.currentUser)}),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{s=!0,a()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=En(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Ke(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e){if(pt.logLevel<=V.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];pt.warn(`Auth (${Ye}): ${e}`,...n)}}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function xn(e){return L(e)}class Cn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new P(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let An={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Nn(e){return An.loadJS(e)}function In(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Rn{constructor(){this.enterprise=new On}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class On{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Pn="NO_RECAPTCHA";class Dn{constructor(e){this.type="recaptcha-enterprise",this.auth=xn(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;Bt(a)?a.enterprise.ready(()=>{a.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Pn)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Rn).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Wt(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Ht(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(a=>{if(!t&&Bt(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=An.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Nn(t).then(()=>{n(a,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Ln(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new Dn(e);let i;if(a)i=Pn;else try{i=await s.verify(n)}catch(l){i=await s.verify(n,!0)}const o={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Mn(e,t,n,r,a){if("EMAIL_PASSWORD_PROVIDER"===a){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Ln(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch(async a=>{if("auth/missing-recaptcha-token"===a.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Ln(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)})}if("PHONE_PROVIDER"===a){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const a=await Ln(e,t,n);return r(e,a).catch(async a=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===a.code||"auth/invalid-app-credential"===a.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const a=await Ln(e,t,n,!1,!0);return r(e,a)}return Promise.reject(a)})}{const a=await Ln(e,t,n,!1,!0);return r(e,a)}}return Promise.reject(a+" provider is not supported.")}async function Fn(e){const t=xn(e),n=await Wt(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Ht(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Dn(t).verify()}}function Un(e,t,n){const r=xn(e);Tt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!!n?.disableWarnings,s=jn(t),{host:i,port:o}=function(e){const t=jn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:zn(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:zn(t)}}}(t),l=null===o?"":`:${o}`,c={url:`${s}//${i}${l}/`},u=Object.freeze({host:i,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return Tt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Tt(A(c,r.config.emulator)&&A(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,g(i)?(v(`${s}//${i}${l}`),w("Auth",!0)):a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function jn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function zn(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Vn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Et("not implemented")}_getIdTokenResponse(e){return Et("not implemented")}_linkToIdToken(e,t){return Et("not implemented")}_getReauthenticationResolver(e){return Et("not implemented")}}async function Bn(e,t){return Lt(e,"POST","/v1/accounts:signUp",t)}async function Hn(e,t){return Ft(e,"POST","/v1/accounts:signInWithPassword",Dt(e,t))}async function Wn(e,t){return Lt(e,"POST","/v1/accounts:sendOobCode",Dt(e,t))}async function qn(e,t){return Wn(e,t)}class $n extends Vn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new $n(e,t,"password")}static _fromEmailAndCode(e,t){return new $n(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Mn(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Hn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithEmailLink",Dt(e,t))}(e,{email:this._email,oobCode:this._password});default:gt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Mn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Bn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithEmailLink",Dt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:gt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gn(e,t){return Ft(e,"POST","/v1/accounts:signInWithIdp",Dt(e,t))}class Kn extends Vn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Kn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...a}=t;if(!n||!r)return null;const s=new Kn(n,r);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){return Gn(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Gn(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gn(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=I(t)}return e}}async function Qn(e,t){return Lt(e,"POST","/v1/accounts:sendVerificationCode",Dt(e,t))}const Xn={USER_NOT_FOUND:"user-not-found"};class Yn extends Vn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Yn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Yn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithPhoneNumber",Dt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Ft(e,"POST","/v1/accounts:signInWithPhoneNumber",Dt(e,t));if(n.temporaryProof)throw Vt(e,"account-exists-with-different-credential",n);return n}(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithPhoneNumber",Dt(e,{...t,operation:"REAUTH"}),Xn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new Yn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class Jn{constructor(e){const t=R(O(e)),n=t.apiKey??null,r=t.oobCode??null,a=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);Tt(n&&r&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=R(O(e)).link,n=t?R(O(t)).deep_link_id:null,r=R(O(e)).deep_link_id;return(r?R(O(r)).link:null)||r||n||t||e}(e);try{return new Jn(t)}catch{return null}}}class Zn{constructor(){this.providerId=Zn.PROVIDER_ID}static credential(e,t){return $n._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Jn.parseLink(t);return Tt(n,"argument-error"),$n._fromEmailAndCode(e,n.code,n.tenantId)}}Zn.PROVIDER_ID="password",Zn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Zn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class er{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class tr extends er{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class nr extends tr{constructor(){super("facebook.com")}static credential(e){return Kn._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return nr.credential(t.oauthAccessToken)}catch{return null}}}nr.FACEBOOK_SIGN_IN_METHOD="facebook.com",nr.PROVIDER_ID="facebook.com";class rr extends tr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Kn._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return rr.credential(n,r)}catch{return null}}}rr.GOOGLE_SIGN_IN_METHOD="google.com",rr.PROVIDER_ID="google.com";class ar extends tr{constructor(){super("github.com")}static credential(e){return Kn._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ar.credentialFromTaggedObject(e)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ar.credential(t.oauthAccessToken)}catch{return null}}}ar.GITHUB_SIGN_IN_METHOD="github.com",ar.PROVIDER_ID="github.com";class sr extends tr{constructor(){super("twitter.com")}static credential(e,t){return Kn._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return sr.credential(n,r)}catch{return null}}}sr.TWITTER_SIGN_IN_METHOD="twitter.com",sr.PROVIDER_ID="twitter.com";class ir{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await rn._fromIdTokenResponse(e,n,r),s=or(n);return new ir({user:a,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=or(n);return new ir({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function or(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class lr extends _{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,lr.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new lr(e,t,n,r)}}function cr(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw lr._fromErrorAndOperation(e,n,t,r);throw n})}async function ur(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Xt(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ir._forOperation(e,"link",r)}async function hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Ke(r.app))return Promise.reject(bt(r));const a="reauthenticate";try{const s=await Xt(e,cr(r,a,t,e),n);Tt(s.idToken,r,"internal-error");const i=Kt(s.idToken);Tt(i,r,"internal-error");const{sub:o}=i;return Tt(e.uid===o,r,"user-mismatch"),ir._forOperation(e,a,s)}catch(s){throw"auth/user-not-found"===s?.code&&gt(r,"user-mismatch"),s}}async function fr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ke(e.app))return Promise.reject(bt(e));const r="signIn",a=await cr(e,r,t),s=await ir._fromIdTokenResponse(e,r,a);return n||await e._updateCurrentUser(s.user),s}async function dr(e,t){return fr(xn(e),t)}function pr(e,t,n){Tt(n.url?.length>0,e,"invalid-continue-uri"),Tt("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),Tt("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Tt(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Tt(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function mr(e){const t=xn(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function gr(e,t){return Lt(e,"POST","/v2/accounts/mfaEnrollment:start",Dt(e,t))}new WeakMap;const vr="__sak";class yr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vr,"1"),this.storage.removeItem(vr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class br extends yr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Tn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);wn()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}br.type="LOCAL";const wr=br;function Tr(e){const t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${t}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function Er(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class Sr{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(navigator.cookieEnabled??!0))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Er(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return e?.value}return Tr(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Er(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=Er(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Tr(n);const a=setInterval(()=>{const e=Tr(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(a))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Sr.type="COOKIE";class kr extends yr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kr.type="SESSION";const _r=kr;class xr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new xr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,s=this.handlersMap[r];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const i=Array.from(s).map(async e=>e(t.origin,a)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(i);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Cr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}xr.receivers=[];class Ar{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,s;return new Promise((i,o)=>{const l=Cr("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),i(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Nr(){return window}function Ir(){return"undefined"!==typeof Nr().WorkerGlobalScope&&"function"===typeof Nr().importScripts}const Rr="firebaseLocalStorageDb",Or="firebaseLocalStorage",Pr="fbase_key";class Dr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Lr(e,t){return e.transaction([Or],t?"readwrite":"readonly").objectStore(Or)}function Mr(){const e=indexedDB.open(Rr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Or,{keyPath:Pr})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Or)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Rr);return new Dr(e).toPromise()}(),t(await Mr()))})})}async function Fr(e,t,n){const r=Lr(e,!0).put({[Pr]:t,value:n});return new Dr(r).toPromise()}function Ur(e,t){const n=Lr(e,!0).delete(t);return new Dr(n).toPromise()}class jr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Mr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ir()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xr._getInstance(Ir()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new Ar(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mr();return await Fr(e,vr,"1"),await Ur(e,vr),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Fr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Lr(e,!1).get(t),r=await new Dr(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ur(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Lr(e,!1).getAll();return new Dr(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}jr.type="LOCAL";const zr=jr;function Vr(e,t){return Lt(e,"POST","/v2/accounts/mfaSignIn:start",Dt(e,t))}In("rcb"),new At(3e4,6e4);const Br="recaptcha";async function Hr(e,t,n){if(!e._getRecaptchaConfig())try{await Fn(e)}catch(r){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"===typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){Tt("enroll"===t.type,e,"internal-error");const a={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Mn(e,a,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Pn){Tt(n?.type===Br,e,"argument-error");return gr(e,await Wr(e,t,n))}return gr(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{Tt("signin"===t.type,e,"internal-error");const a=r.multiFactorHint?.uid||r.multiFactorUid;Tt(a,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},i=Mn(e,s,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Pn){Tt(n?.type===Br,e,"argument-error");return Vr(e,await Wr(e,t,n))}return Vr(e,t)},"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},a=Mn(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Pn){Tt(n?.type===Br,e,"argument-error");return Qn(e,await Wr(e,t,n))}return Qn(e,t)},"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).sessionInfo}}finally{n?._reset()}}async function Wr(e,t,n){Tt(n.type===Br,e,"argument-error");const r=await n.verify();Tt("string"===typeof r,e,"argument-error");const a={...t};if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.captchaResponse,n=a.phoneEnrollmentInfo.clientType,s=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),a}if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.captchaResponse,t=a.phoneSignInInfo.clientType,n=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),a}return Object.assign(a,{recaptchaToken:r}),a}class qr{constructor(e){this.providerId=qr.PROVIDER_ID,this.auth=xn(e)}verifyPhoneNumber(e,t){return Hr(this.auth,e,L(t))}static credential(e,t){return Yn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qr.credentialFromTaggedObject(t)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Yn._fromTokenResponse(n,r):null}}function $r(e,t){return t?sn(t):(Tt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}qr.PROVIDER_ID="phone",qr.PHONE_SIGN_IN_METHOD="phone";class Gr extends Vn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Kr(e){return fr(e.auth,new Gr(e),e.bypassAuthState)}function Qr(e){const{auth:t,user:n}=e;return Tt(n,t,"internal-error"),hr(n,new Gr(e),e.bypassAuthState)}async function Xr(e){const{auth:t,user:n}=e;return Tt(n,t,"internal-error"),ur(n,new Gr(e),e.bypassAuthState)}class Yr{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:s,type:i}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Kr;case"linkViaPopup":case"linkViaRedirect":return Xr;case"reauthViaPopup":case"reauthViaRedirect":return Qr;default:gt(this.auth,"internal-error")}}resolve(e){St(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){St(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Jr=new At(2e3,1e4);class Zr extends Yr{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,Zr.currentPopupAction&&Zr.currentPopupAction.cancel(),Zr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Tt(e,this.auth,"internal-error"),e}async onExecution(){St(1===this.filter.length,"Popup operations only handle one event");const e=Cr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(vt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(vt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zr.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vt(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Jr.get())};e()}}Zr.currentPopupAction=null;const ea=new Map;class ta extends Yr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ea.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=aa(t),r=ra(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ea.set(this.auth._key(),e)}return this.bypassAuthState||ea.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function na(e,t){ea.set(e._key(),t)}function ra(e){return sn(e._redirectPersistence)}function aa(e){return cn("pendingRedirect",e.config.apiKey,e.name)}async function sa(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ke(e.app))return Promise.reject(bt(e));const r=xn(e),a=$r(r,t),s=new ta(r,a,n),i=await s.execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,t)),i}class ia{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return la(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!la(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(vt(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(oa(e))}saveEventToCache(e){this.cachedEventUids.add(oa(e)),this.lastProcessedEventTime=Date.now()}}function oa(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function la(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===n?.code}const ca=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ua=/^https?/;async function ha(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Lt(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const n of t)try{if(fa(n))return}catch{}gt(e,"unauthorized-domain")}function fa(e){const t=kt(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!ua.test(n))return!1;if(ca.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const da=new At(3e4,6e4);function pa(){const e=Nr().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function ma(e){return new Promise((t,n)=>{function r(){pa(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{pa(),n(vt(e,"network-request-failed"))},timeout:da.get()})}if(Nr().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!Nr().gapi?.load){const t=In("iframefcb");return Nr()[t]=()=>{gapi.load?r():n(vt(e,"network-request-failed"))},Nn(`${An.gapiScript}?onload=${t}`).catch(e=>n(e))}r()}}).catch(e=>{throw ga=null,e})}let ga=null;const va=new At(5e3,15e3),ya={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ba=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wa(e){const t=e.config;Tt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Nt(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ye},a=ba.get(e.config.apiHost);a&&(r.eid=a);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${I(r).slice(1)}`}async function Ta(e){const t=await function(e){return ga=ga||ma(e),ga}(e),n=Nr().gapi;return Tt(n,e,"internal-error"),t.open({where:document.body,url:wa(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ya,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=vt(e,"network-request-failed"),s=Nr().setTimeout(()=>{r(a)},va.get());function i(){Nr().clearTimeout(s),n(t)}t.ping(i).then(i,()=>{r(a)})}))}const Ea={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Sa{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function ka(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-a)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...Ea,width:r.toString(),height:a.toString(),top:s,left:i},c=T().toLowerCase();n&&(o=pn(c)?"_blank":n),fn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){return bn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:T())&&!!window.navigator?.standalone}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Sa(null);const h=window.open(t||"",o,u);Tt(h,e,"popup-blocked");try{h.focus()}catch(f){}return new Sa(h)}const _a="__/auth/handler",xa="emulator/auth/handler",Ca=encodeURIComponent("fac");async function Aa(e,t,n,r,a,s){Tt(e.config.authDomain,e,"auth-domain-config-required"),Tt(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ye,eventId:a};if(t instanceof er){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))i[e]=t}if(t instanceof tr){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(i.scopes=e.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${Ca}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${_a}`;return Nt(t,xa)}(e)}?${I(o).slice(1)}${c}`}const Na="webStorageSupport";const Ia=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_r,this._completeRedirectFn=sa,this._overrideRedirectResult=na}async _openPopup(e,t,n,r){St(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");return ka(e,await Aa(e,t,n,kt(),r),Cr())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Nr().location.href=e}(await Aa(e,t,n,kt(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(St(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Ta(e),n=new ia(e);return t.register("authEvent",t=>{Tt(t?.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Na,{type:Na},n=>{const r=n?.[0]?.[Na];void 0!==r&&t(!!r),gt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ha(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Tn()||dn()||bn()}};var Ra="@firebase/auth",Oa="1.11.0";class Pa{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Da=p("authIdTokenMaxAge")||300;let La=null;var Ma;An={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=vt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ma="Browser",$e(new M("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=r.options;Tt(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:i,authDomain:o,clientPlatform:Ma,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:En(Ma)},c=new _n(r,a,s,l);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(sn);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),$e(new M("auth-internal",e=>(e=>new Pa(e))(xn(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),et(Ra,Oa,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ma)),et(Ra,Oa,"esm2020");et("firebase","12.0.0","app");var Fa,Ua,ja="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},za={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var s=e.g[3],i=t+(s^n&(a^s))+r[0]+3614090360&4294967295;i=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=(n=(a=(s=(t=n+(i<<7&4294967295|i>>>25))+((i=s+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=a+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^a&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^n&(a^s))+r[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=s+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=a+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^a&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^n&(a^s))+r[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=s+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=a+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^a&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^n&(a^s))+r[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=s+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=a+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^a&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^s&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=s+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=n+(s^t&(a^s))+r[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(a^s&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=s+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=n+(s^t&(a^s))+r[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(a^s&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=s+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=n+(s^t&(a^s))+r[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(a^s&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=s+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=a+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=n+(s^t&(a^s))+r[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^a^s)+r[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=n+(a^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^a^s)+r[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=n+(a^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^a^s)+r[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=n+(a^s^t)+r[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^a^s)+r[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=a+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=n+(a^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(a^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=s+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=a+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=n+(s^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(a^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=s+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=a+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=n+(s^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(a^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=s+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=a+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=n+(s^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((s=(t=n+((i=t+(a^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=s+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((a=s+((i=a+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var s=0|e[a];r&&s==t||(n[a]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var a=Array(arguments.length-2),s=2;s<arguments.length;s++)a[s-2]=arguments[s];return t.prototype[n].apply(e,a)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,a=this.B,s=this.h,i=0;i<t;){if(0==s)for(;i<=r;)n(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(a[s++]=e.charCodeAt(i++),s==this.blockSize){n(this,a),s=0;break}}else for(;i<t;)if(a[s++]=e[i++],s==this.blockSize){n(this,a),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function s(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function i(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return f(i(-e));for(var t=[],n=1,a=0;e>=n;a++)t[a]=e/n|0,n*=4294967296;return new r(t,0)}var o=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function f(e){for(var t=e.g.length,n=[],a=0;a<t;a++)n[a]=~e.g[a];return new r(n,~e.h).add(l)}function d(e,t){return e.add(f(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(f(e),t),new m(f(t.g),f(t.h));if(h(t))return t=g(e,f(t)),new m(f(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var a=y(n,1),s=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(a=a.add(n),s=c),r=y(r,1),n=y(n,1)}return t=d(e,a.j(t)),new m(a,t)}for(a=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=i(n)).j(t);h(c)||0<c.l(e);)c=(s=i(n-=r)).j(t);u(s)&&(s=l),a=a.add(s),e=d(e,c)}return new m(a,e)}function v(e){for(var t=e.g.length+1,n=[],a=0;a<t;a++)n[a]=e.i(a)<<1|e.i(a-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var a=e.g.length-n,s=[],i=0;i<a;i++)s[i]=0<t?e.i(i+n)>>>t|e.i(i+n+1)<<32-t:e.i(i+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-f(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+f(this).toString(e);for(var t=i(Math.pow(e,6)),n=this,r="";;){var a=g(n,t).g,s=((0<(n=d(n,a.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=a))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=d(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?f(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0,s=0;s<=t;s++){var i=a+(65535&this.i(s))+(65535&e.i(s)),o=(i>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);a=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?f(this).j(f(e)):f(f(this).j(e));if(h(e))return f(this.j(f(e)));if(0>this.l(c)&&0>e.l(c))return i(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],a=0;a<2*t;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(var s=0;s<e.g.length;s++){var l=this.i(a)>>>16,d=65535&this.i(a),m=e.i(s)>>>16,g=65535&e.i(s);n[2*a+2*s]+=d*g,p(n,2*a+2*s),n[2*a+2*s+1]+=l*g,p(n,2*a+2*s+1),n[2*a+2*s+1]+=d*m,p(n,2*a+2*s+1),n[2*a+2*s+2]+=l*m,p(n,2*a+2*s+2)}for(a=0;a<t;a++)n[a]=n[2*a+1]<<16|n[2*a];for(a=t;a<2*t;a++)n[a]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)&e.i(a);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)|e.i(a);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)^e.i(a);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Ua=za.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=i,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return f(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=i(Math.pow(n,8)),a=o,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=i(Math.pow(n,l)),a=a.j(l).add(i(c))):a=(a=a.j(r)).add(i(c))}return a},Fa=za.Integer=r}).apply("undefined"!==typeof ja?ja:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Va,Ba,Ha,Wa,qa,$a,Ga,Ka,Qa="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Xa={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Qa&&Qa];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var a=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var i=e[s];if(!(i in a))break e;a=a[i]}(r=r(s=a[e=e[e.length-1]]))!=s&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,function(e,t){return t})}});var r=r||{},a=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function i(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var a=Array(arguments.length-2),s=2;s<arguments.length;s++)a[s-2]=arguments[s];return t.prototype[n].apply(e,a)}}function f(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function d(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function E(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){a.setTimeout(()=>{throw e},0)}function k(){var e=N;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var _=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new x,e=>e.reset());class x{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,A=!1,N=new class{constructor(){this.h=this.g=null}add(e,t){const n=_.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},I=()=>{const e=a.Promise.resolve(void 0);C=()=>{e.then(R)}};var R=()=>{for(var e;e=k();){try{e.h.call(e.g)}catch(n){S(n)}var t=_;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}A=!1};function O(){this.s=this.s,this.C=this.C}function P(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},P.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(P.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var a=!0;break e}catch(s){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,P);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),U=0;function j(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++U,this.da=this.fa=!1}function z(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],s=Array.prototype.indexOf.call(a,t,void 0);(r=0<=s)&&Array.prototype.splice.call(a,s,1),r&&(z(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function H(e,t,n,r){for(var a=0;a<e.length;++a){var s=e[a];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return a}return-1}V.prototype.add=function(e,t,n,r,a){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var i=H(e,t,r,a);return-1<i?(t=e[i],n||(t.fa=!1)):((t=new j(t,this.src,s,!!r,a)).fa=n,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),q={};function $(e,t,n,r,a){if(r&&r.once)return K(e,t,n,r,a);if(Array.isArray(t)){for(var s=0;s<t.length;s++)$(e,t[s],n,r,a);return null}return n=te(n),e&&e[F]?e.K(t,n,i(r)?!!r.capture:!!r,a):G(e,t,n,!1,r,a)}function G(e,t,n,r,a,s){if(!t)throw Error("Invalid event type");var o=i(a)?!!a.capture:!!a,l=Z(e);if(l||(e[W]=l=new V(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)D||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(Y(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function K(e,t,n,r,a){if(Array.isArray(t)){for(var s=0;s<t.length;s++)K(e,t[s],n,r,a);return null}return n=te(n),e&&e[F]?e.L(t,n,i(r)?!!r.capture:!!r,a):G(e,t,n,!0,r,a)}function Q(e,t,n,r,a){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,a);else r=i(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=H(s=e.g[t],n,r,a))&&(z(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=H(t,n,r,a)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Y(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[W]=null)):z(e)}}}function Y(e){return e in q?q[e]:q[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[W])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){O.call(this),this.i=new V(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new P(t,e);else if(t instanceof P)t.target=t.target||e;else{var a=t;T(t=new P(r,e),a)}if(a=!0,n)for(var s=n.length-1;0<=s;s--){var i=t.g=n[s];a=ae(i,r,!0,t)&&a}if(a=ae(i=t.g=e,r,!0,t)&&a,a=ae(i,r,!1,t)&&a,n)for(s=0;s<n.length;s++)a=ae(i=t.g=n[s],r,!1,t)&&a}function ae(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,s=0;s<t.length;++s){var i=t[s];if(i&&!i.da&&i.capture==n){var o=i.listener,l=i.ha||i.src;i.fa&&B(e.i,i),a=!1!==o.call(l,r)&&a}}return a&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function ie(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,ie(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,O),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)z(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends O{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ie(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){O.call(this),this.h=e,this.g={}}h(le,O);var ce=[];function ue(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&X(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=a.JSON.stringify,fe=a.JSON.parse,de=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){P.call(this,"d")}function be(){P.call(this,"c")}h(ye,P),h(be,P);var we={},Te=null;function Ee(){return Te=Te||new ne}function Se(e){P.call(this,we.La,e)}function ke(e){const t=Ee();re(t,new Se(t))}function _e(e,t){P.call(this,we.STAT_EVENT,e),this.stat=t}function xe(e){const t=Ee();re(t,new _e(t,e))}function Ce(e,t){P.call(this,we.Ma,e),this.size=t}function Ae(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function Ne(){this.g=!0}function Ie(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var s=a[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var i=1;i<a.length;i++)a[i]=""}}}return he(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}we.La="serverreachability",h(Se,P),we.STAT_EVENT="statevent",h(_e,P),we.Ma="timingevent",h(Ce,P),Ne.prototype.xa=function(){this.g=!1},Ne.prototype.info=function(){};var Re,Oe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function De(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(De,pe),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},Re=new De;var Fe={},Ue={};function je(e,t,n){e.L=1,e.v=ht(it(t)),e.m=n,e.P=!0,ze(e,null)}function ze(e,t){e.F=Date.now(),He(e),e.A=it(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),_t(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=dn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(ce[0]=a.toString()),a=ce);for(var s=0;s<a.length;s++){var i=$(n,a[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ke(),function(e,t,n,r,a,s){e.info(function(){if(e.g)if(s)for(var i="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");i=2<=h.length&&"type"==h[1]?i+(u+"=")+c+"&":i+(u+"=redacted&")}}else i=null;else i=s;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+i})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ue:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?Ue:(t=t.slice(r,r+n),e.C=r+n,t))}function He(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ae(c(e.ba,e),t)}function qe(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function $e(e){0==e.j.G||e.J||ln(e.j,e)}function Ge(e){qe(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ke(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Xt(n)}rn(n),xe(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ae(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&on(n),!p(t))for(a=n.Da.g.parse(t),t=0;t<a.length;t++){let c=a[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const a=c[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var i=e;if((r=n).qa=fn(r,r.J?r.ia:null,r.W),i.K){tt(r.h,i);var o=i,l=r.L;l&&(o.I=l),o.B&&(qe(o),He(o)),r.g=i}else nn(r);0<n.i.length&&Jt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}ke()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==qt(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const f=qt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>f)&&(3!=f||this.g&&(this.h.h||this.g.oa()||$t(this.g)))){this.J||4!=f||7==t||ke(),qe(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var r=$t(this.g);e="";var s=r.length,i=4==qt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ge(this),$e(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(i&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,a,s,i){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+s+" "+i})}(this.i,this.u,this.A,this.l,this.R,f,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,xe(12),Ge(this),$e(this);break e}Ie(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ke(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Ue){4==f&&(this.s=4,xe(14),n=!1),Ie(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,xe(15),Ie(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ie(this.i,this.l,e,null),Ke(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=o.length||this.h.h||(this.s=1,xe(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),an(h),h.M=!0,xe(11))}}else Ie(this.i,this.l,o,"[Invalid Chunked Response]"),Ge(this),$e(this)}else Ie(this.i,this.l,o,null),Ke(this,o);4==f&&Ge(this),this.o&&!this.J&&(4==f?ln(this.j,this):(this.o=!1,He(this)))}else(function(e){const t={};e=(e.g&&2<=qt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=E(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[a]||[];t[a]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,xe(12)):(this.s=0,xe(13)),Ge(this),$e(this)}}}catch(f){}},Le.prototype.cancel=function(){this.J=!0,Ge(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(ke(),xe(17)),Ge(this),this.s=2,$e(this)):We(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return f(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,i=0;i<a;i++)t.call(void 0,r[i],n&&n[i],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var at=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new Tt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(at))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ft(t[2]||""),this.g=ft(t[3]||"",!0),lt(this,t[4]),this.l=ft(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ft(t[7]||"")):(this.h=!1,this.i=new Tt(null,this.h))}function it(e){return new st(e)}function ot(e,t,n){e.j=n?ft(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof Tt?(e.i=t,function(e,t){t&&!e.j&&(Et(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(St(this,t),_t(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=dt(t,bt)),e.i=new Tt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ft(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function dt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(dt(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(dt(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(dt(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",dt(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function Tt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Et(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var s=e[n].substring(0,r);a=e[n].substring(r+1)}else s=e[n];t(s,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function St(e,t){Et(e),t=xt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function kt(e,t){return Et(e),t=xt(e,t),e.g.has(t)}function _t(e,t,n){St(e,t),0<n.length&&(e.i=null,e.g.set(xt(e,t),f(n)),e.h+=n.length)}function xt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(s){}}function At(){this.g=new de}function Nt(e,t,n){const r=n||"";try{rt(e,function(e,n){let a=e;i(e)&&(a=he(e)),t.push(r+n+"="+encodeURIComponent(a))})}catch(a){throw t.push(r+"type="+encodeURIComponent("_badmap")),a}}function It(e){this.l=e.Ub||null,this.j=e.eb||!1}function Rt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Ot(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Pt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Dt(e)}function Dt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Mt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Lt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Ft(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Tt.prototype).add=function(e,t){Et(this),this.i=null,e=xt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Et(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Et(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const a=e[r];for(let e=0;e<a.length;e++)n.push(t[r])}return n},e.V=function(e){Et(this);let t=[];if("string"===typeof e)kt(this,e)&&(t=t.concat(this.g.get(xt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Et(this),this.i=null,kt(this,e=xt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),i=this.V(r);for(r=0;r<i.length;r++){var a=s;""!==i[r]&&(a+="="+encodeURIComponent(String(i[r]))),e.push(a)}}return this.i=e.join("&")},h(It,pe),It.prototype.g=function(){return new Rt(this.l,this.j)},It.prototype.i=(mt={},function(){return mt}),h(Rt,ne),(e=Rt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Dt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Dt(this)),this.g&&(this.readyState=3,Dt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ot(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pt(this):Dt(this),3==this.readyState&&Ot(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Pt(this))},e.Qa=function(e){this.g&&(this.response=e,Pt(this))},e.ga=function(){this.g&&Pt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Rt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Ft,ne);var Ut=/^https?$/i,jt=["POST","PUT"];function zt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),Ht(e)}function Vt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=qt(e)||2!=e.Z()))if(e.u&&4==qt(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==qt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var i=String(e.D).match(at)[1]||null;!i&&a.self&&a.self.location&&(i=a.self.location.protocol.slice(0,-1)),s=!Ut.test(i?i.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<qt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Vt(e)}}finally{Ht(e)}}}function Ht(e,t){if(e.g){Wt(e);const r=e.g,a=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=a}catch(n){}}}function Wt(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function qt(e){return e.g?e.g.readyState:0}function $t(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Gt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Kt(e){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gt("baseRetryDelayMs",5e3,e),this.cb=Gt("retryDelaySeedMs",1e4,e),this.Wa=Gt("forwardChannelMaxRetries",2,e),this.wa=Gt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new At,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Yt(e),3==e.G){var t=e.U++,n=it(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Le(e,e.j,t)).L=2,t.v=ht(it(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.v,n=!0),n||(t.g=dn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),He(t)}hn(e)}function Xt(e){e.g&&(an(e),e.g.cancel(),e.g=null)}function Yt(e){Xt(e),e.u&&(a.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||I(),A||(C(),A=!0),N.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=it(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&Mt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),je(n,r,t)}function en(e,t){e.H&&y(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let i=!0;for(let o=0;o<n;o++){let n=a[o].g;const l=a[o].map;if(n-=t,0>n)t=Math.max(0,a[o].g-100),i=!1;else try{Nt(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(i){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||I(),A||(C(),A=!0),N.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ae(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function an(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=it(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Mt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(it(t)),n.m=null,n.P=!0,ze(n,e)}function on(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),an(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;re(r=Ee(),new Ce(r,n)),Jt(e)}else nn(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ae(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ot(r,"https"),ht(r),t?function(e,t){const n=new Ne;if(a.Image){const r=new Image;r.onload=u(Ct,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ct,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ct,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ct,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ne;const n=new AbortController,r=setTimeout(()=>{n.abort(),Ct(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)}).catch(()=>{clearTimeout(r),Ct(0,0,!1,t)})}(r.toString(),n)}else xe(2);e.G=0,e.l&&e.l.sa(t),hn(e),Yt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(d(e.ka,t),d(e.ka,e.i),e.h.i.length=0,f(e.i),e.i.length=0),e.l.ra()}}function fn(e,t,n){var r=n instanceof st?it(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=a.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new st(null);r&&ot(i,r),t&&(i.g=t),s&&lt(i,s),n&&(i.l=n),r=i}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function dn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ft(new It({eb:n})):new Ft(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Kt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Ft.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Re.g(),this.v=this.o?me(this.o):me(Re),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(i){return void zt(this,i)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(jt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(i){zt(this,i)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),Ht(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ht(this,!0)),Ft.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<qt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fe(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Kt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){xe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=fn(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new Le(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),T(s,this.S)):s=this.S),null!==this.m||this.O||(a.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,a,t),ut(n=it(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Lt(s)))+"&"+t:this.m&&Mt(n,this.m,s)),et(this.h,a),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),a.T=!0,je(a,n,null)):je(a,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Ye(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ae(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xe(10),Xt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Xt(this),rn(this),xe(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Jt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},h(vn,ye),h(yn,be),h(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new vn(e))},bn.prototype.sa=function(e){re(this.g,new yn)},bn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Ka=Xa.createWebChannelTransport=function(){return new mn},Ga=Xa.getStatEventTarget=function(){return Ee()},$a=Xa.Event=we,qa=Xa.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,Wa=Xa.ErrorCode=Oe,Pe.COMPLETE="complete",Ha=Xa.EventType=Pe,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Ba=Xa.WebChannel=ge,Xa.FetchXmlHttpFactory=It,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,Va=Xa.XhrIo=Ft}).apply("undefined"!==typeof Qa?Qa:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Ya="@firebase/firestore",Ja="4.9.0";class Za{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Za.UNAUTHENTICATED=new Za(null),Za.GOOGLE_CREDENTIALS=new Za("google-credentials-uid"),Za.FIRST_PARTY=new Za("first-party-uid"),Za.MOCK_USER=new Za("mock-user");let es="12.0.0";const ts=new G("@firebase/firestore");function ns(){return ts.logLevel}function rs(e){if(ts.logLevel<=V.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(is);ts.debug(`Firestore (${es}): ${e}`,...a)}}function as(e){if(ts.logLevel<=V.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(is);ts.error(`Firestore (${es}): ${e}`,...a)}}function ss(e){if(ts.logLevel<=V.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(is);ts.warn(`Firestore (${es}): ${e}`,...a)}}function is(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function os(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ls(e,r,n)}function ls(e,t,n){let r=`FIRESTORE (${es}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw as(r),new Error(r)}function cs(e,t,n,r){let a="Unexpected state";"string"==typeof n?a=n:r=n,e||ls(t,a,r)}function us(e,t){return e}const hs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fs extends _{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ds{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ps{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ms{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Za.UNAUTHENTICATED))}shutdown(){}}class gs{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vs{constructor(e){this.t=e,this.currentUser=Za.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){cs(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new ds;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ds,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=a;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},i=e=>{rs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>i(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(rs("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ds)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(rs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(cs("string"==typeof t.accessToken,31837,{l:t}),new ps(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return cs(null===e||"string"==typeof e,2055,{h:e}),new Za(e)}}class ys{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Za.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bs{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ys(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Za.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ws{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ts{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ke(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){cs(void 0===this.o,3512);const n=e=>{null!=e.error&&rs("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,rs("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{rs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):rs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ws(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(cs("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new ws(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Es(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Ss{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Es(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function ks(e,t){return e<t?-1:e>t?1:0}function _s(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),a=t.charAt(r);if(n!==a)return As(n)===As(a)?ks(n,a):As(n)?1:-1}return ks(e.length,t.length)}const xs=55296,Cs=57343;function As(e){const t=e.charCodeAt(0);return t>=xs&&t<=Cs}function Ns(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Is="__name__";class Rs{constructor(e,t,n){void 0===t?t=0:t>e.length&&os(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&os(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Rs.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Rs?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Rs.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return ks(e.length,t.length)}static compareSegments(e,t){const n=Rs.isNumericId(e),r=Rs.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Rs.extractNumericId(e).compare(Rs.extractNumericId(t)):_s(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fa.fromString(e.substring(4,e.length-2))}}class Os extends Rs{construct(e,t,n){return new Os(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new fs(hs.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);e.push(...a.split("/").filter(e=>e.length>0))}return new Os(e)}static emptyPath(){return new Os([])}}const Ps=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ds extends Rs{construct(e,t,n){return new Ds(e,t,n)}static isValidIdentifier(e){return Ps.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ds.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Is}static keyField(){return new Ds([Is])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new fs(hs.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new fs(hs.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new fs(hs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(a(),r++)}if(a(),s)throw new fs(hs.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ds(t)}static emptyPath(){return new Ds([])}}class Ls{constructor(e){this.path=e}static fromPath(e){return new Ls(Os.fromString(e))}static fromName(e){return new Ls(Os.fromString(e).popFirst(5))}static empty(){return new Ls(Os.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Os.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Os.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ls(new Os(e.slice()))}}function Ms(e,t,n){if(!n)throw new fs(hs.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Fs(e){if(!Ls.isDocumentKey(e))throw new fs(hs.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Us(e){if(Ls.isDocumentKey(e))throw new fs(hs.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function js(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function zs(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":os(12329,{type:typeof e})}function Vs(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new fs(hs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zs(e);throw new fs(hs.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Bs(e,t){const n={typeString:e};return t&&(n.value=t),n}function Hs(e,t){if(!js(e))throw new fs(hs.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const a=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const i=e[r];if(a&&typeof i!==a){n=`JSON field '${r}' must be a ${a}.`;break}if(void 0!==s&&i!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new fs(hs.INVALID_ARGUMENT,n);return!0}const Ws=-62135596800,qs=1e6;class $s{static now(){return $s.fromMillis(Date.now())}static fromDate(e){return $s.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*qs);return new $s(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fs(hs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fs(hs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Ws)throw new fs(hs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fs(hs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qs}_compareTo(e){return this.seconds===e.seconds?ks(this.nanoseconds,e.nanoseconds):ks(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$s._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hs(e,$s._jsonSchema))return new $s(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ws;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$s._jsonSchemaVersion="firestore/timestamp/1.0",$s._jsonSchema={type:Bs("string",$s._jsonSchemaVersion),seconds:Bs("number"),nanoseconds:Bs("number")};class Gs{static fromTimestamp(e){return new Gs(e)}static min(){return new Gs(new $s(0,0))}static max(){return new Gs(new $s(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ks=-1;class Qs{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Qs.UNKNOWN_ID=-1;function Xs(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=Gs.fromTimestamp(1e9===r?new $s(n+1,0):new $s(n,r));return new Js(a,Ls.empty(),t)}function Ys(e){return new Js(e.readTime,e.key,Ks)}class Js{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Js(Gs.min(),Ls.empty(),Ks)}static max(){return new Js(Gs.max(),Ls.empty(),Ks)}}function Zs(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Ls.comparator(e.documentKey,t.documentKey),0!==n?n:ks(e.largestBatchId,t.largestBatchId))}const ei="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ti{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ni(e){if(e.code!==hs.FAILED_PRECONDITION||e.message!==ei)throw e;rs("LocalStore","Unexpectedly lost primary lease")}class ri{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&os(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ri((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ri?t:ri.resolve(t)}catch(e){return ri.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ri.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ri.reject(t)}static resolve(e){return new ri((t,n)=>{t(e)})}static reject(e){return new ri((t,n)=>{n(e)})}static waitFor(e){return new ri((t,n)=>{let r=0,a=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++a,s&&a===r&&t()},e=>n(e))}),s=!0,a===r&&t()})}static or(e){let t=ri.resolve(!1);for(const n of e)t=t.next(e=>e?ri.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new ri((n,r)=>{const a=e.length,s=new Array(a);let i=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++i,i===a&&n(s)},e=>r(e))}})}static doWhile(e,t){return new ri((n,r)=>{const a=()=>{!0===e()?t().next(()=>{a()},r):n()};a()})}}function ai(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function si(e){return"IndexedDbTransactionError"===e.name}class ii{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ii.ce=-1;const oi=-1;function li(e){return null==e}function ci(e){return 0===e&&1/e==-1/0}function ui(e){return"number"==typeof e&&Number.isInteger(e)&&!ci(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const hi="\x01";function fi(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=pi(t)),t=di(e.get(n),t);return pi(t)}function di(e,t){let n=t;const r=e.length;for(let a=0;a<r;a++){const t=e.charAt(a);switch(t){case"\0":n+="\x01\x10";break;case hi:n+="\x01\x11";break;default:n+=t}}return n}function pi(e){return e+hi+"\x01"}const mi="remoteDocuments",gi="owner",vi="mutationQueues",yi="mutations";const bi="documentMutations",wi="remoteDocumentsV14",Ti="remoteDocumentGlobal",Ei="targets",Si="targetDocuments",ki="targetGlobal",_i="collectionParents",xi="clientMetadata",Ci="bundles",Ai="namedQueries",Ni="indexConfiguration",Ii="indexState",Ri="indexEntries",Oi="documentOverlays",Pi="globals",Di=[vi,yi,bi,mi,Ei,gi,ki,Si,xi,Ti,_i,Ci,Ai],Li=[vi,yi,bi,wi,Ei,gi,ki,Si,xi,Ti,_i,Ci,Ai,Oi],Mi=Li,Fi=[...Mi,Ni,Ii,Ri];function Ui(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ji(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function zi(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Vi{constructor(e,t){this.comparator=e,this.root=t||Hi.EMPTY}insert(e,t){return new Vi(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Hi.BLACK,null,null))}remove(e){return new Vi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bi(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bi(this.root,e,this.comparator,!0)}}class Bi{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hi{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:Hi.RED,this.left=null!=r?r:Hi.EMPTY,this.right=null!=a?a:Hi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new Hi(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Hi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Hi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw os(43730,{key:this.key,value:this.value});if(this.right.isRed())throw os(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw os(27949);return e+(this.isRed()?0:1)}}Hi.EMPTY=null,Hi.RED=!0,Hi.BLACK=!1,Hi.EMPTY=new class{constructor(){this.size=0}get key(){throw os(57766)}get value(){throw os(16141)}get color(){throw os(16727)}get left(){throw os(29726)}get right(){throw os(36894)}copy(e,t,n,r,a){return this}insert(e,t,n){return new Hi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Wi{constructor(e){this.comparator=e,this.data=new Vi(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qi(this.data.getIterator())}getIteratorFrom(e){return new qi(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Wi))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Wi(this.comparator);return t.data=e,t}}class qi{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class $i{constructor(e){this.fields=e,e.sort(Ds.comparator)}static empty(){return new $i([])}unionWith(e){let t=new Wi(Ds.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new $i(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ns(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Gi extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ki{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Gi("Invalid base64 string: "+e):e}}(e);return new Ki(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ki(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ks(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ki.EMPTY_BYTE_STRING=new Ki("");const Qi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xi(e){if(cs(!!e,39018),"string"==typeof e){let t=0;const n=Qi.exec(e);if(cs(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Yi(e.seconds),nanos:Yi(e.nanos)}}function Yi(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ji(e){return"string"==typeof e?Ki.fromBase64String(e):Ki.fromUint8Array(e)}const Zi="server_timestamp",eo="__type__",to="__previous_value__",no="__local_write_time__";function ro(e){const t=(e?.mapValue?.fields||{})[eo]?.stringValue;return t===Zi}function ao(e){const t=e.mapValue.fields[to];return ro(t)?ao(t):t}function so(e){const t=Xi(e.mapValue.fields[no].timestampValue);return new $s(t.seconds,t.nanos)}class io{constructor(e,t,n,r,a,s,i,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=i,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const oo="(default)";class lo{constructor(e,t){this.projectId=e,this.database=t||oo}static empty(){return new lo("","")}get isDefaultDatabase(){return this.database===oo}isEqual(e){return e instanceof lo&&e.projectId===this.projectId&&e.database===this.database}}const co="__type__",uo="__max__",ho={mapValue:{fields:{__type__:{stringValue:uo}}}},fo="__vector__",po="value";function mo(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ro(e)?4:Oo(e)?9007199254740991:Io(e)?10:11:os(28295,{value:e})}function go(e,t){if(e===t)return!0;const n=mo(e);if(n!==mo(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return so(e).isEqual(so(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Xi(e.timestampValue),r=Xi(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ji(e.bytesValue).isEqual(Ji(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Yi(e.geoPointValue.latitude)===Yi(t.geoPointValue.latitude)&&Yi(e.geoPointValue.longitude)===Yi(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Yi(e.integerValue)===Yi(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Yi(e.doubleValue),r=Yi(t.doubleValue);return n===r?ci(n)===ci(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ns(e.arrayValue.values||[],t.arrayValue.values||[],go);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Ui(n)!==Ui(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!go(n[a],r[a])))return!1;return!0}(e,t);default:return os(52216,{left:e})}}function vo(e,t){return void 0!==(e.values||[]).find(e=>go(e,t))}function yo(e,t){if(e===t)return 0;const n=mo(e),r=mo(t);if(n!==r)return ks(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ks(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Yi(e.integerValue||e.doubleValue),r=Yi(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return bo(e.timestampValue,t.timestampValue);case 4:return bo(so(e),so(t));case 5:return _s(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Ji(e),r=Ji(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=ks(n[a],r[a]);if(0!==e)return e}return ks(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=ks(Yi(e.latitude),Yi(t.latitude));return 0!==n?n:ks(Yi(e.longitude),Yi(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return wo(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},a=n[po]?.arrayValue,s=r[po]?.arrayValue,i=ks(a?.values?.length||0,s?.values?.length||0);return 0!==i?i:wo(a,s)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ho.mapValue&&t===ho.mapValue)return 0;if(e===ho.mapValue)return 1;if(t===ho.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},s=Object.keys(a);r.sort(),s.sort();for(let i=0;i<r.length&&i<s.length;++i){const e=_s(r[i],s[i]);if(0!==e)return e;const t=yo(n[r[i]],a[s[i]]);if(0!==t)return t}return ks(r.length,s.length)}(e.mapValue,t.mapValue);default:throw os(23264,{he:n})}}function bo(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ks(e,t);const n=Xi(e),r=Xi(t),a=ks(n.seconds,r.seconds);return 0!==a?a:ks(n.nanos,r.nanos)}function wo(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=yo(n[a],r[a]);if(e)return e}return ks(n.length,r.length)}function To(e){return Eo(e)}function Eo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Xi(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Ji(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Ls.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Eo(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+=`${a}:${Eo(e.fields[a])}`;return n+"}"}(e.mapValue):os(61005,{value:e})}function So(e){switch(mo(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ao(e);return t?16+So(t):16;case 5:return 2*e.stringValue.length;case 6:return Ji(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+So(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ji(e.fields,(e,n)=>{t+=e.length+So(n)}),t}(e.mapValue);default:throw os(13486,{value:e})}}function ko(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function _o(e){return!!e&&"integerValue"in e}function xo(e){return!!e&&"arrayValue"in e}function Co(e){return!!e&&"nullValue"in e}function Ao(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function No(e){return!!e&&"mapValue"in e}function Io(e){const t=(e?.mapValue?.fields||{})[co]?.stringValue;return t===fo}function Ro(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return ji(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ro(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ro(e.arrayValue.values[n]);return t}return{...e}}function Oo(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===uo}class Po{constructor(e){this.value=e}static empty(){return new Po({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!No(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ro(t)}setAll(e){let t=Ds.emptyPath(),n={},r=[];e.forEach((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=Ro(e):r.push(a.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());No(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return go(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];No(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ji(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Po(Ro(this.value))}}function Do(e){const t=[];return ji(e.fields,(e,n)=>{const r=new Ds([e]);if(No(n)){const e=Do(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new $i(t)}class Lo{constructor(e,t,n,r,a,s,i){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=s,this.documentState=i}static newInvalidDocument(e){return new Lo(e,0,Gs.min(),Gs.min(),Gs.min(),Po.empty(),0)}static newFoundDocument(e,t,n,r){return new Lo(e,1,t,Gs.min(),n,r,0)}static newNoDocument(e,t){return new Lo(e,2,t,Gs.min(),Gs.min(),Po.empty(),0)}static newUnknownDocument(e,t){return new Lo(e,3,t,Gs.min(),Gs.min(),Po.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Gs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Po.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Po.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gs.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Lo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Lo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Mo{constructor(e,t){this.position=e,this.inclusive=t}}function Fo(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const s=t[a],i=e.position[a];if(r=s.field.isKeyField()?Ls.comparator(Ls.fromName(i.referenceValue),n.key):yo(i,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Uo(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!go(e.position[n],t.position[n]))return!1;return!0}class jo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function zo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Vo{}class Bo extends Vo{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Xo(e,t,n):"array-contains"===t?new el(e,n):"in"===t?new tl(e,n):"not-in"===t?new nl(e,n):"array-contains-any"===t?new rl(e,n):new Bo(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Yo(e,n):new Jo(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(yo(t,this.value)):null!==t&&mo(this.value)===mo(t)&&this.matchesComparison(yo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return os(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ho extends Vo{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ho(e,t)}matches(e){return Wo(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Wo(e){return"and"===e.op}function qo(e){return $o(e)&&Wo(e)}function $o(e){for(const t of e.filters)if(t instanceof Ho)return!1;return!0}function Go(e){if(e instanceof Bo)return e.field.canonicalString()+e.op.toString()+To(e.value);if(qo(e))return e.filters.map(e=>Go(e)).join(",");{const t=e.filters.map(e=>Go(e)).join(",");return`${e.op}(${t})`}}function Ko(e,t){return e instanceof Bo?function(e,t){return t instanceof Bo&&e.op===t.op&&e.field.isEqual(t.field)&&go(e.value,t.value)}(e,t):e instanceof Ho?function(e,t){return t instanceof Ho&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Ko(n,t.filters[r]),!0)}(e,t):void os(19439)}function Qo(e){return e instanceof Bo?function(e){return`${e.field.canonicalString()} ${e.op} ${To(e.value)}`}(e):e instanceof Ho?function(e){return e.op.toString()+" {"+e.getFilters().map(Qo).join(" ,")+"}"}(e):"Filter"}class Xo extends Bo{constructor(e,t,n){super(e,t,n),this.key=Ls.fromName(n.referenceValue)}matches(e){const t=Ls.comparator(e.key,this.key);return this.matchesComparison(t)}}class Yo extends Bo{constructor(e,t){super(e,"in",t),this.keys=Zo("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Jo extends Bo{constructor(e,t){super(e,"not-in",t),this.keys=Zo("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Zo(e,t){return(t.arrayValue?.values||[]).map(e=>Ls.fromName(e.referenceValue))}class el extends Bo{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return xo(t)&&vo(t.arrayValue,this.value)}}class tl extends Bo{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&vo(this.value.arrayValue,t)}}class nl extends Bo{constructor(e,t){super(e,"not-in",t)}matches(e){if(vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!vo(this.value.arrayValue,t)}}class rl extends Bo{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!xo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>vo(this.value.arrayValue,e))}}class al{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=s,this.endAt=i,this.Te=null}}function sl(e){return new al(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function il(e){const t=us(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Go(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),li(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>To(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>To(e)).join(",")),t.Te=e}return t.Te}function ol(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!zo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ko(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Uo(e.startAt,t.startAt)&&Uo(e.endAt,t.endAt)}function ll(e){return Ls.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class cl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=s,this.startAt=i,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ul(e,t,n,r,a,s,i,o){return new cl(e,t,n,r,a,s,i,o)}function hl(e){return new cl(e)}function fl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function dl(e){return null!==e.collectionGroup}function pl(e){const t=us(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Wi(Ds.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new jo(r,n))}),e.has(Ds.keyField().canonicalString())||t.Ie.push(new jo(Ds.keyField(),n))}return t.Ie}function ml(e){const t=us(e);return t.Ee||(t.Ee=gl(t,pl(e))),t.Ee}function gl(e,t){if("F"===e.limitType)return sl(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new jo(e.field,t)});const n=e.endAt?new Mo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Mo(e.startAt.position,e.startAt.inclusive):null;return sl(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function vl(e,t){const n=e.filters.concat([t]);return new cl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function yl(e,t,n){return new cl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function bl(e,t){return ol(ml(e),ml(t))&&e.limitType===t.limitType}function wl(e){return`${il(ml(e))}|lt:${e.limitType}`}function Tl(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Qo(e)).join(", ")}]`),li(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>To(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>To(e)).join(",")),`Target(${t})`}(ml(e))}; limitType=${e.limitType})`}function El(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ls.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of pl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Fo(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,pl(e),t))&&!(e.endAt&&!function(e,t,n){const r=Fo(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,pl(e),t))}(e,t)}function Sl(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function kl(e){return(t,n)=>{let r=!1;for(const a of pl(e)){const e=_l(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function _l(e,t,n){const r=e.field.isKeyField()?Ls.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?yo(r,a):os(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return os(19790,{direction:e.dir})}}class xl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ji(this.inner,(t,n)=>{for(const[r,a]of n)e(r,a)})}isEmpty(){return zi(this.inner)}size(){return this.innerSize}}const Cl=new Vi(Ls.comparator);function Al(){return Cl}const Nl=new Vi(Ls.comparator);function Il(){let e=Nl;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function Rl(e){let t=Nl;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Ol(){return Dl()}function Pl(){return Dl()}function Dl(){return new xl(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ll=new Vi(Ls.comparator),Ml=new Wi(Ls.comparator);function Fl(){let e=Ml;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const Ul=new Wi(ks);function jl(){return Ul}function zl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(t)?"-0":t}}function Vl(e){return{integerValue:""+e}}function Bl(e,t){return ui(t)?Vl(t):zl(e,t)}class Hl{constructor(){this._=void 0}}function Wl(e,t,n){return e instanceof Gl?function(e,t){const n={fields:{[eo]:{stringValue:Zi},[no]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ro(t)&&(t=ao(t)),t&&(n.fields[to]=t),{mapValue:n}}(n,t):e instanceof Kl?Ql(e,t):e instanceof Xl?Yl(e,t):function(e,t){const n=$l(e,t),r=Zl(n)+Zl(e.Ae);return _o(n)&&_o(e.Ae)?Vl(r):zl(e.serializer,r)}(e,t)}function ql(e,t,n){return e instanceof Kl?Ql(e,t):e instanceof Xl?Yl(e,t):n}function $l(e,t){return e instanceof Jl?function(e){return _o(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Gl extends Hl{}class Kl extends Hl{constructor(e){super(),this.elements=e}}function Ql(e,t){const n=ec(t);for(const r of e.elements)n.some(e=>go(e,r))||n.push(r);return{arrayValue:{values:n}}}class Xl extends Hl{constructor(e){super(),this.elements=e}}function Yl(e,t){let n=ec(t);for(const r of e.elements)n=n.filter(e=>!go(e,r));return{arrayValue:{values:n}}}class Jl extends Hl{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Zl(e){return Yi(e.integerValue||e.doubleValue)}function ec(e){return xo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class tc{constructor(e,t){this.field=e,this.transform=t}}class nc{constructor(e,t){this.version=e,this.transformResults=t}}class rc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rc}static exists(e){return new rc(void 0,e)}static updateTime(e){return new rc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ac(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class sc{}function ic(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new gc(e.key,rc.none()):new hc(e.key,e.data,rc.none());{const n=e.data,r=Po.empty();let a=new Wi(Ds.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new fc(e.key,r,new $i(a.toArray()),rc.none())}}function oc(e,t,n){e instanceof hc?function(e,t,n){const r=e.value.clone(),a=pc(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof fc?function(e,t,n){if(!ac(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=pc(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(dc(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function lc(e,t,n,r){return e instanceof hc?function(e,t,n,r){if(!ac(e.precondition,t))return n;const a=e.value.clone(),s=mc(e.fieldTransforms,r,t);return a.setAll(s),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof fc?function(e,t,n,r){if(!ac(e.precondition,t))return n;const a=mc(e.fieldTransforms,r,t),s=t.data;return s.setAll(dc(e)),s.setAll(a),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return ac(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function cc(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=$l(r.transform,e||null);null!=a&&(null===n&&(n=Po.empty()),n.set(r.field,a))}return n||null}function uc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Ns(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Kl&&t instanceof Kl||e instanceof Xl&&t instanceof Xl?Ns(e.elements,t.elements,go):e instanceof Jl&&t instanceof Jl?go(e.Ae,t.Ae):e instanceof Gl&&t instanceof Gl}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class hc extends sc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class fc extends sc{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function dc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function pc(e,t,n){const r=new Map;cs(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let a=0;a<n.length;a++){const s=e[a],i=s.transform,o=t.data.field(s.field);r.set(s.field,ql(i,o,n[a]))}return r}function mc(e,t,n){const r=new Map;for(const a of e){const e=a.transform,s=n.data.field(a.field);r.set(a.field,Wl(e,s,t))}return r}class gc extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vc extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&oc(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=lc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=lc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Pl();return this.mutations.forEach(r=>{const a=e.get(r.key),s=a.overlayedDocument;let i=this.applyToLocalView(s,a.mutatedFields);i=t.has(r.key)?null:i;const o=ic(s,i);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(Gs.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Fl())}isEqual(e){return this.batchId===e.batchId&&Ns(this.mutations,e.mutations,(e,t)=>uc(e,t))&&Ns(this.baseMutations,e.baseMutations,(e,t)=>uc(e,t))}}class bc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){cs(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Ll;const a=e.mutations;for(let s=0;s<a.length;s++)r=r.insert(a[s].key,n[s].version);return new bc(e,t,n,r)}}class wc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Tc{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ec,Sc;function kc(e){switch(e){case hs.OK:return os(64938);case hs.CANCELLED:case hs.UNKNOWN:case hs.DEADLINE_EXCEEDED:case hs.RESOURCE_EXHAUSTED:case hs.INTERNAL:case hs.UNAVAILABLE:case hs.UNAUTHENTICATED:return!1;case hs.INVALID_ARGUMENT:case hs.NOT_FOUND:case hs.ALREADY_EXISTS:case hs.PERMISSION_DENIED:case hs.FAILED_PRECONDITION:case hs.ABORTED:case hs.OUT_OF_RANGE:case hs.UNIMPLEMENTED:case hs.DATA_LOSS:return!0;default:return os(15467,{code:e})}}function _c(e){if(void 0===e)return as("GRPC error has no .code"),hs.UNKNOWN;switch(e){case Ec.OK:return hs.OK;case Ec.CANCELLED:return hs.CANCELLED;case Ec.UNKNOWN:return hs.UNKNOWN;case Ec.DEADLINE_EXCEEDED:return hs.DEADLINE_EXCEEDED;case Ec.RESOURCE_EXHAUSTED:return hs.RESOURCE_EXHAUSTED;case Ec.INTERNAL:return hs.INTERNAL;case Ec.UNAVAILABLE:return hs.UNAVAILABLE;case Ec.UNAUTHENTICATED:return hs.UNAUTHENTICATED;case Ec.INVALID_ARGUMENT:return hs.INVALID_ARGUMENT;case Ec.NOT_FOUND:return hs.NOT_FOUND;case Ec.ALREADY_EXISTS:return hs.ALREADY_EXISTS;case Ec.PERMISSION_DENIED:return hs.PERMISSION_DENIED;case Ec.FAILED_PRECONDITION:return hs.FAILED_PRECONDITION;case Ec.ABORTED:return hs.ABORTED;case Ec.OUT_OF_RANGE:return hs.OUT_OF_RANGE;case Ec.UNIMPLEMENTED:return hs.UNIMPLEMENTED;case Ec.DATA_LOSS:return hs.DATA_LOSS;default:return os(39323,{code:e})}}(Sc=Ec||(Ec={}))[Sc.OK=0]="OK",Sc[Sc.CANCELLED=1]="CANCELLED",Sc[Sc.UNKNOWN=2]="UNKNOWN",Sc[Sc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Sc[Sc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Sc[Sc.NOT_FOUND=5]="NOT_FOUND",Sc[Sc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Sc[Sc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Sc[Sc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Sc[Sc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Sc[Sc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Sc[Sc.ABORTED=10]="ABORTED",Sc[Sc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Sc[Sc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Sc[Sc.INTERNAL=13]="INTERNAL",Sc[Sc.UNAVAILABLE=14]="UNAVAILABLE",Sc[Sc.DATA_LOSS=15]="DATA_LOSS";let xc=null;function Cc(){return new TextEncoder}const Ac=new Fa([4294967295,4294967295],0);function Nc(e){const t=Cc().encode(e),n=new Ua;return n.update(t),new Uint8Array(n.digest())}function Ic(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Fa([n,r],0),new Fa([a,s],0)]}class Rc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Oc(`Invalid padding: ${t}`);if(n<0)throw new Oc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Oc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Oc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Fa.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Fa.fromNumber(n)));return 1===r.compare(Ac)&&(r=new Fa([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Nc(e),[n,r]=Ic(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new Rc(a,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=Nc(e),[n,r]=Ic(t);for(let a=0;a<this.hashCount;a++){const e=this.ye(n,r,a);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Oc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Pc{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Dc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Pc(Gs.min(),r,new Vi(ks),Al(),Fl())}}class Dc{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Dc(n,t,Fl(),Fl(),Fl())}}class Lc{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Mc{constructor(e,t){this.targetId=e,this.Ce=t}}class Fc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ki.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Uc{constructor(){this.ve=0,this.Fe=Vc(),this.Me=Ki.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fl(),t=Fl(),n=Fl();return this.Fe.forEach((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:os(38017,{changeType:a})}}),new Dc(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Vc()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,cs(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jc{constructor(e){this.Ge=e,this.ze=new Map,this.je=Al(),this.Je=zc(),this.He=zc(),this.Ye=new Vi(ks)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:os(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const a=r.target;if(ll(a))if(0===n){const e=new Ls(a.path);this.et(t,e,Lo.newNoDocument(e,Gs.min()))}else cs(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){const n=this.ut(e),a=n?this.ct(n,e,r):1;if(0!==a){this.it(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}xc?.lt(function(e,t,n,r,a){const s={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},i=t.unchangedNames;return i&&(s.bloomFilter={applied:0===a,hashCount:i?.hashCount??0,bitmapLength:i?.bits?.bitmap?.length??0,padding:i?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),s}(r,e.Ce,this.Ge.ht(),n,a))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let s,i;try{s=Ji(n).toUint8Array()}catch(e){if(e instanceof Gi)return ss("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new Rc(s,r,a)}catch(e){return ss(e instanceof Oc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.ge?null:i}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const a=this.Ge.ht(),s=`projects/${a.projectId}/databases/${a.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const a=this.ot(r);if(a){if(n.current&&ll(a.target)){const t=new Ls(a.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Lo.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Fl();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Pc(e,t,this.Ye,this.je,n);return this.je=Al(),this.Je=zc(),this.He=zc(),this.Ye=new Vi(ks),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Uc,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Wi(ks),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Wi(ks),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||rs("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Uc),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zc(){return new Vi(Ls.comparator)}function Vc(){return new Vi(Ls.comparator)}const Bc={asc:"ASCENDING",desc:"DESCENDING"},Hc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Wc={and:"AND",or:"OR"};class qc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $c(e,t){return e.useProto3Json||li(t)?t:{value:t}}function Gc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Kc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Qc(e,t){return Gc(e,t.toTimestamp())}function Xc(e){return cs(!!e,49232),Gs.fromTimestamp(function(e){const t=Xi(e);return new $s(t.seconds,t.nanos)}(e))}function Yc(e,t){return Jc(e,t).canonicalString()}function Jc(e,t){const n=function(e){return new Os(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Zc(e){const t=Os.fromString(e);return cs(bu(t),10190,{key:t.toString()}),t}function eu(e,t){return Yc(e.databaseId,t.path)}function tu(e,t){const n=Zc(t);if(n.get(1)!==e.databaseId.projectId)throw new fs(hs.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new fs(hs.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ls(su(n))}function nu(e,t){return Yc(e.databaseId,t)}function ru(e){const t=Zc(e);return 4===t.length?Os.emptyPath():su(t)}function au(e){return new Os(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function su(e){return cs(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function iu(e,t,n){return{name:eu(e,t),fields:n.value.mapValue.fields}}function ou(e,t){let n;if(t instanceof hc)n={update:iu(e,t.key,t.value)};else if(t instanceof gc)n={delete:eu(e,t.key)};else if(t instanceof fc)n={update:iu(e,t.key,t.data),updateMask:yu(t.fieldMask)};else{if(!(t instanceof vc))return os(16599,{Vt:t.type});n={verify:eu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Gl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Kl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Xl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Jl)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw os(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Qc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:os(27497)}(e,t.precondition)),n}function lu(e,t){return{documents:[nu(e,t.path)]}}function cu(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=nu(e,a);const s=function(e){if(0!==e.length)return vu(Ho.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:mu(e.field),direction:fu(e.dir)}}(e))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);const o=$c(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:a}}function uu(e){let t=ru(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){cs(1===r,65062);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=hu(e);return t instanceof Ho&&qo(t)?t.getFilters():[t]}(n.where));let i=[];n.orderBy&&(i=function(e){return e.map(e=>function(e){return new jo(gu(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,li(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Mo(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Mo(n,t)}(n.endAt)),ul(t,a,i,s,o,"F",l,c)}function hu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=gu(e.unaryFilter.field);return Bo.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=gu(e.unaryFilter.field);return Bo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=gu(e.unaryFilter.field);return Bo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=gu(e.unaryFilter.field);return Bo.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return os(61313);default:return os(60726)}}(e):void 0!==e.fieldFilter?function(e){return Bo.create(gu(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return os(58110);default:return os(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ho.create(e.compositeFilter.filters.map(e=>hu(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return os(1026)}}(e.compositeFilter.op))}(e):os(30097,{filter:e})}function fu(e){return Bc[e]}function du(e){return Hc[e]}function pu(e){return Wc[e]}function mu(e){return{fieldPath:e.canonicalString()}}function gu(e){return Ds.fromServerFormat(e.fieldPath)}function vu(e){return e instanceof Bo?function(e){if("=="===e.op){if(Ao(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NAN"}};if(Co(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ao(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NOT_NAN"}};if(Co(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mu(e.field),op:du(e.op),value:e.value}}}(e):e instanceof Ho?function(e){const t=e.getFilters().map(e=>vu(e));return 1===t.length?t[0]:{compositeFilter:{op:pu(e.op),filters:t}}}(e):os(54877,{filter:e})}function yu(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function bu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class wu{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Gs.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Gs.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ki.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=i,this.expectedCount=o}withSequenceNumber(e){return new wu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Tu{constructor(e){this.yt=e}}function Eu(e){const t=uu({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?yl(t,t.limit,"L"):t}class Su{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Yi(e.integerValue));else if("doubleValue"in e){const n=Yi(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),ci(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Xi(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ji(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Oo(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Io(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):os(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=po,a=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Yi(a)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ls.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Su.Kt=new Su;class ku{constructor(){this.Cn=new _u}addToCollectionParentIndex(e,t){return this.Cn.add(t),ri.resolve()}getCollectionParents(e,t){return ri.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ri.resolve()}deleteFieldIndex(e,t){return ri.resolve()}deleteAllFieldIndexes(e){return ri.resolve()}createTargetIndexes(e,t){return ri.resolve()}getDocumentsMatchingTarget(e,t){return ri.resolve(null)}getIndexType(e,t){return ri.resolve(0)}getFieldIndexes(e,t){return ri.resolve([])}getNextCollectionGroupToUpdate(e){return ri.resolve(null)}getMinOffset(e,t){return ri.resolve(Js.min())}getMinOffsetFromCollectionGroup(e,t){return ri.resolve(Js.min())}updateCollectionGroup(e,t,n){return ri.resolve()}updateIndexEntries(e,t){return ri.resolve()}}class _u{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Wi(Os.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Wi(Os.comparator)).toArray()}}new Uint8Array(0);const xu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Cu=41943040;class Au{static withCacheSize(e){return new Au(e,Au.DEFAULT_COLLECTION_PERCENTILE,Au.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Au.DEFAULT_COLLECTION_PERCENTILE=10,Au.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Au.DEFAULT=new Au(Cu,Au.DEFAULT_COLLECTION_PERCENTILE,Au.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Au.DISABLED=new Au(-1,0,0);class Nu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Nu(0)}static cr(){return new Nu(-1)}}const Iu="LruGarbageCollector",Ru=1048576;function Ou(e,t){let[n,r]=e,[a,s]=t;const i=ks(n,a);return 0===i?ks(r,s):i}class Pu{constructor(e){this.Ir=e,this.buffer=new Wi(Ou),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Ou(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Du{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){rs(Iu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){si(e)?rs(Iu,"Ignoring IndexedDB error during garbage collection: ",e):await ni(e)}await this.Vr(3e5)})}}class Lu{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return ri.resolve(ii.ce);const n=new Pu(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(rs("LruGarbageCollector","Garbage collection skipped; disabled"),ri.resolve(xu)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(rs("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xu):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,a,s,i,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(rs("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,i=Date.now(),this.removeTargets(e,n,t))).next(t=>(a=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),ns()<=V.DEBUG&&rs("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(i-s)+"ms\n"+`\tRemoved ${a} targets in `+(o-i)+"ms\n"+`\tRemoved ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-c}ms`),ri.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e})))}}function Mu(e,t){return new Lu(e,t)}class Fu{constructor(){this.changes=new xl(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Lo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ri.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Uu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ju{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&lc(n.mutation,e,$i.empty(),$s.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Fl()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fl();const r=Ol();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Il();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Ol();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Fl()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let a=Al();const s=Dl(),i=Dl();return t.forEach((e,t)=>{const i=n.get(t.key);r.has(t.key)&&(void 0===i||i.mutation instanceof fc)?a=a.insert(t.key,t):void 0!==i?(s.set(t.key,i.mutation.getFieldMask()),lc(i.mutation,t,i.mutation.getFieldMask(),$s.now())):s.set(t.key,$i.empty())}),this.recalculateAndSaveOverlays(e,a).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>i.set(e,new Uu(t,s.get(e)??null))),i))}recalculateAndSaveOverlays(e,t){const n=Dl();let r=new Vi((e,t)=>e-t),a=Fl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const a of e)a.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let i=n.get(e)||$i.empty();i=a.applyToLocalView(s,i),n.set(e,i);const o=(r.get(a.batchId)||Fl()).add(e);r=r.insert(a.batchId,o)})}).next(()=>{const s=[],i=r.getReverseIterator();for(;i.hasNext();){const r=i.getNext(),o=r.key,l=r.value,c=Pl();l.forEach(e=>{if(!a.has(e)){const r=ic(t.get(e),n.get(e));null!==r&&c.set(e,r),a=a.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ri.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Ls.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(a=>{const s=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):ri.resolve(Ol());let i=Ks,o=a;return s.next(t=>ri.forEach(t,(t,n)=>(i<n.largestBatchId&&(i=n.largestBatchId),a.get(t)?ri.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,a)).next(()=>this.computeViews(e,o,t,Fl())).next(e=>({batchId:i,changes:Rl(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ls(t)).next(e=>{let t=Il();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let s=Il();return this.indexManager.getCollectionParents(e,a).next(i=>ri.forEach(i,i=>{const o=function(e,t){return new cl(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r))).next(e=>{a.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Lo.newInvalidDocument(r)))});let n=Il();return e.forEach((e,r)=>{const s=a.get(e);void 0!==s&&lc(s.mutation,r,$i.empty(),$s.now()),El(t,r)&&(n=n.insert(e,r))}),n})}}class zu{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ri.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Xc(e.createTime)}}(t)),ri.resolve()}getNamedQuery(e,t){return ri.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Eu(e.bundledQuery),readTime:Xc(e.readTime)}}(t)),ri.resolve()}}class Vu{constructor(){this.overlays=new Vi(Ls.comparator),this.qr=new Map}getOverlay(e,t){return ri.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ol();return ri.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),ri.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),ri.resolve()}getOverlaysForCollection(e,t,n){const r=Ol(),a=t.length+1,s=new Ls(t.child("")),i=this.overlays.getIteratorFrom(s);for(;i.hasNext();){const e=i.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ri.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new Vi((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=Ol(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=Ol(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>i.set(e,t)),!(i.size()>=r)););return ri.resolve(i)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new wc(t,n));let a=this.qr.get(t);void 0===a&&(a=Fl(),this.qr.set(t,a)),this.qr.set(t,a.add(n.key))}}class Bu{constructor(){this.sessionToken=Ki.EMPTY_BYTE_STRING}getSessionToken(e){return ri.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ri.resolve()}}class Hu{constructor(){this.Qr=new Wi(Wu.$r),this.Ur=new Wi(Wu.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Wu(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Wu(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Ls(new Os([])),n=new Wu(t,e),r=new Wu(t,e+1),a=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),a.push(e.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ls(new Os([])),n=new Wu(t,e),r=new Wu(t,e+1);let a=Fl();return this.Ur.forEachInRange([n,r],e=>{a=a.add(e.key)}),a}containsKey(e){const t=new Wu(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Wu{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ls.comparator(e.key,t.key)||ks(e.Yr,t.Yr)}static Kr(e,t){return ks(e.Yr,t.Yr)||Ls.comparator(e.key,t.key)}}class qu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Wi(Wu.$r)}checkEmpty(e){return ri.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new yc(a,t,n,r);this.mutationQueue.push(s);for(const i of r)this.Zr=this.Zr.add(new Wu(i.key,a)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return ri.resolve(s)}lookupMutationBatch(e,t){return ri.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),a=r<0?0:r;return ri.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ri.resolve(0===this.mutationQueue.length?oi:this.tr-1)}getAllMutationBatches(e){return ri.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Wu(t,0),r=new Wu(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);a.push(t)}),ri.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Wi(ks);return t.forEach(e=>{const t=new Wu(e,0),r=new Wu(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),ri.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;Ls.isDocumentKey(a)||(a=a.child(""));const s=new Wu(new Ls(a),0);let i=new Wi(ks);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.Yr)),!0)},s),ri.resolve(this.ti(i))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){cs(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return ri.forEach(t.mutations,r=>{const a=new Wu(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Wu(t,0),r=this.Zr.firstAfterOrEqual(n);return ri.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ri.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $u{constructor(e){this.ri=e,this.docs=new Vi(Ls.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ri.resolve(n?n.document.mutableCopy():Lo.newInvalidDocument(t))}getEntries(e,t){let n=Al();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Lo.newInvalidDocument(e))}),ri.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=Al();const s=t.path,i=new Ls(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:e,value:{document:i}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Zs(Ys(i),n)<=0||(r.has(i.key)||El(t,i))&&(a=a.insert(i.key,i.mutableCopy()))}return ri.resolve(a)}getAllFromCollectionGroup(e,t,n,r){os(9500)}ii(e,t){return ri.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Gu(this)}getSize(e){return ri.resolve(this.size)}}class Gu extends Fu{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ri.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Ku{constructor(e){this.persistence=e,this.si=new xl(e=>il(e),ol),this.lastRemoteSnapshotVersion=Gs.min(),this.highestTargetId=0,this.oi=0,this._i=new Hu,this.targetCount=0,this.ai=Nu.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),ri.resolve()}getLastRemoteSnapshotVersion(e){return ri.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ri.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ri.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ri.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Nu(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ri.resolve()}updateTargetData(e,t){return this.Pr(t),ri.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ri.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.si.forEach((s,i)=>{i.sequenceNumber<=t&&null===n.get(i.targetId)&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,i.targetId)),r++)}),ri.waitFor(a).next(()=>r)}getTargetCount(e){return ri.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ri.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ri.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach(t=>{a.push(r.markPotentiallyOrphaned(e,t))}),ri.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ri.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ri.resolve(n)}containsKey(e,t){return ri.resolve(this._i.containsKey(t))}}class Qu{constructor(e,t){this.ui={},this.overlays={},this.ci=new ii(0),this.li=!1,this.li=!0,this.hi=new Bu,this.referenceDelegate=e(this),this.Pi=new Ku(this),this.indexManager=new ku,this.remoteDocumentCache=function(e){return new $u(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Tu(t),this.Ii=new zu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Vu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new qu(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){rs("MemoryPersistence","Starting transaction:",e);const r=new Xu(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return ri.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Xu extends ti{constructor(e){super(),this.currentSequenceNumber=e}}class Yu{constructor(e){this.persistence=e,this.Ri=new Hu,this.Vi=null}static mi(e){return new Yu(e)}get fi(){if(this.Vi)return this.Vi;throw os(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ri.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ri.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ri.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ri.forEach(this.fi,n=>{const r=Ls.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Gs.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ri.or([()=>ri.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ju{constructor(e,t){this.persistence=e,this.pi=new xl(e=>fi(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Mu(this,t)}static mi(e,t){return new Ju(e,t)}Ei(){}di(e){return ri.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return ri.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?ri.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,a.removeEntry(r,Gs.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ri.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ri.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ri.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ri.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=So(e.data.value)),t}br(e,t,n){return ri.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return ri.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Zu{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Fl(),r=Fl();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Zu(e,t.fromCache,n,r)}}class eh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class th{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=S()?8:ai(T())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.ys(e,t).next(e=>{a.result=e}).next(()=>{if(!a.result)return this.ws(e,t,r,n).next(e=>{a.result=e})}).next(()=>{if(a.result)return;const n=new eh;return this.Ss(e,t,n).next(r=>{if(a.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>a.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(ns()<=V.DEBUG&&rs("QueryEngine","SDK will not create cache indexes for query:",Tl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ri.resolve()):(ns()<=V.DEBUG&&rs("QueryEngine","Query:",Tl(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(ns()<=V.DEBUG&&rs("QueryEngine","The SDK decides to create cache indexes for query:",Tl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ml(t))):ri.resolve())}ys(e,t){if(fl(t))return ri.resolve(null);let n=ml(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=yl(t,null,"F"),n=ml(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const a=Fl(...r);return this.ps.getDocuments(e,a).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,a,n.readTime)?this.ys(e,yl(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return fl(t)||r.isEqual(Gs.min())?ri.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(t,a);return this.Cs(t,s,n,r)?ri.resolve(null):(ns()<=V.DEBUG&&rs("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Tl(t)),this.vs(e,s,t,Xs(r,Ks)).next(e=>e))})}Ds(e,t){let n=new Wi(kl(e));return t.forEach((t,r)=>{El(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ss(e,t,n){return ns()<=V.DEBUG&&rs("QueryEngine","Using full collection scan to execute query:",Tl(t)),this.ps.getDocumentsMatchingQuery(e,t,Js.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const nh="LocalStore";class rh{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Vi(ks),this.xs=new xl(e=>il(e),ol),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ju(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function ah(e,t,n,r){return new rh(e,t,n,r)}async function sh(e,t){const n=us(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(a=>(r=a,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const a=[],s=[];let i=Fl();for(const e of r){a.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return n.localDocuments.getDocuments(e,i).next(e=>({Ls:e,removedBatchIds:a,addedBatchIds:s}))})})}function ih(e){const t=us(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function oh(e,t,n){let r=Fl(),a=Fl();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Al();return n.forEach((n,s)=>{const i=e.get(n);s.isFoundDocument()!==i.isFoundDocument()&&(a=a.add(n)),s.isNoDocument()&&s.version.isEqual(Gs.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!i.isValidDocument()||s.version.compareTo(i.version)>0||0===s.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):rs(nh,"Ignoring outdated watch update for ",n,". Current version:",i.version," Watch version:",s.version)}),{ks:r,qs:a}})}function lh(e,t){const n=us(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=oi),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function ch(e,t){const n=us(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(a=>a?(r=a,ri.resolve(r)):n.Pi.allocateTargetId(e).next(a=>(r=new wu(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function uh(e,t,n){const r=us(e),a=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,a))}catch(e){if(!si(e))throw e;rs(nh,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(a.target)}function hh(e,t,n){const r=us(e);let a=Gs.min(),s=Fl();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=us(e),a=r.xs.get(n);return void 0!==a?ri.resolve(r.Ms.get(a)):r.Pi.getTargetData(t,n)}(r,e,ml(t)).next(t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?a:Gs.min(),n?s:Fl())).next(e=>(fh(r,Sl(t),e),{documents:e,Qs:s})))}function fh(e,t,n){let r=e.Os.get(t)||Gs.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class dh{constructor(){this.activeTargetIds=jl()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ph{constructor(){this.Mo=new dh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new dh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class mh{Oo(e){}shutdown(){}}const gh="ConnectivityMonitor";class vh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){rs(gh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){rs(gh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let yh=null;function bh(){return null===yh?yh=268435456+Math.round(2147483648*Math.random()):yh++,"0x"+yh.toString(16)}const wh="RestConnection",Th={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Eh{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===oo?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,a){const s=bh(),i=this.zo(e,t.toUriEncodedString());rs(wh,`Sending RPC '${e}' ${s}:`,i,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,a);const{host:l}=new URL(i),c=g(l);return this.Jo(e,i,o,n,c).then(t=>(rs(wh,`Received RPC '${e}' ${s}: `,t),t),t=>{throw ss(wh,`RPC '${e}' ${s} failed with error: `,t,"url: ",i,"request:",n),t})}Ho(e,t,n,r,a,s){return this.Go(e,t,n,r,a)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+es,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Th[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class Sh{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kh="WebChannelConnection";class _h extends Eh{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,a){const s=bh();return new Promise((a,i)=>{const o=new Va;o.setWithCredentials(!0),o.listenOnce(Ha.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case Wa.NO_ERROR:const t=o.getResponseJson();rs(kh,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),a(t);break;case Wa.TIMEOUT:rs(kh,`RPC '${e}' ${s} timed out`),i(new fs(hs.DEADLINE_EXCEEDED,"Request time out"));break;case Wa.HTTP_ERROR:const n=o.getStatus();if(rs(kh,`RPC '${e}' ${s} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(hs).indexOf(t)>=0?t:hs.UNKNOWN}(t.status);i(new fs(e,t.message))}else i(new fs(hs.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new fs(hs.UNAVAILABLE,"Connection failed."));break;default:os(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{rs(kh,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(r);rs(kh,`RPC '${e}' ${s} sending request:`,r),o.send(t,"POST",l,n,15)})}T_(e,t,n){const r=bh(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Ka(),i=Ga(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=a.join("");rs(kh,`Creating RPC '${e}' stream ${r}: ${c}`,o);const u=s.createWebChannel(c,o);this.I_(u);let h=!1,f=!1;const d=new Sh({Yo:t=>{f?rs(kh,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(rs(kh,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),rs(kh,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Ba.EventType.OPEN,()=>{f||(rs(kh,`RPC '${e}' stream ${r} transport opened.`),d.o_())}),p(u,Ba.EventType.CLOSE,()=>{f||(f=!0,rs(kh,`RPC '${e}' stream ${r} transport closed`),d.a_(),this.E_(u))}),p(u,Ba.EventType.ERROR,t=>{f||(f=!0,ss(kh,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),d.a_(new fs(hs.UNAVAILABLE,"The operation could not be completed")))}),p(u,Ba.EventType.MESSAGE,t=>{if(!f){const n=t.data[0];cs(!!n,16349);const a=n,s=a?.error||a[0]?.error;if(s){rs(kh,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Ec[e];if(void 0!==t)return _c(t)}(t),a=s.message;void 0===n&&(n=hs.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),f=!0,d.a_(new fs(n,a)),u.close()}else rs(kh,`RPC '${e}' stream ${r} received:`,n),d.u_(n)}}),p(i,$a.STAT_EVENT,t=>{t.stat===qa.PROXY?rs(kh,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===qa.NOPROXY&&rs(kh,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{d.__()},0),d}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function xh(){return"undefined"!=typeof document?document:null}function Ch(e){return new qc(e,!0)}class Ah{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&rs("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Nh="PersistentStream";class Ih{constructor(e,t,n,r,a,s,i,o){this.Mi=e,this.S_=n,this.b_=r,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=i,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ah(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===hs.RESOURCE_EXHAUSTED?(as(t.toString()),as("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===hs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new fs(hs.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return rs(Nh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(rs(Nh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Rh extends Ih{constructor(e,t,n,r,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:os(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(cs(void 0===t||"string"==typeof t,58123),Ki.fromBase64String(t||"")):(cs(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Ki.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(e){const t=void 0===e.code?hs.UNKNOWN:_c(e.code);return new fs(t,e.message||"")}(i);n=new Fc(r,a,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=tu(e,r.document.name),s=Xc(r.document.updateTime),i=r.document.createTime?Xc(r.document.createTime):Gs.min(),o=new Po({mapValue:{fields:r.document.fields}}),l=Lo.newFoundDocument(a,s,i,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Lc(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=tu(e,r.document),s=r.readTime?Xc(r.readTime):Gs.min(),i=Lo.newNoDocument(a,s),o=r.removedTargetIds||[];n=new Lc([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=tu(e,r.document),s=r.removedTargetIds||[];n=new Lc([],s,a,null)}else{if(!("filter"in t))return os(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,s=new Tc(r,a),i=e.targetId;n=new Mc(i,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Gs.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Gs.min():t.readTime?Xc(t.readTime):Gs.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=au(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ll(r)?{documents:lu(e,r)}:{query:cu(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Kc(e,t.resumeToken);const r=$c(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Gs.min())>0){n.readTime=Gc(e,t.snapshotVersion.toTimestamp());const r=$c(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return os(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=au(this.serializer),t.removeTarget=e,this.q_(t)}}class Oh extends Ih{constructor(e,t,n,r,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return cs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,cs(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){cs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(cs(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Xc(e.updateTime):Xc(t);return n.isEqual(Gs.min())&&(n=Xc(t)),new nc(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Xc(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=au(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>ou(this.serializer,e))};this.q_(t)}}class Ph{}class Dh extends Ph{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new fs(hs.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[s,i]=a;return this.connection.Go(e,Jc(t,n),r,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===hs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new fs(hs.UNKNOWN,e.toString())})}Ho(e,t,n,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,o]=s;return this.connection.Ho(e,Jc(t,n),r,i,o,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===hs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new fs(hs.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Lh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(as(t),this.aa=!1):rs("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Mh="RemoteStore";class Fh{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{$h(this)&&(rs(Mh,"Restarting streams for network reachability change."),await async function(e){const t=us(e);t.Ea.add(4),await jh(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Uh(t)}(this))})}),this.Ra=new Lh(n,r)}}async function Uh(e){if($h(e))for(const t of e.da)await t(!0)}async function jh(e){for(const t of e.da)await t(!1)}function zh(e,t){const n=us(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),qh(n)?Wh(n):ff(n).O_()&&Bh(n,t))}function Vh(e,t){const n=us(e),r=ff(n);n.Ia.delete(t),r.O_()&&Hh(n,t),0===n.Ia.size&&(r.O_()?r.L_():$h(n)&&n.Ra.set("Unknown"))}function Bh(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Gs.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ff(e).Y_(t)}function Hh(e,t){e.Va.Ue(t),ff(e).Z_(t)}function Wh(e){e.Va=new jc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),ff(e).start(),e.Ra.ua()}function qh(e){return $h(e)&&!ff(e).x_()&&e.Ia.size>0}function $h(e){return 0===us(e).Ea.size}function Gh(e){e.Va=void 0}async function Kh(e){e.Ra.set("Online")}async function Qh(e){e.Ia.forEach((t,n)=>{Bh(e,t)})}async function Xh(e,t){Gh(e),qh(e)?(e.Ra.ha(t),Wh(e)):e.Ra.set("Unknown")}async function Yh(e,t,n){if(e.Ra.set("Online"),t instanceof Fc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){rs(Mh,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Jh(e,n)}else if(t instanceof Lc?e.Va.Ze(t):t instanceof Mc?e.Va.st(t):e.Va.tt(t),!n.isEqual(Gs.min()))try{const t=await ih(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.Ia.get(r);a&&e.Ia.set(r,a.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Ki.EMPTY_BYTE_STRING,r.snapshotVersion)),Hh(e,t);const a=new wu(r.target,t,n,r.sequenceNumber);Bh(e,a)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){rs(Mh,"Failed to raise snapshot:",t),await Jh(e,t)}}async function Jh(e,t,n){if(!si(t))throw t;e.Ea.add(1),await jh(e),e.Ra.set("Offline"),n||(n=()=>ih(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{rs(Mh,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Uh(e)})}function Zh(e,t){return t().catch(n=>Jh(e,n,t))}async function ef(e){const t=us(e),n=df(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:oi;for(;tf(t);)try{const e=await lh(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,nf(t,e)}catch(e){await Jh(t,e)}rf(t)&&af(t)}function tf(e){return $h(e)&&e.Ta.length<10}function nf(e,t){e.Ta.push(t);const n=df(e);n.O_()&&n.X_&&n.ea(t.mutations)}function rf(e){return $h(e)&&!df(e).x_()&&e.Ta.length>0}function af(e){df(e).start()}async function sf(e){df(e).ra()}async function of(e){const t=df(e);for(const n of e.Ta)t.ea(n.mutations)}async function lf(e,t,n){const r=e.Ta.shift(),a=bc.from(r,t,n);await Zh(e,()=>e.remoteSyncer.applySuccessfulWrite(a)),await ef(e)}async function cf(e,t){t&&df(e).X_&&await async function(e,t){if(function(e){return kc(e)&&e!==hs.ABORTED}(t.code)){const n=e.Ta.shift();df(e).B_(),await Zh(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await ef(e)}}(e,t),rf(e)&&af(e)}async function uf(e,t){const n=us(e);n.asyncQueue.verifyOperationInProgress(),rs(Mh,"RemoteStore received new credentials");const r=$h(n);n.Ea.add(3),await jh(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Uh(n)}async function hf(e,t){const n=us(e);t?(n.Ea.delete(2),await Uh(n)):t||(n.Ea.add(2),await jh(n),n.Ra.set("Unknown"))}function ff(e){return e.ma||(e.ma=function(e,t,n){const r=us(e);return r.sa(),new Rh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Kh.bind(null,e),t_:Qh.bind(null,e),r_:Xh.bind(null,e),H_:Yh.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),qh(e)?Wh(e):e.Ra.set("Unknown")):(await e.ma.stop(),Gh(e))})),e.ma}function df(e){return e.fa||(e.fa=function(e,t,n){const r=us(e);return r.sa(),new Oh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:sf.bind(null,e),r_:cf.bind(null,e),ta:of.bind(null,e),na:lf.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await ef(e)):(await e.fa.stop(),e.Ta.length>0&&(rs(Mh,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class pf{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const s=Date.now()+n,i=new pf(e,t,s,r,a);return i.start(n),i}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new fs(hs.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mf(e,t){if(as("AsyncQueue",`${t}: ${e}`),si(e))return new fs(hs.UNAVAILABLE,`${t}: ${e}`);throw e}class gf{static emptySet(e){return new gf(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ls.comparator(t.key,n.key):(e,t)=>Ls.comparator(e.key,t.key),this.keyedMap=Il(),this.sortedSet=new Vi(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new gf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class vf{constructor(){this.ga=new Vi(Ls.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):os(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class yf{constructor(e,t,n,r,a,s,i,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=i,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,a){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new yf(e,t,gf.emptySet(t),s,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class bf{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class wf{constructor(){this.queries=Tf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=us(e),r=n.queries;n.queries=Tf(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new fs(hs.ABORTED,"Firestore shutting down"))}}function Tf(){return new xl(e=>wl(e),bl)}async function Ef(e,t){const n=us(e);let r=3;const a=t.query;let s=n.queries.get(a);s?!s.ba()&&t.Da()&&(r=2):(s=new bf,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(a,!0);break;case 1:s.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=mf(e,`Initialization of query '${Tl(t.query)}' failed`);return void t.onError(n)}n.queries.set(a,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&xf(n)}async function Sf(e,t){const n=us(e),r=t.query;let a=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?a=t.Da()?0:1:!s.ba()&&t.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function kf(e,t){const n=us(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(a)&&(r=!0);t.wa=a}}r&&xf(n)}function _f(e,t,n){const r=us(e),a=r.queries.get(t);if(a)for(const s of a.Sa)s.onError(n);r.queries.delete(t)}function xf(e){e.Ca.forEach(e=>{e.next()})}var Cf,Af;(Af=Cf||(Cf={})).Ma="default",Af.Cache="cache";class Nf{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new yf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=yf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Cf.Cache}}class If{constructor(e){this.key=e}}class Rf{constructor(e){this.key=e}}class Of{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Fl(),this.mutatedKeys=Fl(),this.eu=kl(e),this.tu=new gf(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new vf,r=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,s=r,i=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=El(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let d=!1;c&&u?c.data.isEqual(u.data)?h!==f&&(n.track({type:3,doc:u}),d=!0):this.su(c,u)||(n.track({type:2,doc:u}),d=!0,(o&&this.eu(u,o)>0||l&&this.eu(u,l)<0)&&(i=!0)):!c&&u?(n.track({type:0,doc:u}),d=!0):c&&!u&&(n.track({type:1,doc:c}),d=!0,(o||l)&&(i=!0)),d&&(u?(s=s.add(u),a=f?a.add(e):a.delete(e)):(s=s.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:i,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return os(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=r??!1;const i=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==s.length||l?{snapshot:new yf(this.query,e.tu,a,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:i}:{au:i}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Fl(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Rf(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new If(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Fl();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return yf.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Pf="SyncEngine";class Df{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Lf{constructor(e){this.key=e,this.hu=!1}}class Mf{constructor(e,t,n,r,a,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new xl(e=>wl(e),bl),this.Iu=new Map,this.Eu=new Set,this.du=new Vi(Ls.comparator),this.Au=new Map,this.Ru=new Hu,this.Vu={},this.mu=new Map,this.fu=Nu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Ff(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ad(e);let a;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.lu()):a=await jf(r,t,n,!0),a}async function Uf(e,t){const n=ad(e);await jf(n,t,!0,!1)}async function jf(e,t,n,r){const a=await ch(e.localStore,ml(t)),s=a.targetId,i=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await zf(e,t,s,"current"===i,a.resumeToken)),e.isPrimaryClient&&n&&zh(e.remoteStore,a),o}async function zf(e,t,n,r,a){e.pu=(t,n,r)=>async function(e,t,n,r){let a=t.view.ru(n);a.Cs&&(a=await hh(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,a)}));const s=r&&r.targetChanges.get(t.targetId),i=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,s,i);return Jf(e,t.targetId,o.au),o.snapshot}(e,t,n,r);const s=await hh(e.localStore,t,!0),i=new Of(t,s.Qs),o=i.ru(s.documents),l=Dc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),c=i.applyChanges(o,e.isPrimaryClient,l);Jf(e,n,c.au);const u=new Df(t,n,i);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function Vf(e,t,n){const r=us(e),a=r.Tu.get(t),s=r.Iu.get(a.targetId);if(s.length>1)return r.Iu.set(a.targetId,s.filter(e=>!bl(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await uh(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Vh(r.remoteStore,a.targetId),Xf(r,a.targetId)}).catch(ni)):(Xf(r,a.targetId),await uh(r.localStore,a.targetId,!0))}async function Bf(e,t){const n=us(e),r=n.Tu.get(t),a=n.Iu.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Vh(n.remoteStore,r.targetId))}async function Hf(e,t){const n=us(e);try{const e=await function(e,t){const n=us(e),r=t.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const i=[];t.targetChanges.forEach((s,o)=>{const l=a.get(o);if(!l)return;i.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Ki.EMPTY_BYTE_STRING,Gs.min()).withLastLimboFreeSnapshotVersion(Gs.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),a=a.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&i.push(n.Pi.updateTargetData(e,c))});let o=Al(),l=Fl();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&i.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),i.push(oh(e,s,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(Gs.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));i.push(t)}return ri.waitFor(i).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=a,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(cs(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?cs(r.hu,14607):e.removedDocuments.size>0&&(cs(r.hu,42227),r.hu=!1))}),await td(n,e,t)}catch(e){await ni(e)}}function Wf(e,t,n){const r=us(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const a=r.view.va(t);a.snapshot&&e.push(a.snapshot)}),function(e,t){const n=us(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const a of n.Sa)a.va(t)&&(r=!0)}),r&&xf(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function qf(e,t,n){const r=us(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Au.get(t),s=a&&a.key;if(s){let e=new Vi(Ls.comparator);e=e.insert(s,Lo.newNoDocument(s,Gs.min()));const n=Fl().add(s),a=new Pc(Gs.min(),new Map,new Vi(ks),e,n);await Hf(r,a),r.du=r.du.remove(s),r.Au.delete(t),ed(r)}else await uh(r.localStore,t,!1).then(()=>Xf(r,t,n)).catch(ni)}async function $f(e,t){const n=us(e),r=t.batch.batchId;try{const e=await function(e,t){const n=us(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,s=a.keys();let i=ri.resolve();return s.forEach(e=>{i=i.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);cs(null!==s,48541),t.version.compareTo(s)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),i.next(()=>e.mutationQueue.removeMutationBatch(t,a))}(n,e,t,a).next(()=>a.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Fl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Qf(n,r,null),Kf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await td(n,e)}catch(e){await ni(e)}}async function Gf(e,t,n){const r=us(e);try{const e=await function(e,t){const n=us(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(cs(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Qf(r,t,n),Kf(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await td(r,e)}catch(n){await ni(n)}}function Kf(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Qf(e,t,n){const r=us(e);let a=r.Vu[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.Vu[r.currentUser.toKey()]=a}}function Xf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Yf(e,t)})}function Yf(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Vh(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),ed(e))}function Jf(e,t,n){for(const r of n)r instanceof If?(e.Ru.addReference(r.key,t),Zf(e,r)):r instanceof Rf?(rs(Pf,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Yf(e,r.key)):os(19791,{wu:r})}function Zf(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(rs(Pf,"New document in limbo: "+n),e.Eu.add(r),ed(e))}function ed(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Ls(Os.fromString(t)),r=e.fu.next();e.Au.set(r,new Lf(n)),e.du=e.du.insert(n,r),zh(e.remoteStore,new wu(ml(hl(n.path)),r,"TargetPurposeLimboResolution",ii.ce))}}async function td(e,t,n){const r=us(e),a=[],s=[],i=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{i.push(r.pu(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(o.targetId)?.current;r.sharedClientState.updateQueryState(o.targetId,t?"current":"not-current")}if(e){a.push(e);const t=Zu.As(o.targetId,e);s.push(t)}}))}),await Promise.all(i),r.Pu.H_(a),await async function(e,t){const n=us(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>ri.forEach(t,t=>ri.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>ri.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!si(e))throw e;rs(nh,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,a)}}}(r.localStore,s))}async function nd(e,t){const n=us(e);if(!n.currentUser.isEqual(t)){rs(Pf,"User change. New user:",t.toKey());const e=await sh(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new fs(hs.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await td(n,e.Ls)}}function rd(e,t){const n=us(e),r=n.Au.get(t);if(r&&r.hu)return Fl().add(r.key);{let e=Fl();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function ad(e){const t=us(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Hf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=rd.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=qf.bind(null,t),t.Pu.H_=kf.bind(null,t.eventManager),t.Pu.yu=_f.bind(null,t.eventManager),t}function sd(e){const t=us(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=$f.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Gf.bind(null,t),t}class id{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ch(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ah(this.persistence,new th,e.initialUser,this.serializer)}Cu(e){return new Qu(Yu.mi,this.serializer)}Du(e){return new ph}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}id.provider={build:()=>new id};class od extends id{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){cs(this.persistence.referenceDelegate instanceof Ju,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Du(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Au.withCacheSize(this.cacheSizeBytes):Au.DEFAULT;return new Qu(e=>Ju.mi(e,t),this.serializer)}}class ld{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Wf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=nd.bind(null,this.syncEngine),await hf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new wf}createDatastore(e){const t=Ch(e.databaseInfo.databaseId),n=function(e){return new _h(e)}(e.databaseInfo);return function(e,t,n,r){return new Dh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new Fh(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,e=>Wf(this.syncEngine,e,0),vh.v()?new vh:new mh)}createSyncEngine(e,t){return function(e,t,n,r,a,s,i){const o=new Mf(e,t,n,r,a,s);return i&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=us(e);rs(Mh,"RemoteStore shutting down."),t.Ea.add(5),await jh(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ld.provider={build:()=>new ld};class cd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):as("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const ud="FirestoreClient";class hd{constructor(e,t,n,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Za.UNAUTHENTICATED,this.clientId=Ss.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async e=>{rs(ud,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(rs(ud,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=mf(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function fd(e,t){e.asyncQueue.verifyOperationInProgress(),rs(ud,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await sh(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function dd(e,t){e.asyncQueue.verifyOperationInProgress();const n=await pd(e);rs(ud,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>uf(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>uf(t.remoteStore,n)),e._onlineComponents=t}async function pd(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){rs(ud,"Using user provided OfflineComponentProvider");try{await fd(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===hs.FAILED_PRECONDITION||e.code===hs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;ss("Error using user provided cache. Falling back to memory cache: "+n),await fd(e,new id)}}else rs(ud,"Using default OfflineComponentProvider"),await fd(e,new od(void 0));return e._offlineComponents}async function md(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(rs(ud,"Using user provided OnlineComponentProvider"),await dd(e,e._uninitializedComponentsProvider._online)):(rs(ud,"Using default OnlineComponentProvider"),await dd(e,new ld))),e._onlineComponents}function gd(e){return md(e).then(e=>e.syncEngine)}async function vd(e){const t=await md(e),n=t.eventManager;return n.onListen=Ff.bind(null,t.syncEngine),n.onUnlisten=Vf.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Uf.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Bf.bind(null,t.syncEngine),n}function yd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ds;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const s=new cd({next:o=>{s.Nu(),t.enqueueAndForget(()=>Sf(e,i));const l=o.docs.has(n);!l&&o.fromCache?a.reject(new fs(hs.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?a.reject(new fs(hs.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(o)},error:e=>a.reject(e)}),i=new Nf(hl(n.path),s,{includeMetadataChanges:!0,qa:!0});return Ef(e,i)}(await vd(e),e.asyncQueue,t,n,r)),r.promise}function bd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new ds;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,a){const s=new cd({next:n=>{s.Nu(),t.enqueueAndForget(()=>Sf(e,i)),n.fromCache&&"server"===r.source?a.reject(new fs(hs.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),i=new Nf(n,s,{includeMetadataChanges:!0,qa:!0});return Ef(e,i)}(await vd(e),e.asyncQueue,t,n,r)),r.promise}function wd(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Td=new Map,Ed="firestore.googleapis.com",Sd=!0;class kd{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new fs(hs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ed,this.ssl=Sd}else this.host=e.host,this.ssl=e.ssl??Sd;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Cu;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Ru)throw new fs(hs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new fs(hs.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wd(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new fs(hs.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new fs(hs.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new fs(hs.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _d{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fs(hs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new fs(hs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kd(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ms;switch(e.type){case"firstParty":return new bs(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new fs(hs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Td.get(e);t&&(rs("ComponentProvider","Removing Datastore"),Td.delete(e),t.terminate())}(this),Promise.resolve()}}function xd(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Vs(e,_d);const a=g(t),s=e._getSettings(),i={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${n}`;a&&(v(`https://${o}`),w("Firestore",!0)),s.host!==Ed&&s.host!==o&&ss("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:o,ssl:a,emulatorOptions:r};if(!A(c,i)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Za.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...e};return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")}(r.mockUserToken,e._app?.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new fs(hs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Za(a)}e._authCredentials=new gs(new ps(t,n))}}class Cd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cd(this.firestore,e,this._query)}}class Ad{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ad(this.firestore,e,this._key)}toJSON(){return{type:Ad._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Hs(t,Ad._jsonSchema))return new Ad(e,n||null,new Ls(Os.fromString(t.referencePath)))}}Ad._jsonSchemaVersion="firestore/documentReference/1.0",Ad._jsonSchema={type:Bs("string",Ad._jsonSchemaVersion),referencePath:Bs("string")};class Nd extends Cd{constructor(e,t,n){super(e,t,hl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ad(this.firestore,null,new Ls(e))}withConverter(e){return new Nd(this.firestore,e,this._path)}}function Id(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=L(e),Ms("collection","path",t),e instanceof _d){const n=Os.fromString(t,...r);return Us(n),new Nd(e,null,n)}{if(!(e instanceof Ad||e instanceof Nd))throw new fs(hs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Os.fromString(t,...r));return Us(n),new Nd(e.firestore,null,n)}}function Rd(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=L(e),1===arguments.length&&(t=Ss.newId()),Ms("doc","path",t),e instanceof _d){const n=Os.fromString(t,...r);return Fs(n),new Ad(e,null,new Ls(n))}{if(!(e instanceof Ad||e instanceof Nd))throw new fs(hs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Os.fromString(t,...r));return Fs(n),new Ad(e.firestore,e instanceof Nd?e.converter:null,new Ls(n))}}const Od="AsyncQueue";class Pd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ah(this,"async_queue_retry"),this._c=()=>{const e=xh();e&&rs(Od,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=xh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=xh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new ds;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!si(e))throw e;rs(Od,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,as("INTERNAL UNHANDLED ERROR: ",Dd(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=pf.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&os(47125,{Pc:Dd(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Dd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Ld(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Md extends _d{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Pd,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Pd(e),this._firestoreClient=void 0,await e}}}function Fd(e){if(e._terminated)throw new fs(hs.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Ud(e),e._firestoreClient}function Ud(e){const t=e._freezeSettings(),n=function(e,t,n,r){return new io(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,wd(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new hd(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){const t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}class jd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jd(Ki.fromBase64String(e))}catch(e){throw new fs(hs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new jd(Ki.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jd._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hs(e,jd._jsonSchema))return jd.fromBase64String(e.bytes)}}jd._jsonSchemaVersion="firestore/bytes/1.0",jd._jsonSchema={type:Bs("string",jd._jsonSchemaVersion),bytes:Bs("string")};class zd{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new fs(hs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ds(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Vd{constructor(e){this._methodName=e}}class Bd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fs(hs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fs(hs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ks(this._lat,e._lat)||ks(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bd._jsonSchemaVersion}}static fromJSON(e){if(Hs(e,Bd._jsonSchema))return new Bd(e.latitude,e.longitude)}}Bd._jsonSchemaVersion="firestore/geoPoint/1.0",Bd._jsonSchema={type:Bs("string",Bd._jsonSchemaVersion),latitude:Bs("number"),longitude:Bs("number")};class Hd{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Hd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hs(e,Hd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Hd(e.vectorValues);throw new fs(hs.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Hd._jsonSchemaVersion="firestore/vectorValue/1.0",Hd._jsonSchema={type:Bs("string",Hd._jsonSchemaVersion),vectorValues:Bs("object")};const Wd=/^__.*__$/;class qd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new fc(e,this.data,this.fieldMask,t,this.fieldTransforms):new hc(e,this.data,t,this.fieldTransforms)}}class $d{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new fc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Gd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw os(40011,{Ac:e})}}class Kd{constructor(e,t,n,r,a,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Kd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return up(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Gd(this.Ac)&&Wd.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Qd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ch(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Kd({Ac:e,methodName:t,Dc:n,path:Ds.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xd(e){const t=e._freezeSettings(),n=Ch(e._databaseId);return new Qd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Yd(e,t,n,r,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.Cc(s.merge||s.mergeFields?2:0,t,n,a);ip("Data must be an object, but it was:",i,r);const o=ap(r,i);let l,c;if(s.merge)l=new $i(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const a=op(t,r,n);if(!i.contains(a))throw new fs(hs.INVALID_ARGUMENT,`Field '${a}' is specified in your field mask but missing from your input data.`);hp(e,a)||e.push(a)}l=new $i(e),c=i.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=i.fieldTransforms;return new qd(new Po(o),l,c)}class Jd extends Vd{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jd}}class Zd extends Vd{_toFieldTransform(e){return new tc(e.path,new Gl)}isEqual(e){return e instanceof Zd}}function ep(e,t,n,r){const a=e.Cc(1,t,n);ip("Data must be an object, but it was:",a,r);const s=[],i=Po.empty();ji(r,(e,r)=>{const o=cp(t,e,n);r=L(r);const l=a.yc(o);if(r instanceof Jd)s.push(o);else{const e=rp(r,l);null!=e&&(s.push(o),i.set(o,e))}});const o=new $i(s);return new $d(i,o,a.fieldTransforms)}function tp(e,t,n,r,a,s){const i=e.Cc(1,t,n),o=[op(t,r,n)],l=[a];if(s.length%2!=0)throw new fs(hs.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)o.push(op(t,s[f])),l.push(s[f+1]);const c=[],u=Po.empty();for(let f=o.length-1;f>=0;--f)if(!hp(c,o[f])){const e=o[f];let t=l[f];t=L(t);const n=i.yc(e);if(t instanceof Jd)c.push(e);else{const r=rp(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new $i(c);return new $d(u,h,i.fieldTransforms)}function np(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return rp(n,e.Cc(r?4:3,t))}function rp(e,t){if(sp(e=L(e)))return ip("Unsupported field value:",t,e),ap(e,t);if(e instanceof Vd)return function(e,t){if(!Gd(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=rp(a,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=L(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Bl(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=$s.fromDate(e);return{timestampValue:Gc(t.serializer,n)}}if(e instanceof $s){const n=new $s(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Gc(t.serializer,n)}}if(e instanceof Bd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof jd)return{bytesValue:Kc(t.serializer,e._byteString)};if(e instanceof Ad){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Yc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Hd)return function(e,t){return{mapValue:{fields:{[co]:{stringValue:fo},[po]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return zl(t.serializer,e)})}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${zs(e)}`)}(e,t)}function ap(e,t){const n={};return zi(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ji(e,(e,r)=>{const a=rp(r,t.mc(e));null!=a&&(n[e]=a)}),{mapValue:{fields:n}}}function sp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof $s||e instanceof Bd||e instanceof jd||e instanceof Ad||e instanceof Vd||e instanceof Hd)}function ip(e,t,n){if(!sp(n)||!js(n)){const r=zs(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function op(e,t,n){if((t=L(t))instanceof zd)return t._internalPath;if("string"==typeof t)return cp(e,t);throw up("Field path arguments must be of type string or ",e,!1,void 0,n)}const lp=new RegExp("[~\\*/\\[\\]]");function cp(e,t,n){if(t.search(lp)>=0)throw up(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new zd(...t.split("."))._internalPath}catch(r){throw up(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function up(e,t,n,r,a){const s=r&&!r.isEmpty(),i=void 0!==a;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=` in field ${r}`),i&&(l+=` in document ${a}`),l+=")"),new fs(hs.INVALID_ARGUMENT,o+e+l)}function hp(e,t){return e.some(e=>e.isEqual(t))}class fp{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ad(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new dp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class dp extends fp{data(){return super.data()}}function pp(e,t){return"string"==typeof t?cp(e,t):t instanceof zd?t._internalPath:t._delegate._internalPath}function mp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new fs(hs.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gp{}class vp extends gp{}class yp extends vp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yp(e,t,n)}_apply(e){const t=this._parse(e);return Ep(e._query,t),new Cd(e.firestore,e.converter,vl(e._query,t))}_parse(e){const t=Xd(e.firestore),n=function(e,t,n,r,a,s,i){let o;if(a.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new fs(hs.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Tp(i,s);const t=[];for(const n of i)t.push(wp(r,e,n));o={arrayValue:{values:t}}}else o=wp(r,e,i)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Tp(i,s),o=np(n,t,i,"in"===s||"not-in"===s);return Bo.create(a,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class bp extends gp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new bp(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Ho.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const a of r)Ep(n,a),n=vl(n,a)}(e._query,t),new Cd(e.firestore,e.converter,vl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function wp(e,t,n){if("string"==typeof(n=L(n))){if(""===n)throw new fs(hs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dl(t)&&-1!==n.indexOf("/"))throw new fs(hs.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Os.fromString(n));if(!Ls.isDocumentKey(r))throw new fs(hs.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ko(e,new Ls(r))}if(n instanceof Ad)return ko(e,n._key);throw new fs(hs.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zs(n)}.`)}function Tp(e,t){if(!Array.isArray(e)||0===e.length)throw new fs(hs.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Ep(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new fs(hs.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new fs(hs.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Sp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw os(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ji(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){const t=e.fields?.[po].arrayValue?.values?.map(e=>Yi(e.doubleValue));return new Hd(t)}convertGeoPoint(e){return new Bd(Yi(e.latitude),Yi(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ao(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(so(e));default:return null}}convertTimestamp(e){const t=Xi(e);return new $s(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Os.fromString(e);cs(bu(n),9688,{name:e});const r=new lo(n.get(1),n.get(3)),a=new Ls(n.popFirst(5));return r.isEqual(t)||as(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function kp(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class _p{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xp extends fp{constructor(e,t,n,r,a,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Cp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(pp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fs(hs.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xp._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}xp._jsonSchemaVersion="firestore/documentSnapshot/1.0",xp._jsonSchema={type:Bs("string",xp._jsonSchemaVersion),bundleSource:Bs("string","DocumentSnapshot"),bundleName:Bs("string"),bundle:Bs("string")};class Cp extends xp{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ap{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new _p(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Cp(this._firestore,this._userDataWriter,n.key,n,new _p(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new fs(hs.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Cp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new _p(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Cp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new _p(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,s=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Np(t.type),doc:r,oldIndex:a,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fs(hs.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ap._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ss.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Np(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return os(61501,{type:e})}}function Ip(e){e=Vs(e,Ad);const t=Vs(e.firestore,Md);return yd(Fd(t),e._key).then(n=>jp(t,e,n))}Ap._jsonSchemaVersion="firestore/querySnapshot/1.0",Ap._jsonSchema={type:Bs("string",Ap._jsonSchemaVersion),bundleSource:Bs("string","QuerySnapshot"),bundleName:Bs("string"),bundle:Bs("string")};class Rp extends Sp{constructor(e){super(),this.firestore=e}convertBytes(e){return new jd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ad(this.firestore,null,t)}}function Op(e){e=Vs(e,Cd);const t=Vs(e.firestore,Md),n=Fd(t),r=new Rp(t);return mp(e._query),bd(n,e._query).then(n=>new Ap(t,r,e,n))}function Pp(e,t,n){e=Vs(e,Ad);const r=Vs(e.firestore,Md),a=kp(e.converter,t,n);return Up(r,[Yd(Xd(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,rc.none())])}function Dp(e,t,n){e=Vs(e,Ad);const r=Vs(e.firestore,Md),a=Xd(r);let s;for(var i=arguments.length,o=new Array(i>3?i-3:0),l=3;l<i;l++)o[l-3]=arguments[l];return s="string"==typeof(t=L(t))||t instanceof zd?tp(a,"updateDoc",e._key,t,n,o):ep(a,"updateDoc",e._key,t),Up(r,[s.toMutation(e._key,rc.exists(!0))])}function Lp(e){return Up(Vs(e.firestore,Md),[new gc(e._key,rc.none())])}function Mp(e,t){const n=Vs(e.firestore,Md),r=Rd(e),a=kp(e.converter,t);return Up(n,[Yd(Xd(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,rc.exists(!1))]).then(()=>r)}function Fp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=L(e);let a={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof n[s]||Ld(n[s])||(a=n[s++]);const i={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Ld(n[s])){const e=n[s];n[s]=e.next?.bind(e),n[s+1]=e.error?.bind(e),n[s+2]=e.complete?.bind(e)}let o,l,c;if(e instanceof Ad)l=Vs(e.firestore,Md),c=hl(e._key.path),o={next:t=>{n[s]&&n[s](jp(l,e,t))},error:n[s+1],complete:n[s+2]};else{const t=Vs(e,Cd);l=Vs(t.firestore,Md),c=t._query;const r=new Rp(l);o={next:e=>{n[s]&&n[s](new Ap(l,r,t,e))},error:n[s+1],complete:n[s+2]},mp(e._query)}return function(e,t,n,r){const a=new cd(r),s=new Nf(t,a,n);return e.asyncQueue.enqueueAndForget(async()=>Ef(await vd(e),s)),()=>{a.Nu(),e.asyncQueue.enqueueAndForget(async()=>Sf(await vd(e),s))}}(Fd(l),c,i,o)}function Up(e,t){return function(e,t){const n=new ds;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=sd(e);try{const e=await function(e,t){const n=us(e),r=$s.now(),a=t.reduce((e,t)=>e.add(t.key),Fl());let s,i;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Al(),l=Fl();return n.Ns.getEntries(e,a).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(a=>{s=a;const i=[];for(const e of t){const t=cc(e,s.get(e.key).overlayedDocument);null!=t&&i.push(new fc(e.key,t,Do(t.value.mapValue),rc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,i,t)}).next(t=>{i=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:i.batchId,changes:Rl(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Vi(ks)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await td(r,e.changes),await ef(r.remoteStore)}catch(e){const t=mf(e,"Failed to persist write");n.reject(t)}}(await gd(e),t,n)),n.promise}(Fd(e),t)}function jp(e,t,n){const r=n.docs.get(t._key),a=new Rp(e);return new xp(e,a,t._key,r,new _p(n.hasPendingWrites,n.fromCache),t.converter)}class zp{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xd(e)}set(e,t,n){this._verifyNotCommitted();const r=Vp(e,this._firestore),a=kp(r.converter,t,n),s=Yd(this._dataReader,"WriteBatch.set",r._key,a,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,rc.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Vp(e,this._firestore);let a;for(var s=arguments.length,i=new Array(s>3?s-3:0),o=3;o<s;o++)i[o-3]=arguments[o];return a="string"==typeof(t=L(t))||t instanceof zd?tp(this._dataReader,"WriteBatch.update",r._key,t,n,i):ep(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(a.toMutation(r._key,rc.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Vp(e,this._firestore);return this._mutations=this._mutations.concat(new gc(t._key,rc.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new fs(hs.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Vp(e,t){if((e=L(e)).firestore!==t)throw new fs(hs.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Bp(){return new Zd("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){es=e}(Ye),$e(new M("firestore",(e,n)=>{let{instanceIdentifier:r,options:a}=n;const s=e.getProvider("app").getImmediate(),i=new Md(new vs(e.getProvider("auth-internal")),new Ts(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new fs(hs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lo(e.options.projectId,t)}(s,r),s);return a={useFetchStreams:t,...a},i._setSettings(a),i},"PUBLIC").setMultipleInstances(!0)),et(Ya,Ja,e),et(Ya,Ja,"esm2020")}();const Hp=Je({apiKey:"AIzaSyAlw7wM2vl-x2m8zZ32AxspDqweNHJ9xyc",authDomain:"meem-quiz.firebaseapp.com",projectId:"meem-quiz",storageBucket:"meem-quiz.firebasestorage.app",messagingSenderId:"267888426373",appId:"1:267888426373:web:2a92fafb01c24eca77d8ec",measurementId:"G-ZER23HG01F"}),Wp=function(e,t){const n="object"==typeof e?e:Ze(),r="string"==typeof e?e:t||oo,a=Ge(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const e=(e=>{const t=f(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&xd(a,...e)}return a}(Hp),qp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze();const t=Ge(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Ge(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(A(n.getOptions(),t??{}))return e;gt(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Ia,persistence:[zr,wr,_r]}),r=p("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Da)return;const r=t?.token;La!==r&&(La=r,await fetch(a,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){L(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){L(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var a;const s=f("auth");return s&&Un(n,`http://${s}`),n}(Hp);var $p=n(579);function Gp(e){let{setPage:t}=e;const[n,a]=(0,r.useState)(""),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)("");return(0,$p.jsx)("div",{className:"row justify-content-center",children:(0,$p.jsx)("div",{className:"col-md-8 col-lg-6 col-xl-5",children:(0,$p.jsx)("div",{className:"card mt-5",children:(0,$p.jsxs)("div",{className:"card-body p-4 p-sm-5",children:[(0,$p.jsxs)("div",{className:"text-center",children:[(0,$p.jsx)("h3",{className:"mb-1",children:"Admin Login"}),(0,$p.jsx)("p",{className:"text-muted mb-4",children:"Sign in to manage your quizzes."})]}),(0,$p.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(""),f(""),u(!0);try{await function(e,t,n){return Ke(e.app)?Promise.reject(bt(e)):dr(L(e),Zn.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&mr(e),t})}(qp,n,s)}catch(t){l("Failed to login. Please check your credentials."),console.error(t)}u(!1)},children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Email address"}),(0,$p.jsx)("input",{type:"email",className:"form-control",value:n,onChange:e=>a(e.target.value),required:!0,disabled:c})]}),(0,$p.jsxs)("div",{className:"mb-4",children:[(0,$p.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,$p.jsx)("label",{className:"form-label mb-0",children:"Password"}),(0,$p.jsx)("button",{type:"button",className:"btn btn-link btn-sm p-0",onClick:async()=>{if(n){l(""),f(""),u(!0);try{await async function(e,t,n){const r=xn(e),a={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&pr(r,a,n),await Mn(r,a,"getOobCode",qn,"EMAIL_PASSWORD_PROVIDER")}(qp,n),f("Password reset email sent! Please check your inbox.")}catch(e){l("Failed to send reset email. Please check the email address."),console.error(e)}u(!1)}else l("Please enter your email address to reset your password.")},disabled:c,children:"Forgot Password?"})]}),(0,$p.jsx)("input",{type:"password",className:"form-control",value:s,onChange:e=>i(e.target.value),required:!0,disabled:c})]}),o&&(0,$p.jsx)("div",{className:"alert alert-danger",children:o}),h&&(0,$p.jsx)("div",{className:"alert alert-success",children:h}),(0,$p.jsx)("div",{className:"d-grid",children:(0,$p.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:c,children:c?"Signing In...":"Sign In"})})]})]})})})})}var Kp={version:"0.18.5"},Qp=1200,Xp=1252,Yp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Jp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zp=function(e){-1!=Yp.indexOf(e)&&(Xp=Jp[0]=e)};var em=function(e){Qp=e,Zp(e)};function tm(){em(1200),Zp(1252)}function nm(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function rm(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var am,sm=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?rm(e.slice(2)):65279==t?e.slice(1):e},im=function(e){return String.fromCharCode(e)},om=function(e){return String.fromCharCode(e)};var lm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cm(e){for(var t="",n=0,r=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(n=e.charCodeAt(c++))>>2,i=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=lm.charAt(s)+lm.charAt(i)+lm.charAt(o)+lm.charAt(l);return t}function um(e){var t="",n=0,r=0,a=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=lm.indexOf(e.charAt(l++))<<2|(s=lm.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&s)<<4|(i=lm.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(r)),a=(3&i)<<6|(o=lm.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var hm=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),fm=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function dm(e){return hm?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function pm(e){return hm?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var mm=function(e){return hm?fm(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function gm(e){if("undefined"===typeof ArrayBuffer)return mm(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function vm(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function ym(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ym(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var bm=hm?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:fm(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var wm=/\u0000/g,Tm=/[\u0001-\u0006]/g;function Em(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Sm(e,t){var n=""+e;return n.length>=t?n:Fg("0",t-n.length)+n}function km(e,t){var n=""+e;return n.length>=t?n:Fg(" ",t-n.length)+n}function _m(e,t){var n=""+e;return n.length>=t?n:n+Fg(" ",t-n.length)}var xm=Math.pow(2,32);function Cm(e,t){return e>xm||e<-xm?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Fg("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Fg("0",t-n.length)+n}(Math.round(e),t)}function Am(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Nm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Im=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Rm={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Om={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Pm={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dm(e,t,n){for(var r=e<0?-1:1,a=e*r,s=0,i=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(o=(h=Math.floor(a))*i+s,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!n)return[0,r*o,u];var f=Math.floor(r*o/u);return[f,r*o-f*u,u]}function Lm(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),s=0,i=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)i=n?[1317,10,29]:[1900,2,29],s=3;else if(0===r)i=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Mm=new Date(1899,11,31,0,0,0),Fm=Mm.getTime(),Um=new Date(1900,2,1,0,0,0);function jm(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Um&&(n+=864e5),(n-(Fm+6e4*(e.getTimezoneOffset()-Mm.getTimezoneOffset())))/864e5}function zm(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vm(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=zm(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=zm(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),zm(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Bm(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Vm(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return cg(14,jm(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Hm(e,t,n,r){var a,s="",i=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return Im[n.m-1][1];case 5:return Im[n.m-1][0];default:return Im[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return Nm[n.q][0];default:return Nm[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(i=Math.round(o*(n.S+n.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Sm(i,2+r),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Sm(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Sm(a,c):""}function Wm(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var qm=/%/g;function $m(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+$m(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(n=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(i-n.length+s):n+="E+"+(i-s);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Gm=/# (\?+)( ?)\/( ?)(\d+)/;var Km=/^#*0*\.([0#]+)/,Qm=/\).*[0#]/,Xm=/\(###\) ###\\?-####/;function Ym(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Jm(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Zm(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function eg(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Qm)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?eg("n",r,n):"("+eg("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return rg(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(qm,""),a=t.length-r.length;return rg(e,r,n*Math.pow(10,2*a))+Fg("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return $m(t,n);if(36===t.charCodeAt(0))return"$"+eg(e,t.substr(" "==t.charAt(1)?2:1),n);var a,s,i,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Cm(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Cm(n,0))&&(a=""),a.length>t.length?a:Ym(t.substr(0,t.length-a.length))+a;if(s=t.match(Gm))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),s=Math.floor(a/r),i=a-s*r,o=r;return n+(0===s?"":""+s)+" "+(0===i?Fg(" ",e[1].length+1+e[4].length):km(i,e[1].length)+e[2]+"/"+e[3]+Sm(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+Cm(l,t.length-t.indexOf("0"));if(s=t.match(Km))return a=Jm(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Ym(s[1])).replace(/\.$/,"."+Ym(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Fg("0",Ym(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Jm(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Wm(Cm(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+eg(e,t,-n):Wm(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,s[1].length)))+"."+Sm(Zm(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return eg(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Em(eg(e,t.replace(/[\\-]/g,""),n)),i=0,Em(Em(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(Xm))return"("+(a=eg(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Dm(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=rg("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=_m(o[2],i)).length<s[4].length&&(u=Ym(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=Dm(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?km(o[1],i)+s[2]+"/"+s[3]+_m(o[2],i):Fg(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Cm(n,0),t.length<=a.length?a:Ym(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,f=t.length-a.length-h;return Ym(t.substr(0,h)+a+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Zm(n,s[1].length),n<0?"-"+eg(e,t,-n):Wm(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Sm(0,3-e.length):"")+e})+"."+Sm(i,s[1].length);switch(t){case"###,##0.00":return eg(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var d=Wm(Cm(l,0));return"0"!==d?c+d:"";case"###,###.00":return eg(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return eg(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tg(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+tg(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(n=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(i-n.length+s):n+="E+"+(i-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+s)%a)+"."+r.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function ng(e,t,n){if(40===e.charCodeAt(0)&&!t.match(Qm)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ng("n",r,n):"("+ng("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return rg(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(qm,""),a=t.length-r.length;return rg(e,r,n*Math.pow(10,2*a))+Fg("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return tg(t,n);if(36===t.charCodeAt(0))return"$"+ng(e,t.substr(" "==t.charAt(1)?2:1),n);var a,s,i,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Sm(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:Ym(t.substr(0,t.length-a.length))+a;if(s=t.match(Gm))return function(e,t,n){return n+(0===t?"":""+t)+Fg(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Sm(l,t.length-t.indexOf("0"));if(s=t.match(Km))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+Ym(s[1])).replace(/\.$/,"."+Ym(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Fg("0",Ym(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Wm(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ng(e,t,-n):Wm(""+n)+"."+Fg("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ng(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Em(ng(e,t.replace(/[\\-]/g,""),n)),i=0,Em(Em(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(Xm))return"("+(a=ng(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Dm(l,Math.pow(10,i)-1,!1),a=""+c," "==(u=rg("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],(u=_m(o[2],i)).length<s[4].length&&(u=Ym(s[4].substr(s[4].length-u.length))+u),a+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=Dm(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?km(o[1],i)+s[2]+"/"+s[3]+_m(o[2],i):Fg(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:Ym(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,f=t.length-a.length-h;return Ym(t.substr(0,h)+a+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+ng(e,t,-n):Wm(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Sm(0,3-e.length):"")+e})+"."+Sm(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Wm(""+l);return"0"!==d?c+d:"";default:if(t.match(/\.[0#?]*$/))return ng(e,t.slice(0,t.lastIndexOf(".")),n)+Ym(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rg(e,t,n){return(0|n)===n?ng(e,t,n):eg(e,t,n)}var ag=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function sg(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Am(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(ag))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var ig=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function og(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function lg(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var s=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,s];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var i=n[0].match(ig),o=n[1].match(ig);return og(t,i)?[r,n[0]]:og(t,o)?[r,n[1]]:[r,n[null!=i&&null!=o?2:1]]}return[r,s]}function cg(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Rm)[e])&&(r=n.table&&n.table[Om[e]]||Rm[Om[e]]),null==r&&(r=Pm[e]||"General")}if(Am(r,0))return Bm(t,n);t instanceof Date&&(t=jm(t,n.date1904));var a=lg(r,t);if(Am(a[1]))return Bm(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,s,i,o=[],l="",c=0,u="",h="t",f="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Am(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var d=e.charAt(++c),p="("===d||")"===d?d:"t";o[o.length]={t:p,v:d},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Lm(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Lm(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=f),o[o.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var m={t:u,v:u};if(null==a&&(a=Lm(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?"P":"A"),m.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",c+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,f="h"):(m.t="t",++c),null==a&&"T"===m.t)return"";o[o.length]=m,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(ag)){if(null==a&&null==(a=Lm(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",sg(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=f,h="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Hm(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=Bm(t,n)}var T,E,S="";if(w.length>0){40==w.charCodeAt(0)?(T=t<0&&45===w.charCodeAt(0)?-t:t,E=rg("n",w,T)):(E=rg("n",w,T=t<0&&r>1?-t:t),T<0&&o[0]&&"t"==o[0].t&&(E=E.substr(1),o[0].v="-"+o[0].v)),b=E.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var _=o.length;if(k===o.length&&-1===E.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=E.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=E.substr(0,b+1),b=-1),o[c].t="t",_=c);b>=0&&_<o.length&&(o[_].v=E.substr(0,b+1)+o[_].v)}else if(k!==o.length&&-1===E.indexOf("E")){for(b=E.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,S=o[c].v.substr(s+1);s>=0;--s)b>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(S=E.charAt(b--)+S);o[c].v=S,o[c].t="t",_=c}for(b>=0&&_<o.length&&(o[_].v=E.substr(0,b+1)+o[_].v),b=E.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(s=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,S=o[c].v.substr(0,s);s<o[c].v.length;++s)b<E.length&&(S+=E.charAt(b++));o[c].v=S,o[c].t="t",_=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(T=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=rg(o[c].t,o[c].v,T),o[c].t="t");var x="";for(c=0;c!==o.length;++c)null!=o[c]&&(x+=o[c].v);return x}(a[1],t,n,a[0])}function ug(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Rm[n]){if(Rm[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Rm[t]=e,t}function hg(e){for(var t=0;392!=t;++t)void 0!==e[t]&&ug(e[t],t)}function fg(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Rm=e}var dg={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var mg=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var s=[];for(r=1;16!=r;++r)s[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return s}(t),r=n[0],a=n[1],s=n[2],i=n[3],o=n[4],l=n[5],c=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,a=0,s=e.length;a<s;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=-1^n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^m[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^d[e[w++]]^f[e[w++]]^h[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^i[e[w++]]^s[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=-1^n,a=0,s=e.length,i=0,o=0;a<s;)(i=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^i)]:i<2048?r=(r=r>>>8^t[255&(r^(192|i>>6&31))])>>>8^t[255&(r^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|i>>8&7))])>>>8^t[255&(r^(128|i>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|i>>12&15))])>>>8^t[255&(r^(128|i>>6&63))])>>>8^t[255&(r^(128|63&i))];return~r},e}(),gg=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function s(e){jy(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};if(21589===r)1&(n=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&n&&(i.atime=e.read_shift(4)),4&n&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[r]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=E(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(hm&&Buffer.isBuffer(e)?e.toString("binary"):E(e)).split("\r\n"),a=0,s="";for(a=0;a<r.length;++a)if(s=r[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),n||(n=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),s.slice(0,n.length)!=n););var i=(r[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};f(u);var h,d=0;for(a=0;a<r.length;++a){var p=r[a];p!==o&&p!==o+"--"||(d++&&ce(u,r.slice(h,a),n),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,s,i,o,d=512,p=[],m=e.slice(0,512);jy(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(n=g[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==d&&jy(m=e.slice(0,d),28);var b=e.slice(0,d);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,n);var w=m.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);m.l+=4,s=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),i=m.read_shift(4,"i"),r=m.read_shift(4,"i"),o=m.read_shift(4,"i"),a=m.read_shift(4,"i");for(var T=-1,S=0;S<109&&!((T=m.read_shift(4,"i"))<0);++S)p[S]=T;var k=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,d);c(o,a,k,d,p);var _=function(e,t,n,r){var a=e.length,s=[],i=[],o=[],l=[],c=r-1,u=0,h=0,f=0,d=0;for(u=0;u<a;++u)if(o=[],(f=u+t)>=a&&(f-=a),!i[f]){l=[];var p=[];for(h=f;h>=0;){p[h]=!0,i[h]=!0,o[o.length]=h,l.push(e[h]);var m=n[Math.floor(4*h/r)];if(r<4+(d=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[m])break;if(p[h=Ry(e[m],d)])break}s[f]={nodes:o,data:iy([l])}}return s}(k,s,p,d);_[s].name="!Directory",r>0&&i!==v&&(_[i].name="!MiniFAT"),_[p[0]].name="!FAT",_.fat_addrs=p,_.ssz=d;var x=[],C=[],A=[];!function(e,t,n,r,a,s,i,o){for(var c,f=0,d=r.length?2:0,p=t[e].data,m=0,g=0;m<p.length;m+=128){var y=p.slice(m,m+128);jy(y,64),g=y.read_shift(2),c=ly(y,0,g-d),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(f=b.start,a>0&&f!==v&&(t[f].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:f!==v&&b.start!==v&&t[f]&&(b.content=l(b,t[f].data,(t[o]||{}).data))),b.content&&jy(b.content,0),s[c]=b,i.push(b)}}(s,_,k,x,r,{},C,i),function(e,t,n){for(var r=0,a=0,s=0,i=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,s=e[r].R,i=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==s&&c[s]!==s&&(c[r]=c[s])),-1!==i&&(c[i]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==s&&r!=c[r]&&(c[s]=c[r],u.lastIndexOf(s)<o&&u.push(s));for(r=1;r<l;++r)c[r]===r&&(-1!==s&&c[s]!==s?c[r]=c[s]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(C,A,x),x.shift();var N={FileIndex:C,FullPaths:A};return t&&t.raw&&(N.raw={header:b,sectors:k}),N}function l(e,t,n){for(var r=e.start,a=e.size,s=[],i=r;n&&a>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),a-=g,i=Ry(n,4*i);return 0===s.length?Vy(0):bm(s).slice(0,e.size)}function c(e,t,n,r,a){var s=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=n[e],o=(r>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=Ry(i,4*l))!==v;++l)a.push(s);c(Ry(i,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var s=[],i=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,i.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=Ry(e[u],c)}return{nodes:s,data:iy([i])}}function h(e,t){return new Date(1e3*(Iy(e,t+4)/1e7*Math.pow(2,32)+Iy(e,t)/1e7-11644473600))}function f(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(gg.find(e,"/"+t))return;var n=Vy(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}(e)}function d(e,t){f(e);for(var a=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(i=0;i<e.FullPaths.length;++i)u[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&h.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<h.length;++i){var d=n(h[i][0]);(s=u[d])||(h.push([d,{name:r(d).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[d]=!0)}for(h.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,s=0,i=Math.min(n.length,r.length);a<i;++a){if(s=n[a].length-r[a].length)return s;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<h.length;++i)e.FullPaths[i]=h[i][0],e.FileIndex[i]=h[i][1];for(i=0;i<h.length;++i){var p=e.FileIndex[i],m=e.FullPaths[i];if(p.name=r(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===i)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(c=i+1;c<h.length&&n(e.FullPaths[c])!=m;++c);for(p.C=c>=h.length?-1:c,c=i+1;c<h.length&&n(e.FullPaths[c])!=n(m);++c);p.R=c>=h.length?-1:c,p.type=1}else n(e.FullPaths[i+1]||"")==n(m)&&(p.R=i+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,u=hm&&Buffer.isBuffer(c)?c.toString("binary"):E(c),h=0,f=Math.min(1024,u.length),d=0,p=0;p<=f;++p)(d=u.charCodeAt(p))>=32&&d<128&&++h;var m=h>=4*f/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+ie(o,i)),a.push(""),a.push(m?le(u):oe(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(d(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],s=[],i=Vy(1),o=n.compression?8:0,l=0;0;var c=0,u=0,h=0,f=0,d=e.FullPaths[0],p=d,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(d.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=p){var y=h,b=Vy(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),g[f]=mg.buf(m.content,0);var w=m.content;8==o&&(w=S(w)),(i=Vy(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),m.mt?a(i,m.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[f]),i.write_shift(4,8&l?0:w.length),i.write_shift(4,8&l?0:m.content.length),i.write_shift(2,b.length),i.write_shift(2,0),h+=i.length,r.push(i),h+=b.length,r.push(b),h+=w.length,r.push(w),8&l&&((i=Vy(12)).write_shift(-4,g[f]),i.write_shift(4,w.length),i.write_shift(4,m.content.length),h+=i.l,r.push(i)),(i=Vy(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[f]),i.write_shift(4,w.length),i.write_shift(4,m.content.length),i.write_shift(2,b.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,y),v+=i.l,s.push(i),v+=b.length,s.push(b),++f}return i=Vy(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,f),i.write_shift(2,f),i.write_shift(4,v),i.write_shift(4,h),i.write_shift(2,0),bm([bm(r),bm(s),i])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:n+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+i+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,o,i,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),s=Vy(r[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,b[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,r[2]),s.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),s.write_shift(4,r[3]),s.write_shift(-4,r[1]?r[0]-1:v),s.write_shift(4,r[1]),i=0;i<109;++i)s.write_shift(-4,i<r[2]?r[1]+i:-1);if(r[1])for(o=0;o<r[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<r[2]?r[1]+i:-1);s.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,v))};for(o=i=0,o+=r[1];i<o;++i)s.write_shift(-4,T.DIFSECT);for(o+=r[2];i<o;++i)s.write_shift(-4,T.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&s.l;)s.write_shift(-4,T.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=o,l(u+63>>6)));for(;511&s.l;)s.write_shift(-4,T.ENDOFCHAIN);for(i=0;i<r[4]<<2;++i){var f=e.FullPaths[i];if(f&&0!==f.length){h=e.FileIndex[i],0===i&&(h.start=h.size?h.start-1:v);var p=0===i&&n.root||h.name;if(u=2*(p.length+1),s.write_shift(64,p,"utf16le"),s.write_shift(2,u),s.write_shift(1,h.type),s.write_shift(1,h.color),s.write_shift(-4,h.L),s.write_shift(-4,h.R),s.write_shift(-4,h.C),h.clsid)s.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,h.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,h.start),s.write_shift(4,h.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((h=e.FileIndex[i]).size>=4096)if(s.l=h.start+1<<9,hm&&Buffer.isBuffer(h.content))h.content.copy(s,s.l,0,h.size),s.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)s.write_shift(1,h.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((h=e.FileIndex[i]).size>0&&h.size<4096)if(hm&&Buffer.isBuffer(h.content))h.content.copy(s,s.l,0,h.size),s.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)s.write_shift(1,h.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(hm)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var m,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",T={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function E(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function S(e){return m?m.deflateRawSync(e):K(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!==typeof Uint8Array,N=A?new Uint8Array(256):[],I=0;I<256;++I)N[I]=C(I);function R(e,t){var n=N[255&e];return t<=8?n>>>8-t:(n=n<<8|N[e>>8&255],t<=16?n>>>16-t:(n=n<<8|N[e>>16&255])>>>24-t)}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function L(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function M(e,t,n){var r=7&t,a=t>>>3,s=(1<<n)-1,i=e[a]>>>r;return n<8-r?i&s:(i|=e[a+1]<<8-r,n<16-r?i&s:(i|=e[a+2]<<16-r,n<24-r?i&s:(i|=e[a+3]<<24-r)&s))}function F(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function U(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function j(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function z(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function V(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(hm){var s=pm(r);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(A){var i=new Uint8Array(r);if(i.set)i.set(e);else for(;a<n;++a)i[a]=e[a];return i}return e.length=r,e}function B(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function H(e,t,n){var r=1,a=0,s=0,i=0,o=0,l=e.length,c=A?new Uint16Array(32):B(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<n;++s)e[s]=0;l=e.length;var u=A?new Uint16Array(l):B(l);for(s=0;s<l;++s)c[a=e[s]]++,r<a&&(r=a),u[s]=0;for(c[0]=0,s=1;s<=r;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(u[s]=c[o+16]++);var h=0;for(s=0;s<l;++s)if(0!=(h=e[s]))for(o=R(u[s],r)>>r-h,i=(1<<r+4-h)-1;i>=0;--i)t[o|i<<h]=15&h|s<<4;return r}var W=A?new Uint16Array(512):B(512),q=A?new Uint16Array(32):B(32);if(!A){for(var $=0;$<512;++$)W[$]=0;for($=0;$<32;++$)q[$]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,q,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);H(n,W,288)}();var G=function(){for(var e=A?new Uint8Array(32768):[],t=0,n=0;t<x.length-1;++t)for(;n<x[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=A?new Uint8Array(259):[];for(t=0,n=0;t<_.length-1;++t)for(;n<_[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,s=0,i=A?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=F(n,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[s++];a=8*n.l}else{a=F(n,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],u=-1,h=0;if((u=i[l=32767&(l<<5^c)])&&((u|=-32768&s)>s&&(u-=32768),u<s))for(;t[u+h]==t[s+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?a=j(n,a,N[c+1]>>1)-1:(j(n,a,3),j(n,a+=5,N[c-23]>>5),a+=3);var f=c<8?0:c-4>>2;f>0&&(z(n,a,h-_[c]),a+=f),c=e[s-u],a=j(n,a,N[c]>>3),a-=3;var d=c<4?0:c-2>>1;d>0&&(z(n,a,s-u-x[c]),a+=d);for(var p=0;p<h;++p)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=h-1}else c<=143?c+=48:a=U(n,a,1),a=j(n,a,N[c]),i[l]=32767&s,++s}a=j(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function K(e){var t=Vy(50+Math.floor(1.1*e.length)),n=G(e,t);return t.slice(0,n)}var Q=A?new Uint16Array(32768):B(32768),X=A?new Uint16Array(32768):B(32768),Y=A?new Uint16Array(128):B(128),J=1,Z=1;function ee(e,t){var n=D(e,t)+257,r=D(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var s=0,i=A?new Uint8Array(19):B(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):B(8),u=A?new Uint8Array(8):B(8),h=i.length,f=0;f<a;++f)i[k[f]]=s=P(e,t),l<s&&(l=s),c[s]++,t+=3;var d=0;for(c[0]=0,f=1;f<=l;++f)u[f]=d=d+c[f-1]<<1;for(f=0;f<h;++f)0!=(d=i[f])&&(o[f]=u[d]++);var p=0;for(f=0;f<h;++f)if(0!=(p=i[f])){d=N[o[f]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)Y[d|m<<p]=7&p|f<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(d=Y[L(e,t)]),d>>>=3){case 16:for(s=3+O(e,t),t+=2,d=g[g.length-1];s-- >0;)g.push(d);break;case 17:for(s=3+P(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+L(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(d),l<d&&(l=d)}var v=g.slice(0,n),y=g.slice(n);for(f=n;f<286;++f)v[f]=0;for(f=r;f<30;++f)y[f]=0;return J=H(v,Q,286),Z=H(y,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[dm(t),2];for(var n=0,r=0,a=pm(t||1<<18),s=0,i=a.length>>>0,o=0,l=0;0==(1&r);)if(r=P(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=J,l=Z);;){!t&&i<s+32767&&(i=(a=V(a,s+32767)).length);var c=M(e,n,o),u=r>>>1==1?W[c]:Q[c];if(n+=15&u,0===((u>>>=4)>>>8&255))a[s++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var f=s+_[u];h>0&&(f+=M(e,n,h),n+=h),c=M(e,n,l),n+=15&(u=r>>>1==1?q[c]:X[c]);var d=(u>>>=4)<4?0:u-2>>1,p=x[u];for(d>0&&(p+=M(e,n,d),n+=d),!t&&i<f&&(i=(a=V(a,f+100)).length);s<f;)a[s]=a[s-p],++s}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,m>0)for(!t&&i<s+m&&(i=(a=V(a,s+m)).length);m-- >0;)a[s++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,s),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;jy(n,0);var r={FileIndex:[],FullPaths:[]};f(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var i=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<i;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),h=n.read_shift(2),d=n.read_shift(2);n.l+=8;var p=n.read_shift(4),m=s(n.slice(n.l+u,n.l+u+h));n.l+=u+h+d;var g=n.l;n.l=p+4,ae(n,l,c,r,m),n.l=g}return r}function ae(e,t,n,r,a){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,s=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(s-1),r.setDate(a);var i=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(i<<1),r}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),f=e.read_shift(2),d="",p=0;p<h;++p)d+=String.fromCharCode(e[e.l++]);if(f){var g=s(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=f;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var n=new(0,m.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,d,v,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&se[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&se[r[1]]?se[r[1]]:"application/octet-stream"}function oe(e){for(var t=cm(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var s=r[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":r=mm(um(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return mm(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});i&&(u.ctype=i)}function ue(e,t,n,a){var s=a&&a.unsafe;s||f(e);var i=!s&&gg.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:r(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||gg.utils.cfb_gc(e)}return i.content=n,i.size=n?n.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?n.indexOf(s):r.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Tm);for(s=s.replace(wm,""),o&&(s=s.replace(Tm,"!")),i=0;i<n.length;++i){if((o?n[i].replace(Tm,"!"):n[i]).replace(wm,"")==s)return e.FileIndex[i];if((o?r[i].replace(Tm,"!"):r[i]).replace(wm,"")==s)return e.FileIndex[i]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||hm&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return i(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(mm(um(t)),n);case"binary":return o(mm(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return i(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:E(r);case"base64":return cm("string"==typeof r?r:E(r));case"buffer":if(hm)return Buffer.isBuffer(r)?r:fm(r);case"array":return"string"==typeof r?mm(r):r}return r},t.writeFile=function(t,n,r){i();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:ue,cfb_del:function(e,t){f(e);var n=gg.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){f(e);var a=gg.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=r(n),e.FullPaths[s]=n,!0;return!1},cfb_gc:function(e){d(e,!0)},ReadShift:Py,CheckField:Uy,prep_blob:jy,bconcat:bm,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:K,_inflateRaw:te,consts:T},t}();let vg;function yg(e){return"string"===typeof e?gm(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function bg(e,t,n){if("undefined"!==typeof vg&&vg.writeFileSync)return n?vg.writeFileSync(e,t,n):vg.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=gm(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?kv(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var a=new Blob([yg(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=vm(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function wg(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Tg(e,t){for(var n=[],r=wg(e),a=0;a!==r.length;++a)null==n[e[r[a]][t]]&&(n[e[r[a]][t]]=r[a]);return n}function Eg(e){for(var t=[],n=wg(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Sg(e){for(var t=[],n=wg(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var kg=new Date(1899,11,30,0,0,0);function _g(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(kg.getTime()+6e4*(e.getTimezoneOffset()-kg.getTimezoneOffset())))/864e5}var xg=new Date,Cg=kg.getTime()+6e4*(xg.getTimezoneOffset()-kg.getTimezoneOffset()),Ag=xg.getTimezoneOffset();function Ng(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Cg),t.getTimezoneOffset()!==Ag&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Ag)),t}function Ig(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(n=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(a[s],10)}return t}var Rg=new Date("2017-02-19T19:06:09.000Z"),Og=isNaN(Rg.getFullYear())?new Date("2/19/17"):Rg,Pg=2017==Og.getFullYear();function Dg(e,t){var n=new Date(e);if(Pg)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==Og.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function Lg(e,t){if(hm&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return kv(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return kv(rm(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return kv(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return kv(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(s){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Mg(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Mg(e[n]));return t}function Fg(e,t){for(var n="";n.length<t;)n+=e;return n}function Ug(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var jg=["january","february","march","april","may","june","july","august","september","october","november","december"];function zg(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==jg.indexOf(i))return n}else if(i.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||s>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var Vg=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var a=t.split(n),s=[a[0]],i=1;i<a.length;++i)s.push(r),s.push(a[i]);return s}}();function Bg(e){return e?e.content&&e.type?Lg(e.content,!0):e.data?sm(e.data):e.asNodeBuffer&&hm?sm(e.asNodeBuffer().toString("binary")):e.asBinary?sm(e.asBinary()):e._data&&e._data.getContent?sm(Lg(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Hg(e){if(!e)return null;if(e.data)return nm(e.data);if(e.asNodeBuffer&&hm)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?nm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Wg(e,t){for(var n=e.FullPaths||wg(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var i=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==i||a==i)return e.files?e.files[n[s]]:e.FileIndex[s]}return null}function qg(e,t){var n=Wg(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function $g(e,t,n){if(!n)return(r=qg(e,t))&&".bin"===r.name.slice(-4)?Hg(r):Bg(r);var r;if(!t)return null;try{return $g(e,t)}catch(a){return null}}function Gg(e,t,n){if(!n)return Bg(qg(e,t));if(!t)return null;try{return Gg(e,t)}catch(r){return null}}function Kg(e,t,n){if(!n)return Hg(qg(e,t));if(!t)return null;try{return Kg(e,t)}catch(r){return null}}function Qg(e){for(var t=e.FullPaths||wg(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function Xg(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=hm?fm(n):function(e){for(var t=[],n=0,r=e.length+250,a=dm(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[n++]=i;else if(i<2048)a[n++]=192|i>>6&31,a[n++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[n++]=240|i>>8&7,a[n++]=128|i>>2&63,a[n++]=128|o>>6&15|(3&i)<<4,a[n++]=128|63&o}else a[n++]=224|i>>12&15,a[n++]=128|i>>6&63,a[n++]=128|63&i;n>r&&(t.push(a.slice(0,n)),n=0,a=dm(65535),r=65530)}return t.push(a.slice(0,n)),bm(t)}(n),gg.utils.cfb_add(e,t,r);gg.utils.cfb_add(e,t,n)}else e.file(t,n)}function Yg(){return gg.utils.cfb_new()}function Jg(e,t){switch(t.type){case"base64":return gg.read(e,{type:"base64"});case"binary":return gg.read(e,{type:"binary"});case"buffer":case"array":return gg.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Zg(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var a=r.shift();".."===a?n.pop():"."!==a&&n.push(a)}return n.join("/")}var ev='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',tv=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,nv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,rv=ev.match(nv)?nv:/<[^>]*>/g,av=/<\w*:/,sv=/<(\/?)\w+:/;function iv(e,t,n){for(var r={},a=0,s=0;a!==e.length&&(32!==(s=e.charCodeAt(a))&&10!==s&&13!==s);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var i=e.match(tv),o=0,l="",c=0,u="",h="",f=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],s=0;s!=h.length&&61!==h.charCodeAt(s);++s);for(u=h.slice(0,s).trim();32==h.charCodeAt(s+1);)++s;for(f=34==(a=h.charCodeAt(s+1))||39==a?1:0,l=h.slice(s+1+f,h.length-f),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,n||(r[u.toLowerCase()]=l);else{var d=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[d]&&"ext"==u.slice(o-3,o))continue;r[d]=l,n||(r[d.toLowerCase()]=l)}}return r}function ov(e){return e.replace(sv,"<$1")}var lv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cv=Eg(lv),uv=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var a=r+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,function(e,t){return lv[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=a.indexOf("]]>");return n(a.slice(0,s))+a.slice(s+9,i)+n(a.slice(i+3))}}(),hv=/[&<>'"]/g,fv=/[\u0000-\u0008\u000b-\u001f]/g;function dv(e){return(e+"").replace(hv,function(e){return cv[e]}).replace(fv,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function pv(e){return dv(e).replace(/ /g,"_x0020_")}var mv=/[\u0000-\u001f]/g;function gv(e){return(e+"").replace(hv,function(e){return cv[e]}).replace(/\n/g,"<br/>").replace(mv,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var vv=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function yv(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bv(e){for(var t="",n=0,r=0,a=0,s=0,i=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(i=(31&r)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&s):(o=((7&r)<<18|(63&a)<<12|(63&s)<<6|63&(i=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function wv(e){var t,n,r,a=dm(2*e.length),s=1,i=0,o=0;for(n=0;n<e.length;n+=s)s=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),s=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),s=3):(s=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function Tv(e){return fm(e,"binary").toString("utf8")}var Ev="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Sv=hm&&(Tv(Ev)==bv(Ev)&&Tv||wv(Ev)==bv(Ev)&&wv)||bv,kv=hm?function(e){return fm(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},_v=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),xv=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),Cv=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Av=/<\/?(?:vt:)?variant>/g,Nv=/<(?:vt:)([^>]*)>([\s\S]*)</;function Iv(e,t){var n=iv(e),r=e.match(Cv(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(e){var t=e.replace(Av,"").match(Nv);t&&a.push({v:Sv(t[2]),t:t[1]})}),a}var Rv=/(^\s|\s$|\n)/;function Ov(e,t){return"<"+e+(t.match(Rv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Pv(e){return wg(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Dv(e,t,n){return"<"+e+(null!=n?Pv(n):"")+(null!=t?(t.match(Rv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Lv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function Mv(e){if(hm&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Sv(vm(ym(e)));throw new Error("Bad input format: expected Buffer or string")}var Fv=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Uv="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",jv="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",zv="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Vv="http://schemas.openxmlformats.org/package/2006/content-types",Bv="http://schemas.openxmlformats.org/package/2006/relationships",Hv="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Wv="http://purl.org/dc/elements/1.1/",qv="http://purl.org/dc/terms/",$v="http://purl.org/dc/dcmitype/",Gv="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Kv="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Qv="http://www.w3.org/2001/XMLSchema-instance",Xv="http://www.w3.org/2001/XMLSchema",Yv=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Jv="urn:schemas-microsoft-com:office:office",Zv="urn:schemas-microsoft-com:office:excel",ey="urn:schemas-microsoft-com:office:spreadsheet",ty="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",ny="http://macVmlSchemaUri",ry="urn:schemas-microsoft-com:vml",ay="http://www.w3.org/TR/REC-html40";var sy=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},iy=hm?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:fm(e)})):sy(e)}:sy,oy=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(Ay(e,a)));return r.join("").replace(wm,"")},ly=hm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(wm,""):oy(e,t,n)}:oy,cy=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},uy=hm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):cy(e,t,n)}:cy,hy=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(Cy(e,a)));return r.join("")},fy=hm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):hy(e,t,n)}:hy,dy=function(e,t){var n=Iy(e,t);return n>0?fy(e,t+4,t+4+n-1):""},py=dy,my=function(e,t){var n=Iy(e,t);return n>0?fy(e,t+4,t+4+n-1):""},gy=my,vy=function(e,t){var n=2*Iy(e,t);return n>0?fy(e,t+4,t+4+n-1):""},yy=vy,by=function(e,t){var n=Iy(e,t);return n>0?ly(e,t+4,t+4+n):""},wy=by,Ty=function(e,t){var n=Iy(e,t);return n>0?fy(e,t+4,t+4+n):""},Ey=Ty,Sy=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},ky=Sy,_y=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function xy(){ly=function(e,t,n){return am.utils.decode(1200,e.slice(t,n)).replace(wm,"")},fy=function(e,t,n){return am.utils.decode(65001,e.slice(t,n))},py=function(e,t){var n=Iy(e,t);return n>0?am.utils.decode(Xp,e.slice(t+4,t+4+n-1)):""},gy=function(e,t){var n=Iy(e,t);return n>0?am.utils.decode(Qp,e.slice(t+4,t+4+n-1)):""},yy=function(e,t){var n=2*Iy(e,t);return n>0?am.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},wy=function(e,t){var n=Iy(e,t);return n>0?am.utils.decode(1200,e.slice(t+4,t+4+n)):""},Ey=function(e,t){var n=Iy(e,t);return n>0?am.utils.decode(65001,e.slice(t+4,t+4+n)):""}}hm&&(py=function(e,t){if(!Buffer.isBuffer(e))return dy(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},gy=function(e,t){if(!Buffer.isBuffer(e))return my(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},yy=function(e,t){if(!Buffer.isBuffer(e))return vy(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},wy=function(e,t){if(!Buffer.isBuffer(e))return by(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Ey=function(e,t){if(!Buffer.isBuffer(e))return Ty(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},ky=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Sy(e,t)},_y=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof am&&xy();var Cy=function(e,t){return e[t]},Ay=function(e,t){return 256*e[t+1]+e[t]},Ny=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},Iy=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ry=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Oy=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Py(e,t){var n,r,a,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,hm&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Ay(this,o)),o+=2;e*=2;break;case"utf8":l=fy(this,this.l,this.l+e);break;case"utf16le":e*=2,l=ly(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof am)return Py.call(this,e,"dbcs");l=am.utils.decode(Qp,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=py(this,this.l),e=4+Iy(this,this.l);break;case"lpstr-cp":l=gy(this,this.l),e=4+Iy(this,this.l);break;case"lpwstr":l=yy(this,this.l),e=4+2*Iy(this,this.l);break;case"lpp4":e=4+Iy(this,this.l),l=wy(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Iy(this,this.l),l=Ey(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Cy(this,this.l+e++));)c.push(im(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Ay(this,this.l+e));)c.push(im(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Cy(this,o),this.l=o+1,s=Py.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(im(Ay(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof am){l=am.utils.decode(Qp,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=Cy(this,o),this.l=o+1,s=Py.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(im(Cy(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=Cy(this,this.l),this.l++,n;case 2:return n=("i"===t?Ny:Ay)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?Ry:Oy)(this,this.l),this.l+=4,n):(r=Iy(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?ky(this,this.l):ky([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=uy(this,this.l,e)}}return this.l+=e,l}var Dy=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},Ly=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},My=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function Fy(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)My(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof am&&874==Xp)for(a=0;a!=t.length;++a){var s=am.utils.encode(Xp,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Dy(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=r?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[n+o]=255&s;e[n+6]=(15&a)<<4|15&s,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Ly(this,t,this.l)}}return this.l+=r,this}function Uy(e,t){var n=uy(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function jy(e,t){e.l=t,e.read_shift=Py,e.chk=Uy,e.write_shift=Fy}function zy(e,t){e.l+=t}function Vy(e){var t=dm(e);return jy(t,0),t}function By(e,t,n){if(e){var r,a,s;jy(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=X_[o]||X_[65535];for(s=127&(r=e.read_shift(1)),a=1;a<4&&128&r;++a)s+=(127&(r=e.read_shift(1)))<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,n);if(e.l=l,t(u,c,o))return}}}function Hy(){var e=[],t=hm?256:2048,n=function(e){var t=Vy(e);return jy(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},s=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(r=e).l&&(r.l=r.length),s(t)},end:function(){return a(),bm(e)},_bufs:e}}function Wy(e,t,n,r){var a,s=+t;if(!isNaN(s)){r||(r=X_[s].p||(n||[]).length||0),a=1+(s>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,128+(127&s)),i.write_shift(1,s>>7));for(var o=0;4!=o;++o){if(!(r>=128)){i.write_shift(1,r);break}i.write_shift(1,128+(127&r)),r>>=7}r>0&&_y(n)&&e.push(n)}}function qy(e,t,n){var r=Mg(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function $y(e,t,n){var r=Mg(e);return r.s=qy(r.s,t.s,n),r.e=qy(r.e,t.s,n),r}function Gy(e,t){if(e.cRel&&e.c<0)for(e=Mg(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Mg(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=eb(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function Ky(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Gy(e.s,t.biff)+":"+Gy(e.e,t.biff):(e.s.rRel?"":"$")+Xy(e.s.r)+":"+(e.e.rRel?"":"$")+Xy(e.e.r):(e.s.cRel?"":"$")+Jy(e.s.c)+":"+(e.e.cRel?"":"$")+Jy(e.e.c)}function Qy(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Xy(e){return""+(e+1)}function Yy(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Jy(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Zy(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function eb(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function tb(e){var t=e.indexOf(":");return-1==t?{s:Zy(e),e:Zy(e)}:{s:Zy(e.slice(0,t)),e:Zy(e.slice(t+1))}}function nb(e,t){return"undefined"===typeof t||"number"===typeof t?nb(e.s,e.e):("string"!==typeof e&&(e=eb(e)),"string"!==typeof t&&(t=eb(t)),e==t?e:e+":"+t)}function rb(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,s=e.length;for(n=0;r<s&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<s&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=s&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function ab(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=cg(e.z,n?_g(t):t)}catch(r){}try{return e.w=cg((e.XF||{}).numFmtId||(n?14:0),n?_g(t):t)}catch(r){return""+t}}function sb(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?Wb[e.v]||e.v:ab(e,void 0==t?e.v:t))}function ib(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function ob(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var s=e||(a?[]:{}),i=0,o=0;if(s&&null!=r.origin){if("number"==typeof r.origin)i=r.origin;else{var l="string"==typeof r.origin?Zy(r.origin):r.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=rb(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==i&&(c.e.r=i=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if("undefined"!==typeof t[h][f]){var d={v:t[h][f]},p=i+h,m=o+f;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[h][f]||"object"!==typeof t[h][f]||Array.isArray(t[h][f])||t[h][f]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(r.nullError)d.t="e",d.v=0;else{if(!r.sheetStubs)continue;d.t="z"}else"number"===typeof d.v?d.t="n":"boolean"===typeof d.v?d.t="b":d.v instanceof Date?(d.z=r.dateNF||Rm[14],r.cellDates?(d.t="d",d.w=cg(d.z,_g(d.v))):(d.t="n",d.v=_g(d.v),d.w=cg(d.z,d.v))):d.t="s";else d=t[h][f];if(a)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(d.z=s[p][m].z),s[p][m]=d;else{var g=eb({c:m,r:p});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return c.s.c<1e7&&(s["!ref"]=nb(c)),s}function lb(e,t){return ob(null,e,t)}function cb(e,t){return t||(t=Vy(4)),t.write_shift(4,e),t}function ub(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function hb(e,t){var n=!1;return null==t&&(n=!0,t=Vy(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function fb(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function db(e,t){var n=e.l,r=e.read_shift(1),a=ub(e),s=[],i={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(fb(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=n+t,i}var pb=db;function mb(e,t){var n=!1;return null==t&&(n=!0,t=Vy(23+4*e.t.length)),t.write_shift(1,1),hb(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Vy(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function gb(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function vb(e,t){return null==t&&(t=Vy(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function yb(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bb(e,t){return null==t&&(t=Vy(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var wb=ub,Tb=hb;function Eb(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Sb(e,t){var n=!1;return null==t&&(n=!0,t=Vy(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var kb=ub,_b=Eb,xb=Sb;function Cb(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?ky([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Ry(t,0)>>2;return n?a/100:a}function Ab(e,t){null==t&&(t=Vy(4));var n=0,r=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?a:e)<<2)+(n+2))}function Nb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ib=Nb,Rb=function(e,t){return t||(t=Vy(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Ob(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Pb(e,t){return(t||Vy(8)).write_shift(8,e,"f")}function Db(e,t){if(t||(t=Vy(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function Lb(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Mb=80,Fb=[Mb,81],Ub={1:{n:"CodePage",t:2},2:{n:"Category",t:Mb},3:{n:"PresentationFormat",t:Mb},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Mb},15:{n:"Company",t:Mb},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Mb},27:{n:"ContentStatus",t:Mb},28:{n:"Language",t:Mb},29:{n:"Version",t:Mb},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},jb={1:{n:"CodePage",t:2},2:{n:"Title",t:Mb},3:{n:"Subject",t:Mb},4:{n:"Author",t:Mb},5:{n:"Keywords",t:Mb},6:{n:"Comments",t:Mb},7:{n:"Template",t:Mb},8:{n:"LastAuthor",t:Mb},9:{n:"RevNumber",t:Mb},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Mb},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},zb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Vb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Bb(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Hb=Mg(Bb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Wb={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$b={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Gb={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Kb(e,t){var n,r=function(e){for(var t=[],n=wg(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}($b),a=[];a[a.length]=ev,a[a.length]=Dv("Types",null,{xmlns:Vv,"xmlns:xsd":Xv,"xmlns:xsi":Qv}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Dv("Default",null,{Extension:e[0],ContentType:e[1]})}));var s=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=Dv("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:Gb[r][t.bookType]||Gb[r].xlsx}))},i=function(n){(e[n]||[]).forEach(function(e){a[a.length]=Dv("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Gb[n][t.bookType]||Gb[n].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){a[a.length]=Dv("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Qb={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xb(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yb(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(rv)||[]).forEach(function(e){var a=iv(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var i="External"===a.TargetMode?a.Target:Zg(a.Target,t);n[i]=s,r[a.Id]=s}}),n["!id"]=r,n}function Jb(e){var t=[ev,Dv("Relationships",null,{xmlns:Bv})];return wg(e["!id"]).forEach(function(n){t[t.length]=Dv("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Zb(e,t,n,r,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,s?a.TargetMode=s:[Qb.HLINK,Qb.XPATH,Qb.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function ew(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function tw(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function nw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kp.version+"</meta:generator></office:meta></office:document-meta>"}var rw=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],aw=function(){for(var e=new Array(rw.length),t=0;t<rw.length;++t){var n=rw[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function sw(e){var t={};e=Sv(e);for(var n=0;n<rw.length;++n){var r=rw[n],a=e.match(aw[n]);null!=a&&a.length>0&&(t[r[1]]=uv(a[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=Dg(t[r[1]]))}return t}function iw(e,t,n,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=dv(t),r[r.length]=n?Dv(e,t,n):Ov(e,t))}function ow(e,t){var n=t||{},r=[ev,Dv("cp:coreProperties",null,{"xmlns:cp":Uv,"xmlns:dc":Wv,"xmlns:dcterms":qv,"xmlns:dcmitype":$v,"xmlns:xsi":Qv})],a={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&iw("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Lv(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&iw("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Lv(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var s=0;s!=rw.length;++s){var i=rw[s],o=n.Props&&null!=n.Props[i[1]]?n.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&iw(i[0],o,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var lw=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uw(e,t,n,r){var a=[];if("string"==typeof e)a=Iv(e,r);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?Iv(t,r).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=l,n.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=i.slice(o,o+l)}o+=l}}function hw(e){var t=[],n=Dv;return e||(e={}),e.Application="SheetJS",t[t.length]=ev,t[t.length]=Dv("Properties",null,{xmlns:zv,"xmlns:vt":Kv}),lw.forEach(function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=dv(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=n(r[0],a))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+dv(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fw=/<[^>]+>[^<]*/g;function dw(e){var t=[ev,Dv("Properties",null,{xmlns:jv,"xmlns:vt":Kv})];if(!e)return t.join("");var n=1;return wg(e).forEach(function(r){++n,t[t.length]=Dv("property",function(e,t){switch(typeof e){case"string":var n=Dv("vt:lpwstr",dv(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return Dv((0|e)==e?"vt:i4":"vt:r8",dv(String(e)));case"boolean":return Dv("vt:bool",e?"true":"false")}if(e instanceof Date)return Dv("vt:filetime",Lv(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:dv(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var pw,mw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function gw(e,t,n){pw||(pw=Eg(mw)),e[t=pw[t]||t]=n}function vw(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function yw(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function bw(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function ww(e,t,n){return 31===t?bw(e):yw(e,0,n)}function Tw(e,t,n){return ww(e,t,!1===n?0:4)}function Ew(e){var t=e.l,n=_w(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,_w(e,3)]}function Sw(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var s=e.read_shift(4),i=e.read_shift(4);r[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(wm,"").replace(Tm,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function kw(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function _w(e,t,n){var r,a=e.read_shift(2),s=n||{};if(e.l+=2,12!==t&&a!==t&&-1===Fb.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return r=e.read_shift(2,"i"),s.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return yw(e,0,4).replace(wm,"");case 31:return bw(e);case 64:return vw(e);case 65:return kw(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Tw(e,a,!s.raw).replace(wm,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ww(e,t,0)}(e,a).replace(wm,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(Ew(e));return n}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(wm,""),e.l-a&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(wm,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function xw(e,t){var n=Vy(4),r=Vy(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=Vy(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var a=(n*=1e7)/Math.pow(2,32)|0;a>0&&(n%=Math.pow(2,32),r+=a);var s=Vy(8);return s.write_shift(4,n),s.write_shift(4,r),s}(t);break;case 31:case 80:for((r=Vy(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return bm([n,r])}function Cw(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),h=e.read_shift(4);s[i]=[u,h+n]}s.sort(function(e,t){return e[1]-t[1]});var f={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var d=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,d=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],d=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(d=!1,e.l=s[i][1]),d)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(f[p.n]=_w(e,p.t,{raw:!0}),"version"===p.p&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(65535&f[p.n])).slice(-4)),"CodePage"==p.n)switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:em(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(1===s[i][0]){if(o=f.CodePage=_w(e,2),em(o),-1!==l){var m=e.l;e.l=s[l][1],c=Sw(e,o),e.l=m}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=Sw(e,o)}else{var g,v=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=kw(e);break;case 30:case 31:e.l+=4,g=Tw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Dw(e,4);break;case 64:e.l+=4,g=Dg(vw(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=g}}return e.l=n+r,f}var Aw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Nw(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Iw(e,t,n){var r=Vy(8),a=[],s=[],i=8,o=0,l=Vy(8),c=Vy(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){(c=Vy(8)).write_shift(4,0),a.unshift(c);var u=[Vy(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for((l=Vy(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=bm(u),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Aw.indexOf(e[o][0])>-1||cw.indexOf(e[o][0])>-1)&&null!=e[o][1]){var f=e[o][1],d=0;if(t){var p=n[d=+t[e[o][0]]];if("version"==p.p&&"string"==typeof f){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=xw(p.t,f)}else{var g=Nw(f);-1==g&&(g=31,f=String(f)),l=xw(g,f)}s.push(l),(c=Vy(8)).write_shift(4,t?d:2+o),a.push(c),i+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return r.write_shift(4,i),r.write_shift(4,s.length),bm([r].concat(a).concat(s))}function Rw(e,t,n){var r=e.content;if(!r)return{};jy(r,0);var a,s,i,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),u=r.read_shift(16);if(u!==gg.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=r.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),o=r.read_shift(4),1===a&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===a&&(i=r.read_shift(16),l=r.read_shift(4));var h,f=Cw(r,t),d={SystemIdentifier:c};for(var p in f)d[p]=f[p];if(d.FMTID=s,1===a)return d;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{h=Cw(r,null)}catch(m){}for(p in h)d[p]=h[p];return d.FMTID=[s,i],d}function Ow(e,t,n,r,a,s){var i=Vy(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,gg.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=Iw(e,n,r);if(o.push(l),a){var c=Iw(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return bm(o)}function Pw(e,t){return e.read_shift(t),null}function Dw(e,t){return 1===e.read_shift(t)}function Lw(e,t){return t||(t=Vy(2)),t.write_shift(2,+!!e),t}function Mw(e){return e.read_shift(2,"u")}function Fw(e,t){return t||(t=Vy(2)),t.write_shift(2,e),t}function Uw(e,t){return function(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}(e,t,Mw)}function jw(e,t,n){return n||(n=Vy(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function zw(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",s=Qp;(n&&n.biff>=8&&(Qp=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var i=r?e.read_shift(r,a):"";return Qp=s,i}function Vw(e){var t=Qp;Qp=1200;var n,r=e.read_shift(2),a=e.read_shift(1),s=4&a,i=8&a,o=1+(1&a),l=0,c={};i&&(l=e.read_shift(2)),s&&(n=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",h=0===r?"":e.read_shift(r,u);return i&&(e.l+=4*l),s&&(e.l+=n),c.t=h,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Qp=t,c}function Bw(e){var t=e.t||"",n=Vy(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=Vy(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),bm([n,r])}function Hw(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Ww(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Hw(e,r,n)}function qw(e,t,n){if(n.biff>5)return Ww(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $w(e,t,n){return n||(n=Vy(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Gw(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(wm,"");return r&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(a>>1,"utf16le").replace(wm,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function Kw(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(wm,""):""}function Qw(e,t){t||(t=Vy(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Xw(e){var t=Vy(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),s=a>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(n=0;n<i.length;++n)t.write_shift(4,i[n]);if(28==s)Qw(r=r.slice(1),t);else if(2&s){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<i.length;++n)t.write_shift(1,parseInt(i[n],16));var o=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&s&&Qw(a>-1?r.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<i.length;++n)t.write_shift(1,parseInt(i[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Yw(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Jw(e,t){var n=Yw(e);return n[3]=0,n}function Zw(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function eT(e,t,n,r){return r||(r=Vy(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function tT(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function nT(e){return[e.read_shift(2),Cb(e)]}function rT(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function aT(e,t){return t||(t=Vy(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function sT(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var iT=sT;function oT(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function lT(e){e.l+=2,e.l+=e.read_shift(2)}var cT={0:lT,4:lT,5:lT,6:lT,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:lT,9:lT,10:lT,11:lT,12:lT,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:lT,15:lT,16:lT,17:lT,18:lT,19:lT,20:lT,21:oT};function uT(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function hT(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var s=Vy(a);return s.write_shift(2,r),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function fT(e,t){var n=!t||t.biff>=8?2:1,r=Vy(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function dT(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var a=e.read_shift(2);return n&&2==n.biff&&(r=1-(a>>15),a&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},a]}function pT(e,t,n,r){var a=n&&5==n.biff;r||(r=Vy(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return null==s.l&&(s.l=s.length),s}var mT=qw;function gT(e,t,n){var r=e.l+t,a=8!=n.biff&&n.biff?2:4,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:s,c:o},e:{r:i,c:l}}}function vT(e,t,n,r){var a=n&&5==n.biff;r||(r=Vy(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function yT(e,t,n){var r=Zw(e);2!=n.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=a,r.t=!0===a||!1===a?"b":"e",r}var bT=function(e,t,n){return 0===t?"":qw(e,0,n)};function wT(e,t,n){var r,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=zw(e,0,n),s=e.read_shift(2);if(s!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,a}(e,t-2,n)),s.body=r||e.read_shift(t-2),"string"===typeof r&&(s.Name=r),s}var TT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ET(e,t,n){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(n&&2==n.biff?1:2),l=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),l=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var c=Hw(e,i,n);32&a&&(c=TT[c.charCodeAt(0)]);var u=r-e.l;n&&2==n.biff&&--u;var h=r!=e.l&&0!==o&&u>0?function(e,t,n,r){var a,s=e.l+t,i=FS(e,r,n);s!==e.l&&(a=MS(e,s-e.l,i,n));return[i,a]}(e,u,n,o):[];return{chKey:s,Name:c,itab:l,rgce:h}}function ST(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=zw(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,s=e.read_shift(n.biff>8?4:2);0!==s--;)r.push(tT(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function kT(e,t,n){var r=iT(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,HS(e,t,n)]}var _T={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function xT(e){var t=Vy(24),n=Zy(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return bm([t,Xw(e[1])])}function CT(e){var t=e[1].Tooltip,n=Vy(10+2*(t.length+1));n.write_shift(2,2048);var r=Zy(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function AT(e,t,n){if(!n.cellStyles)return zy(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),s=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var NT=Zw,IT=Uw,RT=Ww;var OT=[2,3,48,49,131,139,140,245],PT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Eg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=lb(function(t,n){var r=[],a=dm(1);switch(n.type){case"base64":a=mm(um(t));break;case"binary":a=mm(t);break;case"buffer":case"array":a=t}jy(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,u=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(u=a.read_shift(2));var h=a.read_shift(2),f=n.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(f=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var d=[],p={},m=Math.min(a.length,2==s?521:u-10-(o?264:0)),g=l?32:11;a.l<m&&13!=a[a.l];)switch((p={}).name=am.utils.decode(f,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,p.type=String.fromCharCode(a.read_shift(1)),2==s||l||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==s&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&d.push(p),2!=s&&(a.l+=l?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=d.length;++y)r[0][y]=d[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=d.length;++y){var b=a.slice(a.l,a.l+d[y].len);a.l+=d[y].len,jy(b,0);var w=am.utils.decode(f,b);switch(d[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==d[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=d[y].len;break;case"0":if("_NullFlags"===d[y].name)break;default:throw new Error("DBF Unsupported data type "+d[y].type)}}else a.l+=h;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=d,r}(t,r),r);return a["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return ib(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&em(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var s=Hy(),i=yC(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],u=0,h=0,f=0,d=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++f;else if(null!=o[u]){if(++f,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(h=0;h<1024;++h)if(-1==o.indexOf(o[u]+"_"+h)){o[u]+="_"+h;break}}var p=rb(e["!ref"]),m=[],g=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,T=[];for(h=0;h<l.length;++h)null!=l[h][u]&&T.push(l[h][u]);if(0!=T.length&&null!=o[u]){for(h=0;h<T.length;++h){switch(typeof T[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=T[h]instanceof Date?"D":"C"}w=Math.max(w,String(T[h]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:r[y]||0,d+=g[u],m[u]=y}else m[u]="?"}var E=s.next(32);for(E.write_shift(4,318902576),E.write_shift(4,l.length),E.write_shift(2,296+32*f),E.write_shift(2,d),u=0;u<4;++u)E.write_shift(4,0);for(E.write_shift(4,(+t[Xp]||3)<<8),u=0,h=0;u<o.length;++u)if(null!=o[u]){var S=s.next(32),k=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,k,"sbcs"),S.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),S.write_shift(4,h),S.write_shift(1,g[u]||r[m[u]]||0),S.write_shift(1,v[u]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),h+=g[u]||r[m[u]]||0}var _=s.next(264);for(_.write_shift(4,13),u=0;u<65;++u)_.write_shift(4,0);for(u=0;u<l.length;++u){var x=s.next(d);for(x.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(m[h]){case"L":x.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":x.write_shift(8,l[u][h]||0,"f");break;case"N":var C="0";for("number"==typeof l[u][h]&&(C=l[u][h].toFixed(v[h]||0)),f=0;f<g[h]-C.length;++f)x.write_shift(1,32);x.write_shift(1,C,"sbcs");break;case"D":l[u][h]?(x.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),x.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),x.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):x.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[u][h]?l[u][h]:"").slice(0,g[h]);for(x.write_shift(1,A,"sbcs"),f=0;f<g[h]-A.length;++f)x.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),DT=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+wg(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?om(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:om(r)};function a(e,a){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,h=[],f=[],d=null,p={},m=[],g=[],v=[],y=0;for(+a.codepage>=0&&em(+a.codepage);c!==i.length;++c){y=0;var b,w=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),T=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),E=T[0];if(w.length>0)switch(E){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==T[1].charAt(0)&&f.push(w.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,k=!1,_=!1,x=!1,C=-1,A=-1;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(T[u].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(T[u].slice(1))-1,k||(l=0),s=h.length;s<=o;++s)h[s]=[];break;case"K":'"'===(b=T[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(Ug(b))?isNaN(zg(b).getDate())||(b=Dg(b)):(b=Ug(b),null!==d&&sg(d)&&(b=Ng(b))),"undefined"!==typeof am&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=am.utils.decode(a.codepage,b)),S=!0;break;case"E":x=!0;var N=hS(T[u].slice(1),{r:o,c:l});h[o][l]=[h[o][l],N];break;case"S":_=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":C=parseInt(T[u].slice(1))-1;break;case"C":A=parseInt(T[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(S&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=b:h[o][l]=b,d=null),_){if(x)throw new Error("SYLK shared formula cannot have own formula");var I=C>-1&&h[C][A];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");h[o][l][1]=pS(I[1],{r:o-C,c:l-A})}break;case"F":var R=0;for(u=1;u<T.length;++u)switch(T[u].charAt(0)){case"X":l=parseInt(T[u].slice(1))-1,++R;break;case"Y":for(o=parseInt(T[u].slice(1))-1,s=h.length;s<=o;++s)h[s]=[];break;case"M":y=parseInt(T[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":d=f[parseInt(T[u].slice(1))];break;case"W":for(v=T[u].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)y=parseInt(v[2],10),g[s-1]=0===y?{hidden:!0}:{wch:y},wE(g[s-1]);break;case"C":g[l=parseInt(T[u].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(T[u].slice(1))-1]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=SE(y)):0===y&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}R<1&&(d=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function s(e,t){var n=function(e,t){switch(t.type){case"base64":return a(um(e),t);case"binary":return a(e,t);case"buffer":return a(hm&&Buffer.isBuffer(e)?e.toString("binary"):vm(e),t);case"array":return a(Lg(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],s=n[1],i=lb(r,t);return wg(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+dS(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return ib(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],s=[],o=rb(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=mE(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=gE(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*EE(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var f=eb({r:u,c:h});(n=l?(e[u]||[])[h]:e[f])&&(null!=n.v||n.f&&!n.F)&&s.push(i(n,0,u,h))}return a.join(c)+c+s.join(c)+c+"E"+c}}}(),LT=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,s=0,i=[];s!==n.length;++s)if("BOT"!==n[s].trim()){if(!(r<0)){for(var o=n[s].trim().split(","),l=o[0],c=o[1],u=n[++s]||"";1&(u.match(/["]/g)||[]).length&&s<n.length-1;)u+="\n"+n[++s];switch(u=u.trim(),+l){case-1:if("BOT"===u){i[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?i[r][a]=!0:"FALSE"===u?i[r][a]=!1:isNaN(Ug(c))?isNaN(zg(c).getDate())?i[r][a]=c:i[r][a]=Dg(c):i[r][a]=Ug(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),i[r][a++]=""!==u?u:null}if("EOD"===u)break}}else i[++r]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,n){return lb(function(t,n){switch(n.type){case"base64":return e(um(t),n);case"binary":return e(t,n);case"buffer":return e(hm&&Buffer.isBuffer(t)?t.toString("binary"):vm(t),n);case"array":return e(Lg(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}return{to_workbook:function(e,n){return ib(t(e,n),n)},to_sheet:t,from_sheet:function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],s=rb(n["!ref"]),i=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,s.e.r-s.s.r+1,""),e(a,"TUPLES",0,s.e.c-s.s.c+1,""),e(a,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(a,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=eb({r:o,c:l});if(r=i?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=cg(r.z||Rm[14],_g(Dg(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),MT=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return lb(function(t,n){for(var r=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==r.length;++i){var l=r[i].trim().split(":");if("cell"===l[0]){var c=Zy(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,s=c.c,l[2]){case"t":o[a][s]=e(l[3]);break;case"v":o[a][s]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[a][s]=!!+l[4]:o[a][s]=+l[4],"vtf"==l[2]&&(o[a][s]=[o[a][s],u])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var n,r=[],a=[],s="",i=tb(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=eb({r:l,c:c}),(n=o?(e[l]||[])[c]:e[s])&&null!=n.v&&"z"!==n.t){switch(a=["cell",s,"t"],n.t){case"s":case"str":a.push(t(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=t(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=_g(Dg(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||cg(n.z||Rm[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return ib(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,a,s,a,o(e),i].join("\n")}}}(),FT=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(Ug(e))?isNaN(zg(e).getDate())?t[n][r]=e:t[n][r]=Dg(e):t[n][r]=Ug(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in t&&(r[i]=(r[i]||0)+1);for(s in i=[],r)Object.prototype.hasOwnProperty.call(r,s)&&i.push([r[s],s]);if(!i.length)for(s in r=n)Object.prototype.hasOwnProperty.call(r,s)&&i.push([r[s],s]);return i.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[i.pop()[1]]||44}function a(e,t){var n=t||{},a="";var s=n.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,f=a.charCodeAt(0),d=!1,p=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?Rm[e]:e;return t=t.replace(pg,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Ug(t)))if(!isNaN(zg(t).getDate())||g&&t.match(g)){r.z=n.dateNF||Rm[14];var a=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(pg)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==s?u:c+"T"+u}(0,n.dateNF,t.match(g)||[]),a=1),n.cellDates?(r.t="d",r.v=Dg(t,a)):(r.t="n",r.v=_g(Dg(t,a))),!1!==n.cellText&&(r.w=cg(r.z,r.v instanceof Date?_g(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(s[o]||(s[o]=[]),s[o][l]=r):s[eb({c:l,r:o})]=r),u=h+1,m=e.charCodeAt(u),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),p==f)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===m&&(d=!d);break;case f:case 10:case 13:if(!d&&v())break e}return h-u>0&&v(),s["!ref"]=nb(i),s}function s(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):lb(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){a[c]=[];var u=0;for(e(s[c].slice(0,o).trim(),a,c,u,r),u=1;u<=(s[c].length-o)/10+1;++u)e(s[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function i(e,t){var n="",r="string"==t.type?[0,0,0,0]:oC(e,t);switch(t.type){case"base64":n=um(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof am?am.utils.decode(t.codepage,e):hm&&Buffer.isBuffer(e)?e.toString("binary"):vm(e);break;case"array":n=Lg(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Sv(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=Sv(n):"binary"==t.type&&"undefined"!==typeof am&&t.codepage&&(n=am.utils.decode(t.codepage,am.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?MT.to_sheet("string"==t.type?n:Sv(n),t):s(n,t)}return{to_workbook:function(e,t){return ib(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,n=[],r=rb(e["!ref"]),a=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){for(var i=[],o=r.s.c;o<=r.e.c;++o){var l=eb({r:s,c:o});if((t=a?(e[s]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(sb(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}n.push(i.join(""))}return n.join("\n")}}}();var UT=function(){function e(e,t,n){if(e){jy(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),s=r[a]||r[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,n);if(e.l=o,t(l,s,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},f=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:h=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Rm[14],r.cellDates&&(e[1].t="d",e[1].v=Ng(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=nb(h),l[s]=a,c.push(s),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[eb(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[eb(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=nb(h),l[s]=a,c.push(s),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),f>0&&e[0].r>=f)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[eb(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(s=e[1])}},r)}if(a["!ref"]=nb(h),l[i||s]=a,c.push(i||s),!u.length)return{SheetNames:c,Sheets:l};for(var d={},p=[],m=0;m<u.length;++m)l[c[m]]?(p.push(u[m]||c[m]),d[u[m]]=l[u[m]]||l[c[m]]):(p.push(u[m]),d[u[m]]={"!ref":"A1"});return{SheetNames:p,Sheets:d}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].t="s",20768==r.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return r.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}function a(e,t,n){var r=Vy(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var s=n.charCodeAt(a);r.write_shift(1,s>=128?95:s)}return r.write_shift(1,0),r}function s(e,t,n){var r=Vy(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function i(e,t,n){var r=Vy(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?Jy(t):Xy(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,n,r){var a=Vy(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<r.length;++s){var i=r.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function f(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var i=32768&s;return s=(32767&s)-16446,n[1].v=(1-2*i)*(a*Math.pow(2,s+32)+r*Math.pow(2,s)),n}function d(e,t,n,r){var a=Vy(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,i=0,o=0,l=0;return r<0&&(i=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,s=(r*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(i?32768:0),a.write_shift(2,o),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=Vy(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Mw},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,s=n(e,0,r);if(s[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){jy(e,0);var n=[],r=0,a="",s="",i="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:n.push(e.read_shift(8,"f"));break;case 1:s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(s+a);break;case 2:var f=o(t[0].c,e.read_shift(2),!0),d=o(t[0].r,e.read_shift(2),!1);s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(f+d+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),i=n.pop(),n.push(["AND","OR"][h-20]+"("+i+","+u+")");break;default:if(h<32&&c[h])u=n.pop(),i=n.pop(),n.push(i+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(r=l[h][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+n.join("|")+"|");var m=n.slice(-r);n.length-=r,n.push(l[h][0]+"("+m.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=f(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&em(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=Hy(),o=rb(e["!ref"]),l=Array.isArray(e),c=[];J_(r,0,function(e){var t=Vy(2);return t.write_shift(2,e),t}(1030)),J_(r,6,function(e){var t=Vy(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),h=o.s.r;h<=u;++h)for(var f=Xy(h),d=o.s.c;d<=o.e.c;++d){h===o.s.r&&(c[d]=Jy(d));var p=c[d]+f,m=l?(e[h]||[])[d]:e[p];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?J_(r,13,s(h,d,m.v)):J_(r,14,i(h,d,m.v));else J_(r,15,a(h,d,sb(m).slice(0,239)))}return J_(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&em(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=Hy();J_(r,0,function(e){var t=Vy(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var l=tb(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&J_(r,27,g(e.SheetNames[a],s++));var i=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=rb(o["!ref"]),c=Array.isArray(o),u=[],f=Math.min(l.e.r,8191),p=l.s.r;p<=f;++p)for(var m=Xy(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=Jy(v));var y=u[v]+m,b=c?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)J_(r,23,d(p,v,i,b.v));else J_(r,22,h(p,v,i,sb(b).slice(0,239)))}++i}}return J_(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(mm(um(e)),n);case"binary":return t(mm(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var jT=function(){var e=_v("t"),t=_v("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var a={t:"s",v:uv(r[1])},s=n.match(t);return s&&(a.s=function(e){var t={},n=e.match(rv),r=0,a=!1;if(n)for(;r!=n.length;++r){var s=iv(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=Jp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),a}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(a).map(n).filter(function(e){return e.v})}}(),zT=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),n.push("</"+a+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),VT=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,BT=/<(?:\w+:)?r>/,HT=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function WT(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=uv(Sv(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Sv(e),n&&(r.h=gv(r.t))):e.match(BT)&&(r.r=Sv(e),r.t=uv(Sv((e.replace(HT,"").match(VT)||[]).join("").replace(rv,""))),n&&(r.h=zT(jT(r.r)))),r):{t:""}}var qT=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$T=/<(?:\w+:)?(?:si|sstItem)>/g,GT=/<\/(?:\w+:)?(?:si|sstItem)>/;var KT=/^\s|\s$|[\t\n\r]/;function QT(e,t){if(!t.bookSST)return"";var n=[ev];n[n.length]=Dv("sst",null,{xmlns:Yv[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(KT)&&(s+=' xml:space="preserve"'),s+=">"+dv(a.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var XT=function(e,t){var n=!1;return null==t&&(n=!0,t=Vy(15+4*e.t.length)),t.write_shift(1,0),hb(e.t,t),n?t.slice(0,t.l):t};function YT(e){var t=Hy();Wy(t,159,function(e,t){return t||(t=Vy(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)Wy(t,19,XT(e[n]));return Wy(t,160),t.end()}function JT(e){if("undefined"!==typeof am)return am.utils.encode(Xp,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function ZT(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function eE(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function tE(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ZT(e,4),t.U=ZT(e,4),t.W=ZT(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function nE(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=36==r.Flags;break;case 26625:a=4==r.Flags;break;case 0:a=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function rE(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function aE(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:nE(e,t),v:rE(e,e.length-e.l)}}function sE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iE(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(rv,function(e){var n=iv(e);switch(ov(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){r[e]=n[e]});break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}}),r}function oE(e){var t,n,r=0,a=JT(e),s=a.length+1;for((t=dm(s))[0]=a.length,n=1;n!=s;++n)t[n]=a[n-1];for(n=s-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var lE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(a){for(var s,i,o,l=JT(a),c=function(e){for(var r=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(r^=n[a]),i*=2,--a;return r}(l),u=l.length,h=dm(16),f=0;16!=f;++f)h[f]=0;for(1===(1&u)&&(s=c>>8,h[u]=r(e[0],s),--u,s=255&c,i=l[l.length-1],h[u]=r(i,s));u>0;)s=c>>8,h[--u]=r(l[u],s),s=255&c,h[--u]=r(l[u],s);for(u=15,o=15-l.length;o>0;)s=c>>8,h[u]=r(e[o],s),--o,s=255&c,h[--u]=r(l[u],s),--u,--o;return h}}(),cE=function(e){var t=0,n=lE(e);return function(e){var r=function(e,t,n,r,a){var s,i;for(a||(a=t),r||(r=lE(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=r[n])>>5|i<<3),a[s]=i,++n;return[a,n,r]}("",e,t,n);return t=r[1],r[0]}};function uE(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=ZT(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=ZT(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=nE(e,a),t-=a,n.EncryptionVerifier=rE(e,t),n}(e,t),r}var hE=function(){function e(e,n){switch(n.type){case"base64":return t(um(e),n);case"binary":return t(e,n);case"buffer":return t(hm&&Buffer.isBuffer(e)?e.toString("binary"):vm(e),n);case"array":return t(Lg(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,s=/\\\w+\b/g,i=0,o=-1;r=s.exec(e);){if("\\cell"===r[0]){var l=e.slice(i,s.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[eb({r:t,c:o})]=c}}i=s.lastIndex}o>a.e.c&&(a.e.c=o)}),n["!ref"]=nb(a),n}return{to_workbook:function(t,n){return ib(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=rb(e["!ref"]),a=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){n.push("\\trowd\\trautofit1");for(var i=r.s.c;i<=r.e.c;++i)n.push("\\cellx"+(i+1));for(n.push("\\pard\\intbl"),i=r.s.c;i<=r.e.c;++i){var o=eb({r:s,c:i});(t=a?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(sb(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function fE(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function dE(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),s=Math.min(t,n,r),i=a-s;if(0===i)return[0,0,t];var o,l=0,c=a+s;switch(o=i/(c>1?2-c:c),a){case t:l=((n-r)/i+6)%6;break;case n:l=(r-t)/i+2;break;case r:l=(t-n)/i+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),fE(function(e){var t,n=e[0],r=e[1],a=e[2],s=2*r*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*n;if(0!==r)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(n))}var pE=6;function mE(e){return Math.floor((e+Math.round(128/pE)/256)*pE)}function gE(e){return Math.floor((e-5)/pE*100+.5)/100}function vE(e){return Math.round((e*pE+5)/pE*256)/256}function yE(e){return vE(gE(mE(e)))}function bE(e){var t=Math.abs(e-yE(e)),n=pE;if(t>.005)for(pE=1;pE<15;++pE)Math.abs(e-yE(e))<=t&&(t=Math.abs(e-yE(e)),n=pE);pE=n}function wE(e){e.width?(e.wpx=mE(e.width),e.wch=gE(e.wpx),e.MDW=pE):e.wpx?(e.wch=gE(e.wpx),e.width=vE(e.wch),e.MDW=pE):"number"==typeof e.wch&&(e.width=vE(e.wch),e.wpx=mE(e.width),e.MDW=pE),e.customWidth&&delete e.customWidth}var TE=96;function EE(e){return 96*e/TE}function SE(e){return e*TE/96}var kE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var _E=["numFmtId","fillId","fontId","borderId","xfId"],xE=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var CE=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=wg(Rm),a=0;a<r.length;++a)t.NumberFmt[r[a]]=Rm[r[a]];var s=e[0].match(rv);if(s)for(a=0;a<s.length;++a){var i=iv(s[a]);switch(ov(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=uv(Sv(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}ug(o,l)}break;default:if(n.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=s.match(r))&&function(e,t,n,r){t.Fonts=[];var a={},s=!1;(e[0].match(rv)||[]).forEach(function(e){var i=iv(e);switch(ov(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=Sv(i.val));break;case"<b":a.bold=i.val?yv(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?yv(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?yv(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?yv(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?yv(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?yv(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?yv(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=Jp[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=yv(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var o=Hb[a.color.index];81==a.color.index&&(o=Hb[1]),o||(o=Hb[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=dE(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=s.match(n))&&function(e,t,n,r){t.Fills=[];var a={},s=!1;(e[0].match(rv)||[]).forEach(function(e){var n=iv(e);switch(ov(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":n.patternType&&(a.patternType=n.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),n.indexed&&(a.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(a.bgColor.theme=parseInt(n.theme,10)),n.tint&&(a.bgColor.tint=parseFloat(n.tint)),n.rgb&&(a.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),n.theme&&(a.fgColor.theme=parseInt(n.theme,10)),n.tint&&(a.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(a.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+n[0]+" in fills")}})}(l,c,0,o),(l=s.match(a))&&function(e,t,n,r){t.Borders=[];var a={},s=!1;(e[0].match(rv)||[]).forEach(function(e){var n=iv(e);switch(ov(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},n.diagonalUp&&(a.diagonalUp=yv(n.diagonalUp)),n.diagonalDown&&(a.diagonalDown=yv(n.diagonalDown)),t.Borders.push(a);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+n[0]+" in borders")}})}(l,c,0,o),(l=s.match(t))&&function(e,t,n){var r;t.CellXf=[];var a=!1;(e[0].match(rv)||[]).forEach(function(e){var s=iv(e),i=0;switch(ov(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=s)[0],i=0;i<_E.length;++i)r[_E[i]]&&(r[_E[i]]=parseInt(r[_E[i]],10));for(i=0;i<xE.length;++i)r[xE[i]]&&(r[xE[i]]=yv(r[xE[i]]));if(t.NumberFmt&&r.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[i]){r.numFmtId=i;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=yv(s.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(l,c,o),c):c}}();function AE(e,t){var n,r=[ev,Dv("styleSheet",null,{xmlns:Yv[0],"xmlns:vt":Kv})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=Dv("numFmt",null,{numFmtId:r,formatCode:dv(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Dv("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=Dv("cellXfs",null),e.forEach(function(e){t[t.length]=Dv("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Dv("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function NE(e,t,n){n||(n=Vy(6+4*t.length)),n.write_shift(2,e),hb(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function IE(e,t){t||(t=Vy(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Vy(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Db(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),hb(e.name,t),t.length>t.l?t.slice(0,t.l):t}var RE,OE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],PE=zy;function DE(e,t){t||(t=Vy(84)),RE||(RE=Eg(OE));var n=RE[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(Db({auto:1},t),Db({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function LE(e,t,n){n||(n=Vy(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function ME(e,t){return t||(t=Vy(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var FE=zy;function UE(e){var t;Wy(e,613,cb(1)),Wy(e,46,(t||(t=Vy(51)),t.write_shift(1,0),ME(0,t),ME(0,t),ME(0,t),ME(0,t),ME(0,t),t.length>t.l?t.slice(0,t.l):t)),Wy(e,614)}function jE(e){var t,n;Wy(e,619,cb(1)),Wy(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=Vy(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),Sb(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),Wy(e,620)}function zE(e){Wy(e,508,function(e,t,n){var r=Vy(2052);return r.write_shift(4,e),Sb(t,r),Sb(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),Wy(e,509)}function VE(e,t){var n=Hy();return Wy(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(Wy(e,615,cb(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&Wy(e,44,NE(r,t[r]))}),Wy(e,616))}}(n,e.SSF),function(e){Wy(e,611,cb(1)),Wy(e,43,IE({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Wy(e,612)}(n),function(e){Wy(e,603,cb(2)),Wy(e,45,DE({patternType:"none"})),Wy(e,45,DE({patternType:"gray125"})),Wy(e,604)}(n),UE(n),function(e){Wy(e,626,cb(1)),Wy(e,47,LE({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Wy(e,627)}(n),function(e,t){Wy(e,617,cb(t.length)),t.forEach(function(t){Wy(e,47,LE(t,0))}),Wy(e,618)}(n,t.cellXfs),jE(n),function(e){Wy(e,505,cb(0)),Wy(e,506)}(n),zE(n),Wy(n,279),n.end()}var BE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HE(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(rv)||[]).forEach(function(e){var a=iv(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=a.val;break;case"<a:sysClr":r.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[BE.indexOf(a[0])]=r,r={}):r.name=a[0].slice(3,a[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function WE(){}function qE(){}var $E=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,GE=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,KE=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var QE=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function XE(e,t){var n;e&&0!==e.length||(e=YE());var r={};if(!(n=e.match(QE)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",$E,HE],["fontScheme",GE,WE],["fmtScheme",KE,qE]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)})}(n[0],r,t),r.raw=e,r}function YE(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[ev];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function JE(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return zy(e,t)}(e,4);break;case 2:t.xclrValue=Yw(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function ZE(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=JE(e);break;case 6:r[1]=function(e,t){return zy(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function eS(e,t){t.forEach(function(e){e[0]})}function tS(){var e=Hy();return Wy(e,332),Wy(e,334,cb(1)),Wy(e,335,function(e){var t=Vy(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),hb(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Wy(e,336),Wy(e,339,function(e,t){var n=Vy(8+2*t.length);return n.write_shift(4,e),hb(t,n),n.slice(0,n.l)}(1,"XLDAPR")),Wy(e,52),Wy(e,35,cb(514)),Wy(e,4096,cb(0)),Wy(e,4097,Fw(1)),Wy(e,36),Wy(e,53),Wy(e,340),Wy(e,337,function(e,t){var n=Vy(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),Wy(e,51,function(e){var t=Vy(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),Wy(e,338),Wy(e,333),e.end()}function nS(){var e=[ev];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var rS=1024;function aS(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Dv("xml",null,{"xmlns:v":ry,"xmlns:o":Jv,"xmlns:x":Zv,"xmlns:mv":ny}).replace(/\/>/,">"),Dv("o:shapelayout",Dv("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Dv("v:shapetype",[Dv("v:stroke",null,{joinstyle:"miter"}),Dv("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];rS<1e3*e;)rS+=1e3;return t.forEach(function(e){var t=Zy(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?Dv("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Dv("v:fill",r,n);++rS,a=a.concat(["<v:shape"+Pv({id:"_x0000_s"+rS,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Dv("v:shadow",null,{on:"t",obscured:"t"}),Dv("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ov("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Ov("x:AutoFill","False"),Ov("x:Row",String(t.r)),Ov("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function sS(e,t,n,r){var a,s=Array.isArray(e);t.forEach(function(t){var i=Zy(t.ref);if(s?(e[i.r]||(e[i.r]=[]),a=e[i.r][i.c]):a=e[t.ref],!a){a={t:"z"},s?e[i.r][i.c]=a:e[t.ref]=a;var o=rb(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=nb(o);l!==e["!ref"]&&(e["!ref"]=l)}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:n};t.h&&(c.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!n&&a.c[u].T)return;n&&!a.c[u].T&&a.c.splice(u,1)}if(n&&r)for(u=0;u<r.length;++u)if(c.a==r[u].id){c.a=r[u].name||c.a;break}a.c.push(c)})}function iS(e){var t=[ev,Dv("comments",null,{xmlns:Yv[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=dv(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(dv(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(Ov("t",dv(a[0]||"")));else{for(var s="Comment:\n    "+a[0]+"\n",i=1;i<a.length;++i)s+="Reply:\n    "+a[i]+"\n";t.push(Ov("t",dv(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function oS(e,t,n){var r=[ev,Dv("ThreadedComments",null,{xmlns:Hv}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(s,i){if(s.T){s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==i?a=o.id:o.parentId=a,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),r.push(Dv("threadedComment",Ov("text",s.t||""),o))}else delete s.ID})}),r.push("</ThreadedComments>"),r.join("")}var lS=ub;function cS(e){var t=Hy(),n=[];return Wy(t,628),Wy(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),Wy(t,632,function(e){return hb(e.slice(0,54))}(e.a)))})}),Wy(t,631),Wy(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var a={s:Zy(e[0]),e:Zy(e[0])};Wy(t,635,function(e,t){return null==t&&(t=Vy(36)),t.write_shift(4,e[1].iauthor),Rb(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&Wy(t,637,mb(r)),Wy(t,636),delete r.iauthor})}),Wy(t,634),Wy(t,629),t.end()}var uS=["xlsb","xlsm","xlam","biff8","xla"];var hS=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var s=!1,i=!1;0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,n+(s?"":"$")+Jy(l)+(i?"":"$")+Xy(o)}return function(r,a){return t=a,r.replace(e,n)}}(),fS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,dS=function(){return function(e,t){return e.replace(fS,function(e,n,r,a,s,i){var o=Yy(a)-(r?0:t.c),l=Qy(i)-(s?0:t.r);return n+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})}}();function pS(e,t){return e.replace(fS,function(e,n,r,a,s,i){return n+("$"==r?r+a:Jy(Yy(a)+t.c))+("$"==s?s+i:Xy(Qy(i)+t.r))})}function mS(e,t,n){var r=tb(t).s,a=Zy(n);return pS(e,{r:a.r-r.r,c:a.c-r.c})}function gS(e){return e.replace(/_xlfn\./g,"")}function vS(e){e.l+=1}function yS(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function bS(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return wS(e);12==n.biff&&(r=4)}var a=e.read_shift(r),s=e.read_shift(r),i=yS(e,2),o=yS(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function wS(e){var t=yS(e,2),n=yS(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function TS(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=yS(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=yS(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function ES(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function SS(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function kS(e){return[e.read_shift(1),e.read_shift(1)]}function _S(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Dw(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=Wb[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Ob(e);break;case 2:n[1]=qw(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function xS(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],s=0;s!=r;++s)a.push((12==n.biff?Ib:rT)(e,8));return a}function CS(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var s=0,i=[];s!=r&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=_S(e,n.biff);return i}function AS(e,t,n){return e.l+=2,[ES(e)]}function NS(e){return e.l+=6,[]}function IS(e){return e.l+=2,[Mw(e),1&e.read_shift(2)]}var RS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var OS={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:zy},3:{n:"PtgAdd",f:vS},4:{n:"PtgSub",f:vS},5:{n:"PtgMul",f:vS},6:{n:"PtgDiv",f:vS},7:{n:"PtgPower",f:vS},8:{n:"PtgConcat",f:vS},9:{n:"PtgLt",f:vS},10:{n:"PtgLe",f:vS},11:{n:"PtgEq",f:vS},12:{n:"PtgGe",f:vS},13:{n:"PtgGt",f:vS},14:{n:"PtgNe",f:vS},15:{n:"PtgIsect",f:vS},16:{n:"PtgUnion",f:vS},17:{n:"PtgRange",f:vS},18:{n:"PtgUplus",f:vS},19:{n:"PtgUminus",f:vS},20:{n:"PtgPercent",f:vS},21:{n:"PtgParen",f:vS},22:{n:"PtgMissArg",f:vS},23:{n:"PtgStr",f:function(e,t,n){return e.l++,zw(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Wb[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Ob(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[ek[a],ZS[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),s=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?ZS:JS)[s[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,s=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,s]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,TS(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,bS(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:zy},40:{n:"PtgMemNoMem",f:zy},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return wS(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),s=yS(e,2),i=yS(e,2);return{s:{r:r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,TS(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,bS(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[r,a]}},255:{}},PS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DS={1:{n:"PtgElfLel",f:IS},2:{n:"PtgElfRw",f:AS},3:{n:"PtgElfCol",f:AS},6:{n:"PtgElfRwV",f:AS},7:{n:"PtgElfColV",f:AS},10:{n:"PtgElfRadical",f:AS},11:{n:"PtgElfRadicalS",f:NS},13:{n:"PtgElfColS",f:NS},15:{n:"PtgElfColSV",f:NS},16:{n:"PtgElfRadicalLel",f:IS},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&n,rt:RS[n>>2&31],idx:r,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},LS={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],s=0;s<=r;++s)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:SS},33:{n:"PtgAttrBaxcel",f:SS},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),kS(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),kS(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function MS(e,t,n,r){if(r.biff<8)return zy(e,t);for(var a=e.l+t,s=[],i=0;i!==n.length;++i)switch(n[i][0]){case"PtgArray":n[i][1]=CS(e,0,r),s.push(n[i][1]);break;case"PtgMemArea":n[i][2]=xS(e,n[i][1],r),s.push(n[i][2]);break;case"PtgExp":r&&12==r.biff&&(n[i][1][1]=e.read_shift(4),s.push(n[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[i][0]}return 0!==(t=a-e.l)&&s.push(zy(e,t)),s}function FS(e,t,n){for(var r,a,s=e.l+t,i=[];s!=e.l;)t=s-e.l,a=e[e.l],r=OS[a]||OS[PS[a]],24!==a&&25!==a||(r=(24===a?DS:LS)[e[e.l+1]]),r&&r.f?i.push([r.n,r.f(e,t,n)]):zy(e,t);return i}function US(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],s=0;s<r.length;++s){var i=r[s];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var jS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zS(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function VS(e,t,n){var r=zS(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function BS(e,t,n,r,a){var s,i,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],f=0,d=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=h.pop(),i=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Fg(" ",e[0][m][1][1]);break;case 1:g=Fg("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}i+=g,m=-1}h.push(i+jS[b[0]]+s);break;case"PtgIsect":s=h.pop(),i=h.pop(),h.push(i+" "+s);break;case"PtgUnion":s=h.pop(),i=h.pop(),h.push(i+","+s);break;case"PtgRange":s=h.pop(),i=h.pop(),h.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=qy(b[1][1],u,a),h.push(Gy(o,c));break;case"PtgRefN":o=n?qy(b[1][1],n,a):b[1][1],h.push(Gy(o,c));break;case"PtgRef3d":f=b[1][1],o=qy(b[1][2],u,a);p=VS(r,f,a);h.push(p+"!"+Gy(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],T=b[1][1];w||(w=0);var E=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===T&&(T=E.shift()),h.push(T+"("+E.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=$y(b[1][1],n?{s:n}:u,a),h.push(Ky(l,a));break;case"PtgArea":l=$y(b[1][1],u,a),h.push(Ky(l,a));break;case"PtgArea3d":f=b[1][1],l=b[1][2],p=VS(r,f,a),h.push(p+"!"+Ky(l,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":d=b[1][2];var S=(r.names||[])[d-1]||(r[0]||[])[d],k=S?S.Name:"SH33TJSNAME"+String(d);k&&"_xlfn."==k.slice(0,6)&&!a.xlfn&&(k=k.slice(6)),h.push(k);break;case"PtgNameX":var _,x=b[1][1];if(d=b[1][2],!(a.biff<=5)){var C="";if(14849==((r[x]||[])[0]||[])[0]||(1025==((r[x]||[])[0]||[])[0]?r[x][d]&&r[x][d].itab>0&&(C=r.SheetNames[r[x][d].itab-1]+"!"):C=r.SheetNames[d-1]+"!"),r[x]&&r[x][d])C+=r[x][d].Name;else if(r[0]&&r[0][d])C+=r[0][d].Name;else{var A=(zS(r,x,a)||"").split(";;");A[d-1]?C=A[d-1]:C+="SH33TJSERRX"}h.push(C);break}x<0&&(x=-x),r[x]&&(_=r[x][d]),_||(_={Name:"SH33TJSERRY"}),h.push(_.Name);break;case"PtgParen":var N="(",I=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:N=Fg(" ",e[0][m][1][1])+N;break;case 3:N=Fg("\r",e[0][m][1][1])+N;break;case 4:I=Fg(" ",e[0][m][1][1])+I;break;case 5:I=Fg("\r",e[0][m][1][1])+I;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(N+h.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[eb(o)]){var O=r.sharedf[eb(o)];h.push(BS(O,u,R,r,a))}else{var P=!1;for(s=0;s!=r.arrayf.length;++s)if(i=r.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){h.push(BS(i[1],u,R,r,a)),P=!0;break}P||h.push(b[1])}break;case"PtgArray":h.push("{"+US(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var D=!0;switch((b=e[0][m])[1][0]){case 4:D=!1;case 0:g=Fg(" ",b[1][1]);break;case 5:D=!1;case 1:g=Fg("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((D?g:"")+h.pop()+(D?"":g)),m=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function HS(e,t,n){var r,a=e.l+t,s=2==n.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],zy(e,t-2)];var o=FS(e,i,n);return t!==i+s&&(r=MS(e,t-i-s,o,n)),e.l=a,[o,r]}function WS(e,t,n){var r,a=e.l+t,s=e.read_shift(2),i=FS(e,s,n);return 65535==s?[[],zy(e,t-2)]:(t!==s+2&&(r=MS(e,a-s-2,i,n)),[i,r])}function qS(e,t,n){var r=e.l+t,a=Zw(e);2==n.biff&&++e.l;var s=function(e){var t;if(65535!==Ay(e,e.l+6))return[Ob(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=function(e,t,n){var r,a=e.l+t,s=2==n.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],zy(e,t-2)];var o=FS(e,i,n);return t!==i+s&&(r=MS(e,t-i-s,o,n)),e.l=a,[o,r]}(e,r-e.l,n);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function $S(e,t,n,r,a){var s=eT(t,n,a),i=function(e){if(null==e){var t=Vy(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Pb("number"==typeof e?e:0)}(e.v),o=Vy(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Vy(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return bm([s,i,o,l])}function GS(e,t,n){var r=e.read_shift(4),a=FS(e,r,n),s=e.read_shift(4);return[a,s>0?MS(e,s,a,n):null]}var KS=GS,QS=GS,XS=GS,YS=GS,JS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ZS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ek={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function tk(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function nk(e){return("of:="+e.replace(fS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function rk(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function ak(e){return e.replace(/\./,"!")}var sk={},ik={},ok="undefined"!==typeof Map;function lk(e,t,n){var r=0,a=e.length;if(n){if(ok?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var s=ok?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,n&&(ok?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function ck(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(pE=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=gE(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=vE(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function uk(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function hk(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],a=60,s=e.length;if(null==r&&n.ssf)for(;a<392;++a)if(null==n.ssf[a]){ug(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}for(a=0;a!=s;++a)if(e[a].numFmtId===r)return a;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fk(e,t,n,r,a,s){try{r.cellNF&&(e.z=Rm[t])}catch(o){if(r.WTF)throw o}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Dg(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==Rm[t]&&ug(dg[t]||"General",t),"e"===e.t)e.w=e.w||Wb[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Vm(e.v);else if("d"===e.t){var i=_g(e.v);e.w=(0|i)===i?i.toString(10):Vm(i)}else{if(void 0===e.v)return"";e.w=Bm(e.v,ik)}else"d"===e.t?e.w=cg(t,_g(e.v),ik):e.w=cg(t,e.v,ik)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&null!=n)try{e.s=s.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=dE(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=dE(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&s.Fills)throw o}}}function dk(e,t,n){if(e&&e["!ref"]){var r=rb(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var pk=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,mk=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gk=/<(?:\w:)?hyperlink [^>]*>/gm,vk=/"(\w*:\w*)"/,yk=/<(?:\w:)?col\b[^>]*[\/]?>/g,bk=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wk=/<(?:\w:)?pageMargins[^>]*\/>/g,Tk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ek=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Sk=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kk(e,t,n,r,a,s,i){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(mk);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var f=c.match(Tk);f?_k(f[0],o,a,n):(f=c.match(Ek))&&function(e,t,n,r,a){_k(e.slice(0,e.indexOf(">")),n,r,a)}(f[0],f[1],o,a,n);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=c.slice(d,d+50).match(vk);p&&function(e,t){var n=rb(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=nb(n))}(o,p[1])}var m=c.match(Sk);m&&m[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Ak)||[]).forEach(function(e,n){var r=iv(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),yv(r.rightToLeft)&&(t.Views[n].RTL=!0)})}(m[1],a);var g=[];if(t.cellStyles){var v=c.match(yk);v&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=iv(t[r],!0);a.hidden&&(a.hidden=yv(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,bE(a.width)),wE(a);s<=i;)e[s++]=Mg(a)}}(g,v)}h&&Ik(h[1],o,t,l,s,i);var y=u.match(bk);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(pk);if(w)for(d=0;d!=w.length;++d)b[d]=rb(w[d].slice(w[d].indexOf('"')+1));var T=u.match(gk);T&&function(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var s=iv(Sv(t[a]),!0);if(!s.ref)return;var i=((n||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+uv(s.location))):(s.Target="#"+uv(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=rb(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=eb({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}(o,T,r);var E=u.match(wk);if(E&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}(iv(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=nb(l)),t.sheetRows>0&&o["!ref"]){var S=rb(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=nb(S))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),o}function _k(e,t,n,r){var a=iv(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=uv(Sv(a.codeName)))}var xk=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Ck=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Ak=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Nk(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Wb[e.v];break;case"d":r&&r.cellDates?a=Dg(e.v,-1).toISOString():((e=Mg(e)).t="n",a=""+(e.v=_g(Dg(e.v)))),"undefined"===typeof e.z&&(e.z=Rm[14]);break;default:a=e.v}var o=Ov("v",dv(a)),l={r:t},c=hk(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Ov("v",""+lk(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Dv("f",dv(e.f),u)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),Dv("c",o,l)}var Ik=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=_v("v"),i=_v("f");return function(o,l,c,u,h,f){for(var d,p,m,g,v,y=0,b="",w=[],T=[],E=0,S=0,k=0,_="",x=0,C=0,A=0,N=0,I=Array.isArray(f.CellXf),R=[],O=[],P=Array.isArray(l),D=[],L={},M=!1,F=!!c.sheetStubs,U=o.split(t),j=0,z=U.length;j!=z;++j){var V=(b=U[j].trim()).length;if(0!==V){var B=0;e:for(y=0;y<V;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(c&&c.cellStyles){if(x=null!=(p=iv(b.slice(B,y),!0)).r?parseInt(p.r,10):x+1,C=-1,c.sheetRows&&c.sheetRows<x)continue;L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=SE(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(D[x-1]=L)}break;case"<":B=y}if(B>=y)break;if(x=null!=(p=iv(b.slice(B,y),!0)).r?parseInt(p.r,10):x+1,C=-1,!(c.sheetRows&&c.sheetRows<x)){u.s.r>x-1&&(u.s.r=x-1),u.e.r<x-1&&(u.e.r=x-1),c&&c.cellStyles&&(L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=SE(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(D[x-1]=L)),w=b.slice(y).split(e);for(var H=0;H!=w.length&&"<"==w[H].trim().charAt(0);++H);for(w=w.slice(H),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(T=b.match(n),E=y,S=0,k=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=T&&2===T.length){for(E=0,_=T[1],S=0;S!=_.length&&!((k=_.charCodeAt(S)-64)<1||k>26);++S)E=26*E+k;C=--E}else++C;for(S=0;S!=b.length&&62!==b.charCodeAt(S);++S);if(++S,(p=iv(b.slice(0,S),!0)).r||(p.r=eb({r:x-1,c:C})),d={t:""},null!=(T=(_=b.slice(S)).match(s))&&""!==T[1]&&(d.v=uv(T[1])),c.cellFormula){if(null!=(T=_.match(i))&&""!==T[1]){if(d.f=uv(Sv(T[1])).replace(/\r\n/g,"\n"),c.xlfn||(d.f=gS(d.f)),T[0].indexOf('t="array"')>-1)d.F=(_.match(a)||[])[1],d.F.indexOf(":")>-1&&R.push([rb(d.F),d.F]);else if(T[0].indexOf('t="shared"')>-1){g=iv(T[0]);var W=uv(Sv(T[1]));c.xlfn||(W=gS(W)),O[parseInt(g.si,10)]=[g,W,p.r]}}else(T=_.match(/<f[^>]*\/>/))&&O[(g=iv(T[0])).si]&&(d.f=mS(O[g.si][1],O[g.si][2],p.r));var q=Zy(p.r);for(S=0;S<R.length;++S)q.r>=R[S][0].s.r&&q.r<=R[S][0].e.r&&q.c>=R[S][0].s.c&&q.c<=R[S][0].e.c&&(d.F=R[S][1])}if(null==p.t&&void 0===d.v)if(d.f||d.F)d.v=0,d.t="n";else{if(!F)continue;d.t="z"}else d.t=p.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),d.t){case"n":if(""==d.v||null==d.v){if(!F)continue;d.t="z"}else d.v=parseFloat(d.v);break;case"s":if("undefined"==typeof d.v){if(!F)continue;d.t="z"}else m=sk[parseInt(d.v,10)],d.v=m.t,d.r=m.r,c.cellHTML&&(d.h=m.h);break;case"str":d.t="s",d.v=null!=d.v?Sv(d.v):"",c.cellHTML&&(d.h=gv(d.v));break;case"inlineStr":T=_.match(r),d.t="s",null!=T&&(m=WT(T[1]))?(d.v=m.t,c.cellHTML&&(d.h=m.h)):d.v="";break;case"b":d.v=yv(d.v);break;case"d":c.cellDates?d.v=Dg(d.v,1):(d.v=_g(Dg(d.v,1)),d.t="n");break;case"e":c&&!1===c.cellText||(d.w=d.v),d.v=qb[d.v]}if(A=N=0,v=null,I&&void 0!==p.s&&null!=(v=f.CellXf[p.s])&&(null!=v.numFmtId&&(A=v.numFmtId),c.cellStyles&&null!=v.fillId&&(N=v.fillId)),fk(d,A,N,c,h,f),c.cellDates&&I&&"n"==d.t&&sg(Rm[A])&&(d.t="d",d.v=Ng(d.v)),p.cm&&c.xlmeta){var $=(c.xlmeta.Cell||[])[+p.cm-1];$&&"XLDAPR"==$.type&&(d.D=!0)}if(P){var G=Zy(p.r);l[G.r]||(l[G.r]=[]),l[G.r][G.c]=d}else l[p.r]=d}}}}D.length>0&&(l["!rows"]=D)}}();function Rk(e,t,n,r){var a,s=[ev,Dv("worksheet",null,{xmlns:Yv[0],"xmlns:r":Gv})],i=n.SheetNames[e],o="",l=n.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",u=rb(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=nb(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,a){var s=!1,i={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(u){}s=!0,i.codeName=kv(dv(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Dv("outlinePr",null,c)}(s||o)&&(a[a.length]=Dv("sheetPr",o,i))}(l,n,e,t,s),s[s.length]=Dv("dimension",null,{ref:c}),s[s.length]=function(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Dv("sheetViews",Dv("sheetView",null,a),{})}(0,0,0,n),t.sheetFormat&&(s[s.length]=Dv("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function(e,t){for(var n,r=["<cols>"],a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Dv("col",null,ck(a,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var n,r,a=[],s=[],i=rb(e["!ref"]),o="",l="",c=[],u=0,h=0,f=e["!rows"],d=Array.isArray(e),p={r:l},m=-1;for(h=i.s.c;h<=i.e.c;++h)c[h]=Jy(h);for(u=i.s.r;u<=i.e.r;++u){for(s=[],l=Xy(u),h=i.s.c;h<=i.e.c;++h){n=c[h]+l;var g=d?(e[u]||[])[h]:e[n];void 0!==g&&null!=(o=Nk(g,n,e,t))&&s.push(o)}(s.length>0||f&&f[u])&&(p={r:l},f&&f[u]&&((r=f[u]).hidden&&(p.hidden=1),m=-1,r.hpx?m=EE(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(p.ht=m,p.customHeight=1),r.level&&(p.outlineLevel=r.level)),a[a.length]=Dv("row",s.join(""),p))}if(f)for(;u<f.length;++u)f&&f[u]&&(p={r:u+1},(r=f[u]).hidden&&(p.hidden=1),m=-1,r.hpx?m=EE(r.hpx):r.hpt&&(m=r.hpt),m>-1&&(p.ht=m,p.customHeight=1),r.level&&(p.outlineLevel=r.level),a[a.length]=Dv("row","",p));return a.join("")}(l,t,0,0),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=function(e){var t={sheet:1};return xk.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),Ck.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=oE(e.password).toString(16).toUpperCase()),Dv("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function(e,t,n,r){var a="string"==typeof e.ref?e.ref:nb(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,i=tb(a);i.s.r==i.e.r&&(i.e.r=tb(t["!ref"]).e.r,a=nb(i));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Dv("autoFilter",null,{ref:a})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+nb(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var f,d,p=-1,m=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(f={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=Zb(r,-1,dv(e[1].Target).replace(/#.*$/,""),Qb.HLINK),f["r:id"]="rId"+m),(p=e[1].Target.indexOf("#"))>-1&&(f.location=dv(e[1].Target.slice(p+1))),e[1].Tooltip&&(f.tooltip=dv(e[1].Tooltip)),s[s.length]=Dv("hyperlink",null,f))}),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(uk(d=l["!margins"]),Dv("pageMargins",null,d))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(s[s.length]=Ov("ignoredErrors",Dv("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(m=Zb(r,-1,"../drawings/drawing"+(e+1)+".xml",Qb.DRAW),s[s.length]=Dv("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=Zb(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Qb.VML),s[s.length]=Dv("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Ok(e,t,n,r){var a=function(e,t,n){var r=Vy(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;a.hpx?s=20*EE(a.hpx):a.hpt&&(s=20*a.hpt),r.write_shift(2,s),r.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),r.write_shift(1,i),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,f=-1,d=u<<10;d<u+1<<10;++d)c.c=d,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[eb(c)])&&(h<0&&(h=d),f=d);h<0||(++o,r.write_shift(4,h),r.write_shift(4,f))}var p=r.l;return r.l=l,r.write_shift(4,o),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&Wy(e,0,a)}var Pk=Ib,Dk=Rb;function Lk(e){return[yb(e),Ob(e),"n"]}var Mk=Ib,Fk=Rb;var Uk=["left","right","top","bottom","header","footer"];function jk(e,t,n,r,a,s,i){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Mg(t)).z=t.z||Rm[14],t.v=_g(Dg(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=hk(a.cellXfs,t,a),t.l&&s["!links"].push([eb(l),t.l]),t.c&&s["!comments"].push([eb(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=lk(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?Wy(e,18,function(e,t,n){return null==n&&(n=Vy(8)),bb(t,n),n.write_shift(4,t.v),n}(0,l)):Wy(e,7,function(e,t,n){return null==n&&(n=Vy(12)),vb(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",i?Wy(e,17,function(e,t,n){return null==n&&(n=Vy(8+4*e.v.length)),bb(t,n),hb(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):Wy(e,6,function(e,t,n){return null==n&&(n=Vy(12+4*e.v.length)),vb(t,n),hb(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Wy(e,13,function(e,t,n){return null==n&&(n=Vy(8)),bb(t,n),Ab(e.v,n),n}(t,l)):Wy(e,2,function(e,t,n){return null==n&&(n=Vy(12)),vb(t,n),Ab(e.v,n),n}(t,l)):i?Wy(e,16,function(e,t,n){return null==n&&(n=Vy(12)),bb(t,n),Pb(e.v,n),n}(t,l)):Wy(e,5,function(e,t,n){return null==n&&(n=Vy(16)),vb(t,n),Pb(e.v,n),n}(t,l)),!0;case"b":return l.t="b",i?Wy(e,15,function(e,t,n){return null==n&&(n=Vy(5)),bb(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):Wy(e,4,function(e,t,n){return null==n&&(n=Vy(9)),vb(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",i?Wy(e,14,function(e,t,n){return null==n&&(n=Vy(8)),bb(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):Wy(e,3,function(e,t,n){return null==n&&(n=Vy(9)),vb(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return i?Wy(e,12,function(e,t,n){return null==n&&(n=Vy(4)),bb(t,n)}(0,l)):Wy(e,1,function(e,t,n){return null==n&&(n=Vy(8)),vb(t,n)}(0,l)),!0}function zk(e,t){var n,r;t&&t["!merges"]&&(Wy(e,177,(n=t["!merges"].length,null==r&&(r=Vy(4)),r.write_shift(4,n),r)),t["!merges"].forEach(function(t){Wy(e,176,Fk(t))}),Wy(e,178))}function Vk(e,t){t&&t["!cols"]&&(Wy(e,390),t["!cols"].forEach(function(t,n){t&&Wy(e,60,function(e,t,n){null==n&&(n=Vy(18));var r=ck(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}(n,t))}),Wy(e,391))}function Bk(e,t){t&&t["!ref"]&&(Wy(e,648),Wy(e,649,function(e){var t=Vy(24);return t.write_shift(4,4),t.write_shift(4,1),Rb(e,t),t}(rb(t["!ref"]))),Wy(e,650))}function Hk(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=Zb(n,-1,t[1].Target.replace(/#.*$/,""),Qb.HLINK);Wy(e,494,function(e,t){var n=Vy(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Rb({s:Zy(e[0]),e:Zy(e[0])},n),xb("rId"+t,n);var r=e[1].Target.indexOf("#");return hb((-1==r?"":e[1].Target.slice(r+1))||"",n),hb(e[1].Tooltip||"",n),hb("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function Wk(e,t,n){Wy(e,133),Wy(e,137,function(e,t,n){null==n&&(n=Vy(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),Wy(e,138),Wy(e,134)}function qk(e,t){var n,r;t["!protect"]&&Wy(e,535,(n=t["!protect"],null==r&&(r=Vy(66)),r.write_shift(2,n.password?oE(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function $k(e,t,n,r){var a=Hy(),s=n.SheetNames[e],i=n.Sheets[s]||{},o=s;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(h){}var l,c,u=rb(i["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Wy(a,129),(n.vbaraw||i["!outline"])&&Wy(a,147,function(e,t,n){null==n&&(n=Vy(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return Db({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Tb(e,n),n.slice(0,n.l)}(o,i["!outline"])),Wy(a,148,Dk(u)),Wk(a,0,n.Workbook),Vk(a,i),function(e,t,n,r){var a,s=rb(t["!ref"]||"A1"),i="",o=[];Wy(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){i=Xy(u),Ok(e,t,s,u);var h=!1;if(u<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(o[f]=Jy(f)),a=o[f]+i;var d=l?(t[u]||[])[f]:t[a];h=!!d&&jk(e,d,u,f,r,t,h)}}Wy(e,146)}(a,i,0,t),qk(a,i),function(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],s="string"===typeof a.ref?a.ref:nb(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,o=tb(s);o.s.r==o.e.r&&(o.e.r=tb(t["!ref"]).e.r,s=nb(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),Wy(e,161,Rb(rb(s))),Wy(e,162)}}(a,i,n,e),zk(a,i),Hk(a,i,r),i["!margins"]&&Wy(a,476,(l=i["!margins"],null==c&&(c=Vy(48)),uk(l),Uk.forEach(function(e){Pb(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||Bk(a,i),function(e,t,n,r){if(t["!comments"].length>0){var a=Zb(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Qb.VML);Wy(e,551,xb("rId"+a)),t["!legacy"]=a}}(a,i,e,r),Wy(a,130),a.end()}function Gk(e,t,n,r,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])});var a=uv((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[n,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=Jy(o),t[0].forEach(function(e,n){i[c+Xy(n)]={t:"n",v:e,z:t[1]},l=n}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=nb(u)),i}var Kk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Qk=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xk=[],Yk=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Jk(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var s=t[a];if(null==r[s[0]])r[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof r[s[0]]&&(r[s[0]]=yv(r[s[0]]));break;case"int":"string"==typeof r[s[0]]&&(r[s[0]]=parseInt(r[s[0]],10))}}}function Zk(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=yv(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function e_(e){Zk(e.WBProps,Kk),Zk(e.CalcPr,Yk),Jk(e.WBView,Qk),Jk(e.Sheets,Xk),ik.date1904=yv(e.WBProps.date1904)}var t_="][*?/\\".split("");function n_(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return t_.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function r_(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach(function(r,a){n_(r);for(var s=0;s<a;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var i=t&&t[a]&&t[a].CodeName||r;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)dk(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var a_=/<\w+:workbook/;function s_(e){var t=[ev];t[t.length]=Dv("workbook",null,{xmlns:Yv[0],"xmlns:r":Gv});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Kk.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Dv("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&a[s]&&a[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:dv(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Dv("sheet",null,i)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=Dv("definedName",dv(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function i_(e,t){return t||(t=Vy(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),xb(e.strRelID,t),hb(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function o_(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function l_(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,a=t.Workbook.Sheets,s=0,i=-1,o=-1;s<a.length;++s)!a[s]||!a[s].Hidden&&-1==i?i=s:1==a[s].Hidden&&-1==o&&(o=s);if(!(o>i))Wy(e,135),Wy(e,158,(n=i,r||(r=Vy(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),Wy(e,136)}}function c_(e,t){var n=Hy();return Wy(n,131),Wy(n,128,function(e,t){t||(t=Vy(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return hb("SheetJS",t),hb(Kp.version,t),hb(Kp.version,t),hb("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Wy(n,153,function(e,t){t||(t=Vy(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Tb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),l_(n,e),function(e,t){Wy(e,143);for(var n=0;n!=t.SheetNames.length;++n)Wy(e,156,i_({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));Wy(e,144)}(n,e),Wy(n,132),n.end()}function u_(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],X_[16]={n:"BrtFRTArchID$",f:o_},By(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=BS(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:r.push(l),a=!0;break;case 36:case 38:r.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),e_(n),n.Names=s,n.supbooks=i,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},i=0;if(e.replace(rv,function(o,l){var c=iv(o);switch(ov(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(a_)&&(a="xmlns"+o.match(/<(\w+):/)[1]),n.xmlns=c[a];break;case"<fileVersion":delete c[0],n.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Kk.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=yv(c[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:n.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(n.WBProps.CodeName=Sv(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],n.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=uv(Sv(c.name)),delete c[0],n.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(s={}).Name=Sv(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),yv(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=uv(Sv(e.slice(i,l))),n.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],n.CalcPr=c;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===Yv.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return e_(n),n}(e,n)}function h_(e,t,n,r,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,n,r,a,s,i){if(!e)return e;var o=t||{};r||(r={"!id":{}});var l,c,u,h,f,d,p,m,g,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],T=!1,E=!1,S=[];o.biff=12,o["!row"]=0;var k=0,_=!1,x=[],C={},A=o.supbooks||a.supbooks||[[]];if(A.sharedf=C,A.arrayf=x,A.SheetNames=a.SheetNames||a.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=A,a.Names))for(var N=0;N<a.Names.length;++N)A[0][N+1]=a.Names[N];var I,R,O=[],P=[],D=!1;if(X_[16]={n:"BrtShortReal",f:Lk},By(e,function(e,t,N){if(!E)switch(N){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(E=!0),g=Xy(f=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=SE(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=sk[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=Wb[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((h=i.CellXf[e[0].iStyleRef])&&fk(u,h.numFmtId,null,o,s,i),d=-1==e[0].c?d+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][d]=u):y[Jy(d)+g]=u,o.cellFormula){for(_=!1,k=0;k<x.length;++k){var L=x[k];c.r>=L[0].s.r&&c.r<=L[0].e.r&&d>=L[0].s.c&&d<=L[0].e.c&&(u.F=nb(L[0]),_=!0)}!_&&e.length>3&&(u.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>d&&(b.s.c=d),b.e.r<c.r&&(b.e.r=c.r),b.e.c<d&&(b.e.c=d),o.cellDates&&h&&"n"==u.t&&sg(Rm[h.numFmtId])){var M=Lm(u.v);M&&(u.t="d",u.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}I&&("XLDAPR"==I.type&&(u.D=!0),I=void 0),R&&(R=void 0);break;case 1:case 12:if(!o.sheetStubs||T)break;u={t:"z",v:void 0},d=-1==e[0].c?d+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][d]=u):y[Jy(d)+g]=u,b.s.r>c.r&&(b.s.r=c.r),b.s.c>d&&(b.s.c=d),b.e.r<c.r&&(b.e.r=c.r),b.e.c<d&&(b.e.c=d),I&&("XLDAPR"==I.type&&(u.D=!0),I=void 0),R&&(R=void 0);break;case 176:S.push(e);break;case 49:I=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=r["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(d=e.rfx.s.c;d<=e.rfx.e.c;++d)o.dense?(y[f]||(y[f]=[]),y[f][d]||(y[f][d]={t:"z",v:void 0}),y[f][d].l=e):(p=eb({c:d,r:f}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!o.cellFormula)break;x.push(e),(v=o.dense?y[f][d]:y[Jy(d)+g]).f=BS(e[1],0,{r:c.r,c:d},A,o),v.F=nb(e[0]);break;case 427:if(!o.cellFormula)break;C[eb(e[0].s)]=e[1],(v=o.dense?y[f][d]:y[Jy(d)+g]).f=BS(e[1],0,{r:c.r,c:d},A,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)O[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,bE(e.w/256)),wE(O[e.e+1]);break;case 161:y["!autofilter"]={ref:nb(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:T=!0;break;case 36:T=!1;break;case 37:w.push(N),T=!0;break;case 38:w.pop(),T=!1;break;default:if(t.T);else if(!T||o.WTF)throw new Error("Unexpected record 0x"+N.toString(16))}},o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=nb(l||b)),o.sheetRows&&y["!ref"]){var L=rb(y["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=nb(L))}return S.length>0&&(y["!merges"]=S),O.length>0&&(y["!cols"]=O),P.length>0&&(y["!rows"]=P),y}(e,r,n,a,s,i,o):kk(e,r,n,a,s,i,o)}function f_(e,t,n,r,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return By(e,function(e,r,l){switch(l){case 550:s["!rel"]=e;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),e.name&&(a.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(l);break;case 38:i.pop();break;default:if(r.T>0)i.push(l);else if(r.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,r,n,a,s):function(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(Tk);return o&&_k(o[0],0,a,n),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,0,n,a,s)}function d_(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var a in Rm)r.NumberFmt[a]=Rm[a];r.CellXf=[],r.Fonts=[];var s=[],i=!1;return By(e,function(e,a,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],ug(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=dE(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&r.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!i||n.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,n,r):CE(e,n,r)}function p_(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return By(e,function(e,a,s){switch(s){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var a=e.match(qT);if(a){r=a[2].replace($T,"").split(GT);for(var s=0;s!=r.length;++s){var i=WT(r[s].trim(),t);null!=i&&(n[n.length]=i)}a=iv(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}(e,n)}function m_(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],a={},s=!1;return By(e,function(e,i,o){switch(o){case 632:r.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var s=iv(a[0]),i={author:s.authorId&&n[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=Zy(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&WT(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),r.push(i)}}}}),r}(e,n)}function g_(e,t,n){return".bin"===t.slice(-4)?function(e){var t=[];return By(e,function(e,n,r){if(63===r)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+r.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(rv)||[]).forEach(function(e){var r=iv(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}}),t}(e)}function v_(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var a=r||{},s=!1;By(e,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}},a)}(e,0,0,r)}function y_(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},s=[],i=!1,o=2;return By(e,function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(n),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}}),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a,s=!1,i=2;return e.replace(rv,function(e){var t=iv(e);switch(ov(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(a=r.Types[o]);break;case"<rc":1==i?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==i&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),r}(e,0,n)}function b_(e,t,n,r,a){return(".bin"===t.slice(-4)?$k:Rk)(e,n,r,a)}function w_(e,t,n){return(".bin"===t.slice(-4)?cS:iS)(e,n)}var T_,E_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,S_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function k_(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var a,s,i,o=e.match(E_);if(o)for(i=0;i!=o.length;++i)-1===(s=(a=o[i].match(S_))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return r}function __(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,a,s=e.match(E_);if(s)for(a=0;a!=s.length;++a)-1===(r=(n=s[a].match(S_))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function x_(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=yv(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Dg(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[uv(t)]=a}function C_(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||Wb[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Vm(e.v):e.w=Bm(e.v):e.w=function(e,t){var n=T_[e]||uv(e);return"General"===n?Bm(t):cg(n,t)}(t||"General",e.v)}catch(s){if(n.WTF)throw s}try{var r=T_[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&sg(r)){var a=Lm(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(n.WTF)throw s}}}function A_(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=kE[r.Pattern]||r.Pattern)}e[t.ID]=t}function N_(e,t,n,r,a,s,i,o,l,c){var u="General",h=r.StyleID,f={};c=c||{};var d=[],p=0;for(void 0===h&&o&&(h=o.StyleID),void 0===h&&i&&(h=i.StyleID);void 0!==s[h]&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&d.push(s[h].Interior),s[h].Parent);)h=s[h].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=yv(e);break;case"String":r.t="s",r.r=vv(uv(e)),r.v=e.indexOf("<")>-1?uv(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(Dg(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=uv(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=qb[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=vv(t||e))}if(C_(r,u,c),!1!==c.cellFormula)if(r.Formula){var m=uv(r.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),r.f=hS(m,a),delete r.Formula,"RC"==r.ArrayRange?r.F=hS("RC:RC",a):r.ArrayRange&&(r.F=hS(r.ArrayRange,a),l.push([rb(r.F),r.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(r.F=l[p][1]);c.cellStyles&&(d.forEach(function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)}),r.s=f),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function I_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function R_(e,t){var n=t||{};fg();var r=sm(Mv(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof am?am.utils.decode(65001,nm(r)):Sv(r));var a,s=r.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=Mg(n);return o.type="string",FT.to_workbook(r,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return ib(lx(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach(function(e,n){xC(r,lx(e,t),"Sheet"+(n+1))}),r}(r,n);T_={"General Number":"General","General Date":Rm[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Rm[15],"Short Date":Rm[14],"Long Time":Rm[19],"Medium Time":Rm[18],"Short Time":Rm[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Rm[2],Standard:Rm[4],Percent:Rm[10],Scientific:Rm[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,h={},f=[],d=n.dense?[]:{},p="",m={},g={},v=k_('<Data ss:Type="String">'),y=0,b=0,w=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},S={},k="",_=0,x=[],C={},A={},N=0,I=[],R=[],O={},P=[],D=!1,L=[],M=[],F={},U=0,j=0,z={Sheets:[],WBProps:{date1904:!1}},V={};Fv.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var B="";a=Fv.exec(r);)switch(a[3]=(B=a[3]).toLowerCase()){case"data":if("data"==B){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?N_(r.slice(y,a.index),k,v,"comment"==c[c.length-1][0]?O:m,{c:b,r:w},E,P[b],g,L,n):(k="",v=k_(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(R.length>0&&(m.c=R),(!n.sheetRows||n.sheetRows>w)&&void 0!==m.v&&(n.dense?(d[w]||(d[w]=[]),d[w][b]=m):d[Jy(b)+Xy(w)]=m),m.HRef&&(m.l={Target:uv(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(U=b+(0|parseInt(m.MergeAcross,10)),j=w+(0|parseInt(m.MergeDown,10)),x.push({s:{c:b,r:w},e:{c:U,r:j}})),n.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var H=b;H<=U;++H)for(var W=w;W<=j;++W)(H>b||W>w)&&(n.dense?(d[W]||(d[W]=[]),d[W][H]={t:"z"}):d[Jy(H)+Xy(W)]={t:"z"});b=U+1}else++b;else m.MergeAcross?b=U+1:++b;else(m=__(a[0])).Index&&(b=+m.Index-1),b<T.s.c&&(T.s.c=b),b>T.e.c&&(T.e.c=b),"/>"===a[0].slice(-2)&&++b,R=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<T.s.r&&(T.s.r=w),w>T.e.r&&(T.e.r=w),"/>"===a[0].slice(-2)&&(g=k_(a[0])).Index&&(w=+g.Index-1),b=0,++w):((g=k_(a[0])).Index&&(w=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=EE(F.hpx),M[w]=F),"1"==g.Hidden&&(F.hidden=!0,M[w]=F));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));f.push(p),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(d["!ref"]=nb(T),n.sheetRows&&n.sheetRows<=T.e.r&&(d["!fullref"]=d["!ref"],T.e.r=n.sheetRows-1,d["!ref"]=nb(T))),x.length&&(d["!merges"]=x),P.length>0&&(d["!cols"]=P),M.length>0&&(d["!rows"]=M),h[p]=d}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([a[3],!1]),l=k_(a[0]),p=uv(l.Name),d=n.dense?[]:{},x=[],L=[],M=[],V={name:p,Hidden:0},z.Sheets.push(V);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),P=[],D=!1}break;case"style":"/"===a[1]?A_(E,S,n):S=k_(a[0]);break;case"numberformat":S.nf=uv(k_(a[0]).Format||"General"),T_[S.nf]&&(S.nf=T_[S.nf]);for(var q=0;392!=q&&Rm[q]!=S.nf;++q);if(392==q)for(q=57;392!=q;++q)if(null==Rm[q]){ug(S.nf,q);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=k_(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!D&&u.wpx>10){D=!0,pE=6;for(var $=0;$<P.length;++$)P[$]&&wE(P[$])}D&&wE(u),P[u.Index-1||P.length]=u;for(var G=0;G<+u.Span;++G)P[P.length]=Mg(u);break;case"namedrange":if("/"===a[1])break;z.Names||(z.Names=[]);var K=iv(a[0]),Q={Name:K.Name,Ref:hS(K.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(Q.Sheet=z.Sheets.length-1),z.Names.push(Q);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?k+=r.slice(_,a.index):_=a.index+a[0].length;break;case"interior":if(!n.cellStyles)break;S.Interior=k_(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?gw(C,B,r.slice(N,a.index)):N=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));I_(O),R.push(O)}else c.push([a[3],!1]),O={a:(l=k_(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var X=k_(a[0]);d["!autofilter"]={ref:hS(X.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return Tx(r,n);if(0==c.length&&"uof"==a[3])return Tx(r,n);var Y=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Y=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Y=!1}break;case"excelworkbook":switch(a[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Y=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:Y=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(r.slice(N,a.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2}else N=a.index+a[0].length;break;case"header":d["!margins"]||uk(d["!margins"]={},"xlml"),isNaN(+iv(a[0]).Margin)||(d["!margins"].header=+iv(a[0]).Margin);break;case"footer":d["!margins"]||uk(d["!margins"]={},"xlml"),isNaN(+iv(a[0]).Margin)||(d["!margins"].footer=+iv(a[0]).Margin);break;case"pagemargins":var J=iv(a[0]);d["!margins"]||uk(d["!margins"]={},"xlml"),isNaN(+J.Top)||(d["!margins"].top=+J.Top),isNaN(+J.Left)||(d["!margins"].left=+J.Left),isNaN(+J.Right)||(d["!margins"].right=+J.Right),isNaN(+J.Bottom)||(d["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;default:Y=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Y=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Y=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Y=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Y=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Y=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Y=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Y=!1}break;case"smarttags":break;default:Y=!1}if(Y)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?x_(A,B,I,r.slice(N,a.index)):(I=a,N=a.index+a[0].length);break}if(n.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var Z={};return n.bookSheets||n.bookProps||(Z.Sheets=h),Z.SheetNames=f,Z.Workbook=z,Z.SSF=Mg(Rm),Z.Props=C,Z.Custprops=A,Z}function O_(e,t){switch(Zx(t=t||{}),t.type||"base64"){case"base64":return R_(um(e),t);case"binary":case"buffer":case"file":return R_(e,t);case"array":return R_(vm(e),t)}}function P_(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return wg(mw).map(function(e){for(var t=0;t<rw.length;++t)if(rw[t][1]==e)return rw[t];for(t=0;t<lw.length;++t)if(lw[t][1]==e)return lw[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(Ov(mw[r[1]]||r[1],a))}}),Dv("DocumentProperties",n.join(""),{xmlns:Jv})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&wg(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<rw.length;++r)if(t==rw[r][1])return;for(r=0;r<lw.length;++r)if(t==lw[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var s=e[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s=String(s),a.push(Dv(pv(t),s,{"dt:dt":i}))}}),t&&wg(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],s="string";"number"==typeof r?(s="float",r=String(r)):!0===r||!1===r?(s="boolean",r=r?"1":"0"):r instanceof Date?(s="dateTime.tz",r=r.toISOString()):r=String(r),a.push(Dv(pv(n),r,{"dt:dt":s}))}}),"<"+r+' xmlns="'+Jv+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function D_(e){return Dv("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+dS(e.Ref,{r:0,c:0})})}function L_(e,t,n,r,a,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+dv(dS(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Zy(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=dv(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=dv(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==i.c&&c[u].s.r==i.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Wb[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Rm[14]);break;case"s":h="String",f=((e.v||"")+"").replace(hv,function(e){return cv[e]}).replace(mv,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var d=hk(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=i.c+1;var p=null!=e.v?f:"",m="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map(function(e){var t=Dv("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Dv("Comment",t,{"ss:Author":e.a})}).join("")),Dv("Cell",m,o)}function M_(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=SE(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function F_(e,t,n){var r=[],a=n.SheetNames[e],s=n.Sheets[a],i=s?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||s.push(D_(o)))}return s.join("")}(s,0,e,n):"";return i.length>0&&r.push("<Names>"+i+"</Names>"),i=s?function(e,t){if(!e["!ref"])return"";var n=rb(e["!ref"]),r=e["!merges"]||[],a=0,s=[];e["!cols"]&&e["!cols"].forEach(function(e,t){wE(e);var n=!!e.width,r=ck(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=mE(r.width)),e.hidden&&(a["ss:Hidden"]="1"),s.push(Dv("Column",null,a))});for(var i=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var l=[M_(o,(e["!rows"]||[])[o])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(a=0;a!=r.length;++a)if(!(r[a].s.c>c)&&!(r[a].s.r>o)&&!(r[a].e.c<c)&&!(r[a].e.r<o)){r[a].s.c==c&&r[a].s.r==o||(u=!0);break}if(!u){var h={r:o,c:c},f=eb(h),d=i?(e[o]||[])[c]:e[f];l.push(L_(d,f,e,t,0,0,h))}}l.push("</Row>"),l.length>2&&s.push(l.join(""))}return s.join("")}(s,t):"",i.length>0&&r.push("<Table>"+i+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Dv("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Dv("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Dv("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(Dv("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&(!r.Workbook.Sheets[s]||r.Workbook.Sheets[s].Hidden);++s);s==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ov("ProtectContents","True")),e["!protect"].objects&&a.push(Ov("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ov("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(Ov("EnableSelection","UnlockedCells")):a.push(Ov("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":Dv("WorksheetOptions",a.join(""),{xmlns:Zv})}(s,0,e,n)),r.join("")}function U_(e,t){t||(t={}),e.SSF||(e.SSF=Mg(Rm)),e.SSF&&(fg(),hg(e.SSF),t.revssf=Sg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],hk(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(P_(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Dv("Worksheet",F_(r,t,e),{"ss:Name":dv(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(Dv("NumberFormat",null,{"ss:Format":dv(Rm[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};n.push(Dv("Style",r.join(""),a))}),Dv("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||n.push(D_(a)))}return Dv("Names",n.join(""))}(e),ev+Dv("Workbook",n.join(""),{xmlns:ey,"xmlns:o":Jv,"xmlns:x":Zv,"xmlns:ss":ey,"xmlns:dt":ty,"xmlns:html":ay})}function j_(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Lb(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Lb(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var z_=[60,1084,2066,2165,2175];function V_(e,t,n,r,a){var s=r,i=[],o=n.slice(n.l,n.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}i.push(o),n.l+=s;for(var l=Ay(n,n.l),c=Y_[l],u=0;null!=c&&z_.indexOf(l)>-1;)s=Ay(n,n.l+2),u=n.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),o=n.slice(u,n.l+4+s),i.push(o),n.l+=4+s,c=Y_[l=Ay(n,n.l)];var h=bm(i);jy(h,0);var f=0;h.lens=[];for(var d=0;d<i.length;++d)h.lens.push(f),f+=i[d].length;if(h.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+r;return t.f(h,h.length,a)}function B_(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Rm[r])}catch(s){if(t.WTF)throw s}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Wb[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Vm(e.v):e.w=Bm(e.v):e.w=cg(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&r&&"n"==e.t&&sg(Rm[r]||String(r))){var a=Lm(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function H_(e,t,n){return{v:e,ixfe:t,t:n}}function W_(e,t){var n={opts:{}},r={};var a,s,i,o,l,c,u,h,f=t.dense?[]:{},d={},p={},m=null,g=[],v="",y={},b="",w={},T=[],E=[],S=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},x=function(e){return e<8?Hb[e]:e<64&&S[e-8]||Hb[e]},C=function(e,t,n){if(!(F>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,a=t.XF.data;a&&a.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=a.patternType,(r=fE(x(a.icvFore)))&&(t.s.fgColor={rgb:r}),(r=fE(x(a.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,a=e,b=eb(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<T.length;++r)if(!(T[r][0].s.c>e.c||T[r][0].s.r>e.r)&&!(T[r][0].e.c<e.c||T[r][0].e.r<e.r)){t.F=nb(T[r][0]),T[r][0].s.c==e.c&&T[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+BS(T[r][1],0,e,D,A));break}n.dense?(f[e.r]||(f[e.r]=[]),f[e.r][e.c]=t):f[b]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var N=[],I=[],R=[],O=[],P=!1,D=[];D.SheetNames=A.snames,D.sharedf=A.sharedf,D.arrayf=A.arrayf,D.names=[],D.XTI=[];var L,M=0,F=0,U=0,j=[],z=[];A.codepage=1200,em(1200);for(var V=!1;e.l<e.length-1;){var B=e.l,H=e.read_shift(2);if(0===H&&10===M)break;var W=e.l===e.length?0:e.read_shift(2),q=Y_[H];if(q&&q.f){if(t.bookSheets&&133===M&&133!==H)break;if(M=H,2===q.r||12==q.r){var $=e.read_shift(2);if(W-=2,!A.enc&&$!==H&&((255&$)<<8|$>>8)!==H)throw new Error("rt mismatch: "+$+"!="+H);12==q.r&&(e.l+=10,W-=10)}var G={};if(G=10===H?q.f(e,W,A):V_(H,q,e,W,A),0==F&&-1===[9,521,1033,2057].indexOf(M))continue;switch(H){case 34:n.opts.Date1904=k.WBProps.date1904=G;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=G,!t.password)throw new Error("File is password-protected");if(null==G.valid)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=G;break;case 66:var K=Number(G);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252}em(A.codepage=K),V=!0;break;case 317:A.rrtabid=G;break;case 25:A.winlocked=G;break;case 439:n.opts.RefreshAll=G;break;case 12:n.opts.CalcCount=G;break;case 16:n.opts.CalcDelta=G;break;case 17:n.opts.CalcIter=G;break;case 13:n.opts.CalcMode=G;break;case 14:n.opts.CalcPrecision=G;break;case 95:n.opts.CalcSaveRecalc=G;break;case 15:A.CalcRefMode=G;break;case 2211:n.opts.FullCalc=G;break;case 129:G.fDialog&&(f["!type"]="dialog"),G.fBelow||((f["!outline"]||(f["!outline"]={})).above=!0),G.fRight||((f["!outline"]||(f["!outline"]={})).left=!0);break;case 224:E.push(G);break;case 430:D.push([G]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(G);break;case 24:case 536:L={Name:G.Name,Ref:BS(G.rgce,0,null,D,A)},G.itab>0&&(L.Sheet=G.itab-1),D.names.push(L),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(G),"_xlnm._FilterDatabase"==G.Name&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&"PtgArea3d"==G.rgce[0][0][0]&&(z[G.itab-1]={ref:nb(G.rgce[0][0][1][2])});break;case 22:A.ExternCount=G;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(G),D.XTI=D.XTI.concat(G);break;case 2196:if(A.biff<8)break;null!=L&&(L.Comment=G[1]);break;case 18:f["!protect"]=G;break;case 19:0!==G&&A.WTF&&console.error("Password verifier: "+G);break;case 133:d[G.pos]=G,A.snames.push(G.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,f["!ref"]=nb(p),t.sheetRows&&t.sheetRows<=p.e.r){var Q=p.e.r;p.e.r=t.sheetRows-1,f["!fullref"]=f["!ref"],f["!ref"]=nb(p),p.e.r=Q}p.e.r++,p.e.c++}N.length>0&&(f["!merges"]=N),I.length>0&&(f["!objects"]=I),R.length>0&&(f["!cols"]=R),O.length>0&&(f["!rows"]=O),k.Sheets.push(_)}""===v?y=f:r[v]=f,f=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),A.biffguess=0==G.BIFFVer,0==G.BIFFVer&&4096==G.dt&&(A.biff=5,V=!0,em(A.codepage=28591)),8==A.biff&&0==G.BIFFVer&&16==G.dt&&(A.biff=2),F++)break;if(f=t.dense?[]:{},A.biff<8&&!V&&(V=!0,em(A.codepage=t.codepage||1252)),A.biff<5||0==G.BIFFVer&&4096==G.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-W,name:v};d[X.pos]=X,A.snames.push(v)}else v=(d[B]||{name:""}).name;32==G.dt&&(f["!type"]="chart"),64==G.dt&&(f["!type"]="macro"),N=[],I=[],A.arrayf=T=[],R=[],O=[],P=!1,_={Hidden:(d[B]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==f["!type"]&&(t.dense?(f[G.r]||[])[G.c]:f[eb({c:G.c,r:G.r})])&&++G.c,c={ixfe:G.ixfe,XF:E[G.ixfe]||{},v:G.val,t:"n"},U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:G.c,r:G.r},c,t);break;case 5:case 517:c={ixfe:G.ixfe,XF:E[G.ixfe],v:G.val,t:G.t},U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:G.c,r:G.r},c,t);break;case 638:c={ixfe:G.ixfe,XF:E[G.ixfe],v:G.rknum,t:"n"},U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:G.c,r:G.r},c,t);break;case 189:for(var Y=G.c;Y<=G.C;++Y){var J=G.rkrec[Y-G.c][0];c={ixfe:J,XF:E[J],v:G.rkrec[Y-G.c][1],t:"n"},U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:Y,r:G.r},c,t)}break;case 6:case 518:case 1030:if("String"==G.val){m=G;break}if((c=H_(G.val,G.cell.ixfe,G.tt)).XF=E[c.ixfe],t.cellFormula){var Z=G.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],ne=eb({r:ee,c:te});w[ne]?c.f=""+BS(G.formula,0,G.cell,D,A):c.F=((t.dense?(f[ee]||[])[te]:f[ne])||{}).F}else c.f=""+BS(G.formula,0,G.cell,D,A)}U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C(G.cell,c,t),m=G;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=G,(c=H_(G,m.cell.ixfe,"s")).XF=E[c.ixfe],t.cellFormula&&(c.f=""+BS(m.formula,0,m.cell,D,A)),U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C(m.cell,c,t),m=null;break;case 33:case 545:T.push(G);var re=eb(G[0].s);if(s=t.dense?(f[G[0].s.r]||[])[G[0].s.c]:f[re],t.cellFormula&&s){if(!m)break;if(!re||!s)break;s.f=""+BS(G[1],0,G[0],D,A),s.F=nb(G[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!m)break;w[eb(m.cell)]=G[0],((s=t.dense?(f[m.cell.r]||[])[m.cell.c]:f[eb(m.cell)])||{}).f=""+BS(G[0],0,a,D,A)}break;case 253:c=H_(g[G.isst].t,G.ixfe,"s"),g[G.isst].h&&(c.h=g[G.isst].h),c.XF=E[c.ixfe],U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:G.c,r:G.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:G.ixfe,XF:E[G.ixfe],t:"z"},U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:G.c,r:G.r},c,t));break;case 190:if(t.sheetStubs)for(var ae=G.c;ae<=G.C;++ae){var se=G.ixfe[ae-G.c];c={ixfe:se,XF:E[se],t:"z"},U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:ae,r:G.r},c,t)}break;case 214:case 516:case 4:(c=H_(G.val,G.ixfe,"s")).XF=E[c.ixfe],U>0&&(c.z=j[c.ixfe>>8&63]),B_(c,t,n.opts.Date1904),C({c:G.c,r:G.r},c,t);break;case 0:case 512:1===F&&(p=G);break;case 252:g=G;break;case 1054:if(4==A.biff){j[U++]=G[1];for(var ie=0;ie<U+163&&Rm[ie]!=G[1];++ie);ie>=163&&ug(G[1],U+163)}else ug(G[1],G[0]);break;case 30:j[U++]=G;for(var oe=0;oe<U+163&&Rm[oe]!=G;++oe);oe>=163&&ug(G,U+163);break;case 229:N=N.concat(G);break;case 93:I[G.cmo[0]]=A.lastobj=G;break;case 438:A.lastobj.TxO=G;break;case 127:A.lastobj.ImData=G;break;case 440:for(l=G[0].s.r;l<=G[0].e.r;++l)for(o=G[0].s.c;o<=G[0].e.c;++o)(s=t.dense?(f[l]||[])[o]:f[eb({c:o,r:l})])&&(s.l=G[1]);break;case 2048:for(l=G[0].s.r;l<=G[0].e.r;++l)for(o=G[0].s.c;o<=G[0].e.c;++o)(s=t.dense?(f[l]||[])[o]:f[eb({c:o,r:l})])&&s.l&&(s.l.Tooltip=G[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;s=t.dense?(f[G[0].r]||[])[G[0].c]:f[eb(G[0])];var le=I[G[2]];s||(t.dense?(f[G[0].r]||(f[G[0].r]=[]),s=f[G[0].r][G[0].c]={t:"z"}):s=f[eb(G[0])]={t:"z"},p.e.r=Math.max(p.e.r,G[0].r),p.s.r=Math.min(p.s.r,G[0].r),p.e.c=Math.max(p.e.c,G[0].c),p.s.c=Math.min(p.s.c,G[0].c)),s.c||(s.c=[]),i={a:G[1],t:le.TxO.t},s.c.push(i);break;case 2173:eS(E[G.ixfe],G.ext);break;case 125:if(!A.cellStyles)break;for(;G.e>=G.s;)R[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(1&G.flags)},P||(P=!0,bE(G.w/256)),wE(R[G.e+1]);break;case 520:var ce={};null!=G.level&&(O[G.r]=ce,ce.level=G.level),G.hidden&&(O[G.r]=ce,ce.hidden=!0),G.hpt&&(O[G.r]=ce,ce.hpt=G.hpt,ce.hpx=SE(G.hpt));break;case 38:case 39:case 40:case 41:f["!margins"]||uk(f["!margins"]={}),f["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=G;break;case 161:f["!margins"]||uk(f["!margins"]={}),f["!margins"].header=G.header,f["!margins"].footer=G.footer;break;case 574:G.RTL&&(k.Views[0].RTL=!0);break;case 146:S=G;break;case 2198:h=G;break;case 140:u=G;break;case 442:v?_.CodeName=G||_.name:k.WBProps.CodeName=G||"ThisWorkbook"}}else q||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=W}return n.SheetNames=wg(d).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return d[e].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&y["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=y)):n.Preamble=y,n.Sheets&&z.forEach(function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e}),n.Strings=g,n.SSF=Mg(Rm),A.enc&&(n.Encryption=A.enc),h&&(n.Themes=h),n.Metadata={},void 0!==u&&(n.Metadata.Country=u),D.names.length>0&&(k.Names=D.names),n.Workbook=k,n}var q_="e0859ff2f94f6810ab9108002b27b3d9",$_="02d5cdd59c2e1b10939708002b2cf9ae",G_="05d5cdd59c2e1b10939708002b2cf9ae";function K_(e,t){var n,r,a,s;if(t||(t={}),Zx(t),tm(),t.codepage&&Zp(t.codepage),e.FullPaths){if(gg.find(e,"/encryption"))throw new Error("File is password-protected");n=gg.find(e,"!CompObj"),r=gg.find(e,"/Workbook")||gg.find(e,"/Book")}else{switch(t.type){case"base64":e=mm(um(e));break;case"binary":e=mm(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}jy(e,0),r={content:e}}if(n&&j_(n),t.bookProps&&!t.bookSheets)a={};else{var i=hm?"buffer":"array";if(r&&r.content)a=W_(r.content,t);else if((s=gg.find(e,"PerfectOffice_MAIN"))&&s.content)a=UT.to_workbook(s.content,(t.type=i,t));else{if(!(s=gg.find(e,"NativeContent_MAIN"))||!s.content)throw(s=gg.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=UT.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&gg.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=gg.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");gg.utils.cfb_add(t,a,e.FileIndex[r].content)}}),gg.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,n){var r=gg.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Rw(r,Ub,$_);for(var s in a)t[s]=a[s]}catch(c){if(n.WTF)throw c}var i=gg.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Rw(i,jb,q_);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(c){if(n.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(uw(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function Q_(e,t){var n=t||{},r=gg.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return gg.utils.cfb_add(r,a,ox(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],a=[],s=[],i=0,o=Tg(Ub,"n"),l=Tg(jb,"n");if(e.Props)for(n=wg(e.Props),i=0;i<n.length;++i)(Object.prototype.hasOwnProperty.call(o,n[i])?r:Object.prototype.hasOwnProperty.call(l,n[i])?a:s).push([n[i],e.Props[n[i]]]);if(e.Custprops)for(n=wg(e.Custprops),i=0;i<n.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},n[i])||(Object.prototype.hasOwnProperty.call(o,n[i])?r:Object.prototype.hasOwnProperty.call(l,n[i])?a:s).push([n[i],e.Custprops[n[i]]]);var c=[];for(i=0;i<s.length;++i)Aw.indexOf(s[i][0])>-1||cw.indexOf(s[i][0])>-1||null!=s[i][1]&&c.push(s[i]);a.length&&gg.utils.cfb_add(t,"/\x05SummaryInformation",Ow(a,q_,l,jb)),(r.length||c.length)&&gg.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Ow(r,$_,o,Ub,c.length?c:null,G_))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&gg.utils.cfb_add(e,a,t.FileIndex[r].content)}})}(r,gg.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var X_={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,7&s&&(n.level=7&s),16&s&&(n.hidden=!0),32&s&&(n.hpt=a/20),n}},1:{f:function(e){return[gb(e)]}},2:{f:function(e){return[gb(e),Cb(e),"n"]}},3:{f:function(e){return[gb(e),e.read_shift(1),"e"]}},4:{f:function(e){return[gb(e),e.read_shift(1),"b"]}},5:{f:function(e){return[gb(e),Ob(e),"n"]}},6:{f:function(e){return[gb(e),ub(e),"str"]}},7:{f:function(e){return[gb(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=gb(e);a.r=n["!row"];var s=[a,ub(e),"str"];if(n.cellFormula){e.l+=2;var i=QS(e,r-e.l,n);s[3]=BS(i,0,a,n.supbooks,n)}else e.l=r;return s}},9:{f:function(e,t,n){var r=e.l+t,a=gb(e);a.r=n["!row"];var s=[a,Ob(e),"n"];if(n.cellFormula){e.l+=2;var i=QS(e,r-e.l,n);s[3]=BS(i,0,a,n.supbooks,n)}else e.l=r;return s}},10:{f:function(e,t,n){var r=e.l+t,a=gb(e);a.r=n["!row"];var s=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var i=QS(e,r-e.l,n);s[3]=BS(i,0,a,n.supbooks,n)}else e.l=r;return s}},11:{f:function(e,t,n){var r=e.l+t,a=gb(e);a.r=n["!row"];var s=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var i=QS(e,r-e.l,n);s[3]=BS(i,0,a,n.supbooks,n)}else e.l=r;return s}},12:{f:function(e){return[yb(e)]}},13:{f:function(e){return[yb(e),Cb(e),"n"]}},14:{f:function(e){return[yb(e),e.read_shift(1),"e"]}},15:{f:function(e){return[yb(e),e.read_shift(1),"b"]}},16:{f:Lk},17:{f:function(e){return[yb(e),ub(e),"str"]}},18:{f:function(e){return[yb(e),e.read_shift(4),"s"]}},19:{f:db},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=kb(e),i=XS(e,0,n),o=Eb(e);e.l=r;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(r.underline=s);var i=e.read_shift(1);i>0&&(r.family=i);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=Hb[r];l&&(t.rgb=fE(l));break;case 2:t.rgb=fE([s,i,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=ub(e),r}},44:{f:function(e,t){return[e.read_shift(2),ub(e)]}},45:{f:PE},46:{f:FE},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:AT},62:{f:function(e){return[gb(e),db(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=eb(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zy,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=wb(e,t-19),n}},148:{f:Pk,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?ub(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=_b(e,t-8),n.name=ub(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Ib},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Mk},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ub(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_b},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ST},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=Nb(e),s=e.read_shift(1),i=[a];if(i[2]=s,n.cellFormula){var o=KS(e,r-e.l,n);i[1]=o}else e.l=r;return i}},427:{f:function(e,t,n){var r=e.l+t,a=[Ib(e,16)];if(n.cellFormula){var s=YS(e,r-e.l,n);a[1]=s,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Uk.forEach(function(n){t[n]=Ob(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=Ib(e,16),a=Eb(e),s=ub(e),i=ub(e),o=ub(e);e.l=n;var l={rfx:r,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_b},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lS},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=Ib(e,16);return t.rfx=n.s,t.ref=eb(n.s),e.l+=16,t}},636:{T:-1},637:{f:pb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:ub(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Y_={6:{f:qS},10:{f:Pw},12:{f:Mw},13:{f:Mw},14:{f:Dw},15:{f:Dw},16:{f:Ob},17:{f:Dw},18:{f:Dw},19:{f:Mw},20:{f:bT},21:{f:bT},23:{f:ST},24:{f:ET},25:{f:Dw},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=qw(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:a},o,i,s]}}(e,0,n)}},29:{},34:{f:Dw},35:{f:wT},38:{f:Ob},39:{f:Ob},40:{f:Ob},41:{f:Ob},42:{f:Dw},43:{f:Dw},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?uE(e,t-2,r):function(e,t,n,r){var a={key:Mw(e),verificationBytes:Mw(e)};n.password&&(a.verifier=oE(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=cE(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=zw(e,0,n),r}},51:{f:Mw},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Dw},65:{f:function(){}},66:{f:Mw},77:{},80:{},81:{},82:{},85:{f:Mw},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=qw(e,0,n);return e.read_shift(t+r-e.l),a}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((_T[r]||zy)(e,t,n)),{cmo:[a,r,s],ft:i}}(e,t,n);var r=oT(e),a=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(cT[a](e,n-e.l))}catch(s){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:a}}},94:{},95:{f:Dw},96:{},97:{},99:{f:Dw},125:{f:AT},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Mw},131:{f:Dw},132:{f:Dw},133:{f:function(e,t,n){var r=e.read_shift(4),a=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=zw(e,0,n);return 0===i.length&&(i="Sheet1"),{pos:r,hs:a,dt:s,name:i}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=zb[t]||t,t=e.read_shift(2),n[1]=zb[t]||t,n}},141:{f:Mw},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Jw(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:Mw},157:{},158:{},160:{f:IT},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=Ob(e),n.footer=Ob(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),s=[];e.l<n;)s.push(nT(e));if(e.l!==n)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:r,c:a,C:i,rkrec:s}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),s=[];e.l<n;)s.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:r,c:a,C:i,ixfe:s}}},193:{f:Pw},197:{},198:{},199:{},200:{},201:{},202:{f:Dw},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mw},220:{},221:{f:Dw},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Vb[o>>26],r.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&i,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Pw},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(rT(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<n;++i)s.push(Vw(e));return s.Count=r,s.Unique=a,s}},253:{f:function(e){var t=Zw(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Uw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dw},353:{f:Pw},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(n.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Hw(e,s),o=[];r>e.l;)o.push(Ww(e));return[s,a,i,o]}},431:{f:Dw},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,a="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var i=e.read_shift(2);e.read_shift(2),Mw(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=Hw(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(a.length!==i&&a.length!==2*i)throw new Error("cchText: "+i+" != "+a.length);return e.l=r+t,{t:a}}catch(u){return e.l=r+t,{t:a}}}},439:{f:Dw},440:{f:function(e,t){var n=rT(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c,u,h="";16&a&&(s=Kw(e,e.l)),128&a&&(i=Kw(e,e.l)),257===(257&a)&&(o=Kw(e,e.l)),1===(257&a)&&(l=Gw(e,e.l)),8&a&&(h=Kw(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(u=vw(e)),e.l=n;var f=i||o||l||"";f&&h&&(f+="#"+h),f||(f="#"+h),2&a&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var d={Target:f};return c&&(d.guid=c),u&&(d.time=u),s&&(d.Tooltip=s),d}(e,t-24);return[n,r]}},441:{},442:{f:Ww},443:{},444:{f:Mw},445:{},446:{},448:{f:Pw},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Pw},512:{f:gT},513:{f:NT},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=Zw(e),a=Ob(e);return r.val=a,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=Zw(e);2==n.biff&&e.l++;var a=Ww(e,e.l,n);return r.val=a,r}},517:{f:yT},519:{f:RT},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:kT},549:{f:dT},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=nT(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),qw(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=sT(e);e.l++;var a=e.read_shift(1);return[WS(e,t-=8,n),a,r]}},2048:{f:function(e,t){e.read_shift(2);var n=rT(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(wm,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:uT},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Pw},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),a=[];r-- >0;)a.push(ZE(e,e.l));return{ixfe:n,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dw,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2);return[Hw(e,r,n),Hw(e,a,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var a,s=e.slice(e.l);e.l=r;try{a=Jg(s,{type:"array"})}catch(o){return}var i=Gg(a,"theme/theme/theme1.xml",!0);if(i)return XE(i,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Pw},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mw},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,16&a&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Jw(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gT},1:{},2:{f:function(e){var t=Zw(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=Zw(e);++e.l;var n=Ob(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=Zw(e);++e.l;var a=qw(e,0,n);return r.t="str",r.val=a,r}},5:{f:yT},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:uT},11:{},22:{f:Mw},30:{f:mT},31:{},32:{},33:{f:kT},36:{},37:{f:dT},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Mw},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,a=Zw(e),s=e.read_shift(2),i=Hw(e,s,n);return e.l=r,a.t="str",a.val=i,a}},223:{},234:{},354:{},421:{},518:{f:qS},521:{f:uT},536:{f:ET},547:{f:wT},561:{},579:{},1030:{f:qS},1033:{f:uT},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function J_(e,t,n,r){var a=t;if(!isNaN(a)){var s=r||(n||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&_y(n)&&e.push(n)}}function Z_(e,t,n){return e||(e=Vy(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function ex(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?_g(Dg(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?J_(e,2,function(e,t,n){var r=Vy(9);return Z_(r,e,t),r.write_shift(2,n),r}(n,r,a)):J_(e,3,function(e,t,n){var r=Vy(15);return Z_(r,e,t),r.write_shift(8,n,"f"),r}(n,r,a)));case"b":case"e":return void J_(e,5,function(e,t,n,r){var a=Vy(9);return Z_(a,e,t),jw(n,r||"b",a),a}(n,r,t.v,t.t));case"s":case"str":return void J_(e,4,function(e,t,n){var r=Vy(8+2*n.length);return Z_(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}J_(e,1,Z_(null,n,r))}function tx(e,t){var n=t||{};for(var r=Hy(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(a=s);if(0==a&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return J_(r,4==n.biff?1033:3==n.biff?521:9,hT(0,16,n)),function(e,t,n,r){var a,s=Array.isArray(t),i=rb(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=nb(i)}for(var c=i.s.r;c<=i.e.r;++c){o=Xy(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=Jy(u)),a=l[u]+o;var h=s?(t[c]||[])[u]:t[a];h&&ex(e,h,c,u)}}}(r,e.Sheets[e.SheetNames[a]],0,n),J_(r,10),r.end()}function nx(e,t,n){J_(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,a=Vy(r?15+n.length:16+2*n.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function rx(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&J_(e,125,function(e,t){var n=Vy(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(ck(r,t),r))})}}function ax(e,t,n,r,a){var s=16+hk(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)J_(e,6,$S(t,n,r,0,s));else switch(t.t){case"d":case"n":J_(e,515,function(e,t,n,r){var a=Vy(14);return eT(e,t,r,a),Pb(n,a),a}(n,r,"d"==t.t?_g(Dg(t.v)):t.v,s));break;case"b":case"e":J_(e,517,function(e,t,n,r,a,s){var i=Vy(8);return eT(e,t,r,i),jw(n,s,i),i}(n,r,t.v,s,0,t.t));break;case"s":case"str":if(a.bookSST)J_(e,253,function(e,t,n,r){var a=Vy(10);return eT(e,t,r,a),a.write_shift(4,n),a}(n,r,lk(a.Strings,t.v,a.revStrings),s));else J_(e,516,function(e,t,n,r,a){var s=!a||8==a.biff,i=Vy(+s+8+(1+s)*n.length);return eT(e,t,r,i),i.write_shift(2,n.length),s&&i.write_shift(1,1),i.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),i}(n,r,(t.v||"").slice(0,255),s,a));break;default:J_(e,513,eT(n,r,s))}else J_(e,513,eT(n,r,s))}function sx(e,t,n){var r,a=Hy(),s=n.SheetNames[e],i=n.Sheets[s]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=8==t.biff,h="",f=[],d=rb(i["!ref"]||"A1"),p=u?65536:16384;if(d.e.c>255||d.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}J_(a,2057,hT(0,16,t)),J_(a,13,Fw(1)),J_(a,12,Fw(100)),J_(a,15,Lw(!0)),J_(a,17,Lw(!1)),J_(a,16,Pb(.001)),J_(a,95,Lw(!0)),J_(a,42,Lw(!1)),J_(a,43,Lw(!1)),J_(a,130,Fw(1)),J_(a,128,function(e){var t=Vy(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),J_(a,131,Lw(!1)),J_(a,132,Lw(!1)),u&&rx(a,i["!cols"]),J_(a,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=Vy(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(d,t)),u&&(i["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=Xy(m);for(var g=d.s.c;g<=d.e.c;++g){m===d.s.r&&(f[g]=Jy(g)),r=f[g]+h;var v=c?(i[m]||[])[g]:i[r];v&&(ax(a,v,m,g,t),u&&v.l&&i["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||s;return u&&J_(a,574,function(e){var t=Vy(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&J_(a,229,function(e){var t=Vy(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)aT(e[n],t);return t}(i["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];J_(e,440,xT(r)),r[1].Tooltip&&J_(e,2048,CT(r))}delete t["!links"]}(a,i),J_(a,442,$w(y)),u&&function(e,t){var n=Vy(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),J_(e,2151,n),(n=Vy(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),aT(rb(t["!ref"]||"A1"),n),n.write_shift(4,4),J_(e,2152,n)}(a,i),J_(a,10),a.end()}function ix(e,t,n){var r=Hy(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=8==n.biff,l=5==n.biff;(J_(r,2057,hT(0,5,n)),"xla"==n.bookType&&J_(r,135),J_(r,225,o?Fw(1200):null),J_(r,193,function(e,t){t||(t=Vy(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&J_(r,191),l&&J_(r,192),J_(r,226),J_(r,92,function(e,t){var n=!t||8==t.biff,r=Vy(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),J_(r,66,Fw(o?1200:1252)),o&&J_(r,353,Fw(0)),o&&J_(r,448),J_(r,317,function(e){for(var t=Vy(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&J_(r,211),o&&e.vbaraw)&&J_(r,442,$w(i.CodeName||"ThisWorkbook"));J_(r,156,Fw(17)),J_(r,25,Lw(!1)),J_(r,18,Lw(!1)),J_(r,19,Fw(0)),o&&J_(r,431,Lw(!1)),o&&J_(r,444,Fw(0)),J_(r,61,function(){var e=Vy(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),J_(r,64,Lw(!1)),J_(r,141,Fw(0)),J_(r,34,Lw("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&yv(e.Workbook.WBProps.date1904)?"true":"false"}(e))),J_(r,14,Lw(!0)),o&&J_(r,439,Lw(!1)),J_(r,218,Fw(0)),nx(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&J_(e,1054,pT(a,t[a],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)J_(e,224,vT({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){J_(e,224,vT(n,0,t))})}(r,n),o&&J_(r,352,Lw(!1));var c,u=r.end(),h=Hy();o&&J_(h,140,(c||(c=Vy(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var a=r||(n||[]).length||0;if(a<=8224)return J_(e,t,n,a);var s=t;if(!isNaN(s)){for(var i=n.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<a;){for((u=e.next(4)).write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(h,252,function(e){var t=Vy(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=Bw(e[r]);var a=bm([t].concat(n));return a.parts=[t.length].concat(n.map(function(e){return e.length})),a}(n.Strings)),J_(h,10);var f=h.end(),d=Hy(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=u.length+p+f.length;for(m=0;m<e.SheetNames.length;++m){J_(d,133,fT({pos:g,hs:(s[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},n)),g+=t[m].length}var v=d.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),f.length&&y.push(f),bm(y)}function ox(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])tb(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Mg(Rm)),e&&e.SSF&&(fg(),hg(e.SSF),n.revssf=Sg(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,eC(n),n.cellXfs=[],hk(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=sx(a,n,e);return r.unshift(ix(e,r,n)),bm(r)}(e,t);case 4:case 3:case 2:return tx(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function lx(e,t){var n=t||{};var r=n.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Vg(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<l.length;++i){var m=l[i].trim(),g=m.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var T=0;T<p.length;++T){var E=p[T];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,T=-1)}var S=iv(y.slice(0,y.indexOf(">")));f=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||f>1)&&p.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+f-1}});var k=S.t||S["data-t"]||"";if(b.length)if(b=xv(b),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),b.length){var _={t:"s",v:b};n.raw||!b.trim().length||"s"==k||("TRUE"===b?_={t:"b",v:!0}:"FALSE"===b?_={t:"b",v:!1}:isNaN(Ug(b))?isNaN(zg(b).getDate())||(_={t:"d",v:Dg(b)},n.cellDates||(_={t:"n",v:_g(_.v)}),_.z=n.dateNF||Rm[14]):_={t:"n",v:Ug(b)}),n.dense?(r[c]||(r[c]=[]),r[c][u]=_):r[eb({r:c,c:u})]=_,u+=f}else u+=f;else u+=f}}}}else{if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0}}return r["!ref"]=nb(d),p.length&&(r["!merges"]=p),r}function cx(e,t,n,r){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>i)&&!(a[c].e.r<n||a[c].e.c<i)){if(a[c].s.r<n||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=eb({r:n,c:i}),h=r.dense?(e[n]||[])[i]:e[u],f=h&&null!=h.v&&(h.h||gv(h.w||(sb(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",null!=h.v&&(d["data-v"]=h.v),null!=h.z&&(d["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(r.id||"sjs")+"-"+u,s.push(Dv("td",f,d))}}return"<tr>"+s.join("")+"</tr>"}var ux='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hx="</body></html>";function fx(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function dx(e,t){var n=t||{},r=null!=n.header?n.header:ux,a=null!=n.footer?n.footer:hx,s=[r],i=tb(e["!ref"]);n.dense=Array.isArray(e),s.push(fx(0,0,n));for(var o=i.s.r;o<=i.e.r;++o)s.push(cx(e,i,o,n));return s.push("</table>"+a),s.join("")}function px(e,t,n){var r=n||{};var a=0,s=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var i="string"==typeof r.origin?Zy(r.origin):r.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=tb(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var h=[],f=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var w=o[p];if(gx(w)){if(r.display)continue;d[m]={hidden:!0}}var T=w.children;for(g=v=0;g<T.length;++g){var E=T[g];if(!r.display||!gx(E)){var S=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):xv(E.innerHTML),k=E.getAttribute("data-z")||E.getAttribute("z");for(f=0;f<h.length;++f){var _=h[f];_.s.c==v+s&&_.s.r<m+a&&m+a<=_.e.r&&(v=_.e.c+1-s,f=-1)}b=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:m+a,c:v+s},e:{r:m+a+(y||1)-1,c:v+s+(b||1)-1}});var x={t:"s",v:S},C=E.getAttribute("data-t")||E.getAttribute("t")||"";null!=S&&(0==S.length?x.t=C||"z":r.raw||0==S.trim().length||"s"==C||("TRUE"===S?x={t:"b",v:!0}:"FALSE"===S?x={t:"b",v:!1}:isNaN(Ug(S))?isNaN(zg(S).getDate())||(x={t:"d",v:Dg(S)},r.cellDates||(x={t:"n",v:_g(x.v)}),x.z=r.dateNF||Rm[14]):x={t:"n",v:Ug(S)})),void 0===x.z&&null!=k&&(x.z=k);var A="",N=E.getElementsByTagName("A");if(N&&N.length)for(var I=0;I<N.length&&(!N[I].hasAttribute("href")||"#"==(A=N[I].getAttribute("href")).charAt(0));++I);A&&"#"!=A.charAt(0)&&(x.l={Target:A}),r.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+s]=x):e[eb({c:v+s,r:m+a})]=x,c.e.c<v+s&&(c.e.c=v+s),v+=b}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=nb(c),m>=l&&(e["!fullref"]=nb((c.e.r=o.length-p+m-1+a,c))),e}function mx(e,t){return px((t||{}).dense?[]:{},e,t)}function gx(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function vx(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[uv(t.replace(/<[^>]*>/g,""))]}var yx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bx(e,t){var n=t||{};var r,a,s,i,o,l,c=Mv(e),u=[],h={name:""},f="",d=0,p={},m=[],g=n.dense?[]:{},v={value:""},y="",b=0,w=[],T=-1,E=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,_={},x=[],C={},A=[],N=1,I=1,R=[],O={Names:[]},P={},D=["",""],L=[],M={},F="",U=0,j=!1,z=!1,V=0;for(Fv.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=Fv.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=nb(S):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=n.sheetRows-1,g["!ref"]=nb(S)),x.length&&(g["!merges"]=x),A.length&&(g["!rows"]=A),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),m.push(s.name),p[s.name]=g,z=!1):"/"!==o[0].charAt(o[0].length-2)&&(s=iv(o[0],!1),T=E=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=n.dense?[]:{},x=[],A=[],z=!0);break;case"table-row-group":"/"===o[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===o[1]){T+=N,N=1;break}if((i=iv(o[0],!1))["\u884c\u53f7"]?T=i["\u884c\u53f7"]-1:-1==T&&(T=0),(N=+i["number-rows-repeated"]||1)<10)for(V=0;V<N;++V)k>0&&(A[T+V]={level:k});E=-1;break;case"covered-table-cell":"/"!==o[1]&&++E,n.sheetStubs&&(n.dense?(g[T]||(g[T]=[]),g[T][E]={t:"z"}):g[eb({r:T,c:E})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++E,v=iv(o[0],!1),I=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=n.cellFormula&&(l.f=tk(uv(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=uv(v["string-value"]||""),n.dense?(g[T]||(g[T]=[]),g[T][E]=l):g[eb({r:T,c:E})]=l),E+=I-1;else if("/"!==o[1]){y="",b=0,w=[],I=1;var B=N?T+N-1:T;if(++E>S.e.c&&(S.e.c=E),E<S.s.c&&(S.s.c=E),T<S.s.r&&(S.s.r=T),B>S.e.r&&(S.e.r=B),L=[],M={},l={t:(v=iv(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},n.cellFormula)if(v.formula&&(v.formula=uv(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(C={s:{r:T,c:E},e:{r:T+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:E+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=nb(C),R.push([C,l.F])),v.formula)l.f=tk(v.formula);else for(V=0;V<R.length;++V)T>=R[V][0].s.r&&T<=R[V][0].e.r&&E>=R[V][0].s.c&&E<=R[V][0].e.c&&(l.F=R[V][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(C={s:{r:T,c:E},e:{r:T+(parseInt(v["number-rows-spanned"],10)||0)-1,c:E+(parseInt(v["number-columns-spanned"],10)||0)-1}},x.push(C)),v["number-columns-repeated"]&&(I=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=yv(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=Dg(v["date-value"]),n.cellDates||(l.t="n",l.v=_g(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=Ig(v["time-value"])/86400,n.cellDates&&(l.t="d",l.v=Ng(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(y=uv(v["string-value"]),w=[])}}else{if(j=!1,"s"===l.t&&(l.v=y||"",w.length&&(l.R=w),j=0==b),P.Target&&(l.l=P),L.length>0&&(l.c=L,L=[]),y&&!1!==n.cellText&&(l.w=y),j&&(l.t="z",delete l.v),(!j||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=T))for(var H=0;H<N;++H){if(I=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(g[T+H]||(g[T+H]=[]),g[T+H][E]=0==H?l:Mg(l);--I>0;)g[T+H][E+I]=Mg(l);else for(g[eb({r:T+H,c:E})]=l;--I>0;)g[eb({r:T+H,c:E+I})]=Mg(l);S.e.c<=E&&(S.e.c=E)}E+=(I=parseInt(v["number-columns-repeated"]||"1",10))-1,I=0,l={},y="",w=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r;M.t=y,w.length&&(M.R=w),M.a=F,L.push(M)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",U=0,y="",b=0,w=[];break;case"creator":"/"===o[1]?F=c.slice(U,o.index):U=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(_[h.name]=f,(r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(f="",h=iv(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=iv(o[0],!1),f+=yx[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":f+=c.slice(d,o.index)}else d=o.index+o[0].length;break;case"named-range":D=rk((a=iv(o[0],!1))["cell-range-address"]);var W={Name:a.name,Ref:D[0]+"!"+D[1]};z&&(W.Sheet=m.length),O.Names.push(W);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])iv(o[0],!1),b=o.index+o[0].length;else{var q=vx(c.slice(b,o.index));y=(y.length>0?y+"\n":"")+q[0]}break;case"database-range":if("/"===o[1])break;try{p[(D=rk(iv(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(G){}break;case"a":if("/"!==o[1]){if(!(P=iv(o[0],!1)).href)break;P.Target=uv(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(D=rk(P.Target.slice(1)),P.Target="#"+D[0]+"!"+D[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(o)}}var $={Sheets:p,SheetNames:m,Workbook:O};return n.bookSheets&&delete $.Sheets,$}function wx(e,t){t=t||{},Wg(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,a=Mv(e);n=Fv.exec(a);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=iv(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}($g(e,"META-INF/manifest.xml"),t);var n=Gg(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=bx(Sv(n),t);return Wg(e,"meta.xml")&&(r.Props=sw($g(e,"meta.xml"))),r}function Tx(e,t){return bx(e,t)}var Ex=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Pv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ev+t}}(),Sx=function(){var e=function(e){return dv(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,a){var s=[];s.push('      <table:table table:name="'+dv(r.SheetNames[a])+'" table:style-name="ta1">\n');var i=0,o=0,l=tb(n["!ref"]||"A1"),c=n["!merges"]||[],u=0,h=Array.isArray(n);if(n["!cols"])for(o=0;o<=l.e.c;++o)s.push("        <table:table-column"+(n["!cols"][o]?' table:style-name="co'+n["!cols"][o].ods+'"':"")+"></table:table-column>\n");var f="",d=n["!rows"]||[];for(i=0;i<l.s.r;++i)f=d[i]?' table:style-name="ro'+d[i].ods+'"':"",s.push("        <table:table-row"+f+"></table:table-row>\n");for(;i<=l.e.r;++i){for(f=d[i]?' table:style-name="ro'+d[i].ods+'"':"",s.push("        <table:table-row"+f+">\n"),o=0;o<l.s.c;++o)s.push(t);for(;o<=l.e.c;++o){var p=!1,m={},g="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>o)&&!(c[u].s.r>i)&&!(c[u].e.c<o)&&!(c[u].e.r<i)){c[u].s.c==o&&c[u].s.r==i||(p=!0),m["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,m["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(p)s.push("          <table:covered-table-cell/>\n");else{var v=eb({r:i,c:o}),y=h?(n[i]||[])[o]:n[v];if(y&&y.f&&(m["table:formula"]=dv(nk(y.f)),y.F&&y.F.slice(0,v.length)==v)){var b=tb(y.F);m["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,m["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":g=y.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=y.v?"true":"false";break;case"n":g=y.w||String(y.v||0),m["office:value-type"]="float",m["office:value"]=y.v||0;break;case"s":case"str":g=null==y.v?"":y.v,m["office:value-type"]="string";break;case"d":g=y.w||Dg(y.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=Dg(y.v).toISOString(),m["table:style-name"]="ce1";break;default:s.push(t);continue}var w=e(g);if(y.l&&y.l.Target){var T=y.l.Target;"#"==(T="#"==T.charAt(0)?"#"+ak(T.slice(1)):T).charAt(0)||T.match(/^\w+:/)||(T="../"+T),w=Dv("text:a",w,{"xlink:href":T.replace(/&/g,"&amp;")})}s.push("          "+Dv("table:table-cell",Dv("text:p",w,{}),m)+"\n")}else s.push(t)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")};return function(e,t){var r=[ev],a=Pv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=Pv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+s+">\n"),r.push(nw().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;wE(a),a.ods=n;var s=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var a=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)r.push(n(e.Sheets[e.SheetNames[i]],e,i));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function kx(e,t){if("fods"==t.bookType)return Sx(e,t);var n=Yg(),r="",a=[],s=[];return Xg(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Xg(n,r="content.xml",Sx(e,t)),a.push([r,"text/xml"]),s.push([r,"ContentFile"]),Xg(n,r="styles.xml",Ex(e,t)),a.push([r,"text/xml"]),s.push([r,"StylesFile"]),Xg(n,r="meta.xml",ev+nw()),a.push([r,"text/xml"]),s.push([r,"MetadataFile"]),Xg(n,r="manifest.rdf",function(e){var t=[ev];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(ew(e[n][0],e[n][1])),t.push(tw("",e[n][0]));return t.push(ew("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),a.push([r,"application/rdf+xml"]),Xg(n,r="META-INF/manifest.xml",function(e){var t=[ev];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),n}function _x(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function xx(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Sv(vm(e))}function Cx(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):mm(kv(e))}function Ax(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function Nx(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Ix(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function Rx(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Ox(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function Px(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],s=Ix(e,n),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=Ix(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var c={data:r,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function Dx(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push(Rx(8*n+e.type)),2==e.type&&t.push(Rx(e.data.length)),t.push(e.data))})}),Ax(t)}function Lx(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Mx(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=Ix(e,r),s=Px(e.slice(r[0],r[0]+a));r[0]+=a;var i={id:Ox(s[1][0].data),messages:[]};s[2].forEach(function(t){var n=Px(t.data),a=Ox(n[3][0].data);i.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a}),(null==(t=s[3])?void 0:t[0])&&(i.merge=Ox(s[3][0].data)>>>0>0),n.push(i)}return n}function Fx(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:Rx(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:Rx(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:Rx(e.data.length)}],n[2].push({data:Dx(e.meta),type:2})});var a=Dx(n);t.push(Rx(a.length)),t.push(a),r.forEach(function(e){return t.push(e)})}),Ax(t)}function Ux(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Ix(t,n),a=[];n[0]<t.length;){var s=3&t[n[0]];if(0!=s){var i=0,o=0;if(1==s?(o=4+(t[n[0]]>>2&7),i=(224&t[n[0]++])<<3,i|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==s?(i=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(i=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Ax(a)],0==i)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(a.push(a[0].slice(-i)),o-=i;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-i,-i+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=Ax(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function jx(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(Ux(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return Ax(t)}function zx(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var s=Rx(r),i=s.length;t.push(s),r<=60?(i++,t.push(new Uint8Array([r-1<<2]))):r<=256?(i+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(i+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(i+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(i+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),i+=r,a[0]=0,a[1]=255&i,a[2]=i>>8&255,a[3]=i>>16&255,n+=r}return Ax(t)}function Vx(e,t,n){var r,a=_x(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],a=t+13;a>=t;--a)r=256*r+e[a];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,i),i+=16),2&s&&(u=a.getFloat64(i,!0),i+=8),4&s&&(h.setTime(h.getTime()+1e3*a.getFloat64(i,!0)),i+=8),8&s&&(l=a.getUint32(i,!0),i+=4),16&s&&(o=a.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:c};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:h};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));r={t:"s",v:n[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return r}function Bx(e,t){var n=new Uint8Array(32),r=_x(n),a=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=255&a;e[t+15]|=n>=0?0:128}(n,a,e.v),s|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,a)}function Hx(e,t){var n=new Uint8Array(32),r=_x(n),a=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,a)}function Wx(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var a,s=_x(e),i=s.getUint32(4,!0),o=(r>1?12:8)+4*Nx(i&(r>1?3470:398)),l=-1,c=-1,u=NaN,h=new Date(2001,0,1);switch(512&i&&(l=s.getUint32(o,!0),o+=4),o+=4*Nx(i&(r>1?12288:4096)),16&i&&(c=s.getUint32(o,!0),o+=4),32&i&&(u=s.getFloat64(o,!0),o+=8),64&i&&(h.setTime(h.getTime()+1e3*s.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[c]};break;case 5:a={t:"d",v:h};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(l>-1)a={t:"s",v:n[l]};else if(c>-1)a={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,n,e[0]);case 5:return Vx(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function qx(e){return Ix(Px(e)[1][0].data)}function $x(e,t){var n=Px(t.data),r=Ox(n[1][0].data),a=n[3],s=[];return(a||[]).forEach(function(t){var n=Px(t.data),a=Ox(n[1][0].data)>>>0;switch(r){case 1:s[a]=xx(n[3][0].data);break;case 8:var i=Px(e[qx(n[9][0].data)][0].data),o=e[qx(i[1][0].data)][0],l=Ox(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=Px(o.data);s[a]=c[3].map(function(e){return xx(e.data)}).join("")}}),s}function Gx(e,t){var n,r=Px(t.data),a=(null==(n=null==r?void 0:r[7])?void 0:n[0])?Ox(r[7][0].data)>>>0>0?1:0:-1,s=Lx(r[5],function(e){return function(e,t){var n,r,a,s,i,o,l,c,u,h,f,d,p,m,g,v,y=Px(e),b=Ox(y[1][0].data)>>>0,w=Ox(y[2][0].data)>>>0,T=(null==(r=null==(n=y[8])?void 0:n[0])?void 0:r.data)&&Ox(y[8][0].data)>0||!1;if((null==(s=null==(a=y[7])?void 0:a[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=y[7])?void 0:i[0])?void 0:o.data,v=null==(c=null==(l=y[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(h=null==(u=y[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(d=null==(f=y[4])?void 0:f[0])?void 0:d.data,v=null==(m=null==(p=y[3])?void 0:p[0])?void 0:m.data}for(var E=T?4:1,S=_x(g),k=[],_=0;_<g.length/2;++_){var x=S.getUint16(2*_,!0);x<65535&&k.push([_,x])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var C=[];for(_=0;_<k.length-1;++_)C[k[_][0]]=v.subarray(k[_][1]*E,k[_+1][1]*E);return k.length>=1&&(C[k[k.length-1][0]]=v.subarray(k[k.length-1][1]*E)),{R:b,cells:C}}(e,a)});return{nrows:Ox(r[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n}),e},[])}}function Kx(e,t){var n={"!ref":"A1"},r=e[qx(Px(t.data)[2][0].data)],a=Ox(r[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,n){var r,a=Px(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ox(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ox(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=nb(s);var i=Px(a[4][0].data),o=$x(e,e[qx(i[4][0].data)][0]),l=(null==(r=i[17])?void 0:r[0])?$x(e,e[qx(i[17][0].data)][0]):[],c=Px(i[3][0].data),u=0;c[1].forEach(function(t){var r=Px(t.data),a=e[qx(r[2][0].data)][0],s=Ox(a.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=Gx(0,a);i.data.forEach(function(e,t){e.forEach(function(e,r){var a=eb({r:u+t,c:r}),s=Wx(e,o,l);s&&(n[a]=s)})}),u+=i.nrows})}(e,r[0],n),n}function Qx(e,t){var n={SheetNames:[],Sheets:{}};if(Lx(Px(t.data)[1],qx).forEach(function(t){e[t].forEach(function(t){if(2==Ox(t.meta[1][0].data)){var r=function(e,t){var n,r=Px(t.data),a={name:(null==(n=r[1])?void 0:n[0])?xx(r[1][0].data):"",sheets:[]};return Lx(r[2],qx).forEach(function(t){e[t].forEach(function(t){6e3==Ox(t.meta[1][0].data)&&a.sheets.push(Kx(e,t))})}),a}(e,t);r.sheets.forEach(function(e,t){xC(n,e,0==t?r.name:r.name+"_"+t,!0)})}})}),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function Xx(e){var t,n,r,a,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=jx(e.content)}catch(r){return console.log("?? "+e.content.length+" "+(r.message||r))}try{n=Mx(t)}catch(r){return console.log("## "+(r.message||r))}n.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var o=(null==(a=null==(r=null==(n=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:a[0].data)&&1==Ox(s[1][0].meta[1][0].data)&&s[1][0];if(o||i.forEach(function(e){s[e].forEach(function(e){if(1==Ox(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return Qx(s,o)}function Yx(e,t,n){var r,a,s,i;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(s=e[8])?void 0:s[0])?void 0:i.data)&&Ox(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=_x(e[7][0].data),c=0,u=[],h=_x(e[4][0].data),f=0,d=[],p=0;p<t.length;++p)if(null!=t[p]){var m,g;switch(l.setUint16(2*p,c,!0),h.setUint16(2*p,f,!0),typeof t[p]){case"string":m=Bx({t:"s",v:t[p]},n),g=Hx({t:"s",v:t[p]},n);break;case"number":m=Bx({t:"n",v:t[p]},n),g=Hx({t:"n",v:t[p]},n);break;case"boolean":m=Bx({t:"b",v:t[p]},n),g=Hx({t:"b",v:t[p]},n);break;default:throw new Error("Unsupported value "+t[p])}u.push(m),c+=m.length,d.push(g),f+=g.length,++o}else l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535);for(e[2][0].data=Rx(o);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535,!0);return e[6][0].data=Ax(u),e[3][0].data=Ax(d),o}function Jx(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function Zx(e){Jx([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function eC(e){Jx([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function tC(e,t,n,r,a,s,i,o,l,c,u,h){try{s[r]=Yb(Gg(e,n,!0),t);var f,d=$g(e,t);switch(o){case"sheet":f=h_(d,t,a,l,s[r],c,u,h);break;case"chart":if(!(f=f_(d,t,a,l,s[r],c))||!f["!drawel"])break;var p=Zg(f["!drawel"].Target,t),m=Xb(p),g=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(Gg(e,p,!0),Yb(Gg(e,m,!0),p)),v=Zg(g,p),y=Xb(v);f=Gk(Gg(e,v,!0),0,0,Yb(Gg(e,y,!0),v),0,f);break;case"macro":w=t,s[r],w.slice(-4),f={"!type":"macro"};break;case"dialog":f=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[r]);break;default:throw new Error("Unrecognized sheet type "+o)}i[r]=f;var b=[];s&&s[r]&&wg(s[r]).forEach(function(n){var a="";if(s[r][n].Type==Qb.CMNT){a=Zg(s[r][n].Target,t);var i=m_($g(e,a,!0),a,l);if(!i||!i.length)return;sS(f,i,!1)}s[r][n].Type==Qb.TCMNT&&(a=Zg(s[r][n].Target,t),b=b.concat(function(e,t){var n=[],r=!1,a={},s=0;return e.replace(rv,function(i,o){var l=iv(i);switch(ov(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&n.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),n}($g(e,a,!0),l)))}),b&&b.length&&sS(f,b,!0,l.people||[])}catch(T){if(l.WTF)throw T}var w}function nC(e){return"/"==e.charAt(0)?e.slice(1):e}function rC(e,t){if(fg(),Zx(t=t||{}),Wg(e,"META-INF/manifest.xml"))return wx(e,t);if(Wg(e,"objectdata.xml"))return wx(e,t);if(Wg(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Xx(e);var n=gg.utils.cfb_new();return Qg(e).forEach(function(t){Xg(n,t,Kg(e,t))}),Xx(n)}if(!Wg(e,"[Content_Types].xml")){if(Wg(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Wg(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,a,s=Qg(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(rv)||[]).forEach(function(e){var r=iv(e);switch(r[0].replace(av,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[$b[r.ContentType]]&&t[$b[r.ContentType]].push(r.PartName)}}),t.xmlns!==Vv)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(Gg(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&$g(e,a="xl/workbook.xml",!0)&&i.workbooks.push(a),0===i.workbooks.length){if(!$g(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(a),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(sk=[],i.sst)try{sk=p_($g(e,nC(i.sst)),i.sst,t)}catch(I){if(t.WTF)throw I}t.cellStyles&&i.themes.length&&(l=function(e,t,n){return XE(e,n)}(Gg(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=d_($g(e,nC(i.style)),i.style,l,t))}i.links.map(function(n){try{Yb(Gg(e,Xb(nC(n))),n);return v_($g(e,nC(n)),0,n,t)}catch(I){}});var u=u_($g(e,nC(i.workbooks[0])),i.workbooks[0],t),h={},f="";i.coreprops.length&&((f=$g(e,nC(i.coreprops[0]),!0))&&(h=sw(f)),0!==i.extprops.length&&(f=$g(e,nC(i.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=Sv(e),lw.forEach(function(n){var a=(e.match(_v(n[0]))||[])[1];switch(n[2]){case"string":a&&(t[n[1]]=uv(a));break;case"bool":t[n[1]]="true"===a;break;case"raw":var s=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(r[n[1]]=s[1])}}),r.HeadingPairs&&r.TitlesOfParts&&uw(r.HeadingPairs,r.TitlesOfParts,t,n)}(f,h,t));var d={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(f=Gg(e,nC(i.custprops[0]),!0))&&(d=function(e,t){var n={},r="",a=e.match(fw);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=iv(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=uv(o.name);break;case"</property>":r=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=uv(u);break;case"bool":n[r]=yv(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=Dg(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return n}(f,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map(function(e){return e.name}):h.Worksheets&&h.SheetNames.length>0&&(r=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=d),t.bookSheets&&"undefined"!==typeof r&&(p.SheetNames=r),t.bookSheets?p.SheetNames:t.bookProps))return p;r={};var m={};t.bookDeps&&i.calcchain&&(m=g_($g(e,nC(i.calcchain)),i.calcchain));var g,v,y=0,b={},w=u.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var T=0;T!=w.length;++T)h.SheetNames[T]=w[T].name;var E=o?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Wg(e,k)||(k="xl/_rels/workbook."+E+".rels");var _=Yb(Gg(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=y_($g(e,nC(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(rv,function(e){var a=iv(e);switch(ov(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e}),n}($g(e,nC(i.people[0])),t)),_&&(_=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,Qb.WS.indexOf(n)>-1?"sheet":Qb.CS&&n==Qb.CS?"chart":Qb.DS&&n==Qb.DS?"dialog":Qb.MS&&n==Qb.MS?"macro":n&&n.length?n:"sheet")];var n})}catch(I){return null}return e&&0!==e.length?e:null}(_,u.Sheets));var x=$g(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var C="sheet";if(_&&_[y]?(g="xl/"+_[y][1].replace(/[\/]?xl\//,""),Wg(e,g)||(g=_[y][1]),Wg(e,g)||(g=k.replace(/_rels\/.*$/,"")+_[y][1]),C=_[y][2]):g=(g="xl/worksheets/sheet"+(y+1-x)+"."+E).replace(/sheet0\./,"sheet."),v=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,N=0;N!=t.sheets.length;++N)"number"==typeof t.sheets[N]&&t.sheets[N]==y&&(A=1),"string"==typeof t.sheets[N]&&t.sheets[N].toLowerCase()==h.SheetNames[y].toLowerCase()&&(A=1);if(!A)continue e}}tC(e,g,v,h.SheetNames[y],y,b,r,C,t,u,l,c)}return p={Directory:i,Workbook:u,Props:h,Custprops:d,Deps:m,Sheets:r,SheetNames:h.SheetNames,Strings:sk,Styles:c,Themes:l,SSF:Mg(Rm)},t&&t.bookFiles&&(e.files?(p.keys=s,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(t,n){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[n]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=$g(e,nC(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(p.vbaraw=$g(e,"xl/vbaProject.bin",!0))),p}function aC(e,t){var n=t||{},r="Workbook",a=gg.find(e,r);try{if(r="/!DataSpaces/Version",!(a=gg.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=ZT(e,4),t.U=ZT(e,4),t.W=ZT(e,4)}(a.content),r="/!DataSpaces/DataSpaceMap",!(a=gg.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(eE(e));return t}(a.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=gg.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=gg.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);tE(a.content)}catch(l){}if(r="/EncryptionInfo",!(a=gg.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=ZT(e);switch(t.Minor){case 2:return[t.Minor,aE(e)];case 3:return[t.Minor,sE()];case 4:return[t.Minor,iE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(r="/EncryptedPackage",!(a=gg.find(e,r))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,n.password||"",n);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function sC(e,t){return"ods"==t.bookType?kx(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=tb(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(nb(r)));var s=yC(n,{range:r,header:1}),i=["~Sh33tJ5~"];s.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var o={},l=[],c=gg.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&Mx(jx(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:Ox(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,Rx(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Mx(jx(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=Ox(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var h,f=gg.find(c,o[1].location),d=Mx(jx(f.content)),p=0;p<d.length;++p){var m=d[p];1==m.id&&(h=m)}var g=qx(Px(h.messages[0].data)[1][0].data);for(d=Mx(jx((f=gg.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);for(g=qx(Px(h.messages[0].data)[2][0].data),d=Mx(jx((f=gg.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);for(g=qx(Px(h.messages[0].data)[2][0].data),d=Mx(jx((f=gg.find(c,o[g].location)).content)),p=0;p<d.length;++p)(m=d[p]).id==g&&(h=m);var v=Px(h.messages[0].data);v[6][0].data=Rx(r.e.r+1),v[7][0].data=Rx(r.e.c+1);for(var y=qx(v[46][0].data),b=gg.find(c,o[y].location),w=Mx(jx(b.content)),T=0;T<w.length&&w[T].id!=y;++T);if(w[T].id!=y)throw"Bad ColumnRowUIDMapArchive";var E=Px(w[T].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var S=0;S<=r.e.c;++S){var k=[];k[1]=k[2]=[{type:0,data:Rx(S+420690)}],E[1].push({type:2,data:Dx(k)}),E[2].push({type:0,data:Rx(S)}),E[3].push({type:0,data:Rx(S)})}E[4]=[],E[5]=[],E[6]=[];for(var _=0;_<=r.e.r;++_)(k=[])[1]=k[2]=[{type:0,data:Rx(_+726270)}],E[4].push({type:2,data:Dx(k)}),E[5].push({type:0,data:Rx(_)}),E[6].push({type:0,data:Rx(_)});w[T].messages[0].data=Dx(E),b.content=zx(Fx(w)),b.size=b.content.length,delete v[46];var x=Px(v[4][0].data);x[7][0].data=Rx(r.e.r+1);var C=qx(Px(x[1][0].data)[2][0].data);if((w=Mx(jx((b=gg.find(c,o[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var A=Px(w[0].messages[0].data);for(_=0;_<s.length;++_){var N=Px(A[2][0].data);N[1][0].data=Rx(_),N[4][0].data=Rx(s[_].length),A[2][_]={type:A[2][0].type,data:Dx(N)}}w[0].messages[0].data=Dx(A),b.content=zx(Fx(w)),b.size=b.content.length;var I=qx(x[2][0].data);if((w=Mx(jx((b=gg.find(c,o[I].location)).content)))[0].id!=I)throw"Bad HeaderStorageBucket";for(A=Px(w[0].messages[0].data),S=0;S<=r.e.c;++S)(N=Px(A[2][0].data))[1][0].data=Rx(S),N[4][0].data=Rx(r.e.r+1),A[2][S]={type:A[2][0].type,data:Dx(N)};w[0].messages[0].data=Dx(A),b.content=zx(Fx(w)),b.size=b.content.length;var R=qx(x[4][0].data);!function(){for(var e,t=gg.find(c,o[R].location),n=Mx(jx(t.content)),r=0;r<n.length;++r){var a=n[r];a.id==R&&(e=a)}var s=Px(e.messages[0].data);s[3]=[];var l=[];i.forEach(function(e,t){l[1]=[{type:0,data:Rx(t)}],l[2]=[{type:0,data:Rx(1)}],l[3]=[{type:2,data:Cx(e)}],s[3].push({type:2,data:Dx(l)})}),e.messages[0].data=Dx(s);var u=zx(Fx(n));t.content=u,t.size=t.content.length}();var O=Px(x[3][0].data),P=O[1][0];delete O[2];var D=Px(P.data),L=qx(D[2][0].data);!function(){for(var e,t=gg.find(c,o[L].location),n=Mx(jx(t.content)),a=0;a<n.length;++a){var l=n[a];l.id==L&&(e=l)}var u=Px(e.messages[0].data);delete u[6],delete O[7];var h=new Uint8Array(u[5][0].data);u[5]=[];for(var f=0,d=0;d<=r.e.r;++d){var p=Px(h);f+=Yx(p,s[d],i),p[1][0].data=Rx(d),u[5].push({data:Dx(p),type:2})}u[1]=[{type:0,data:Rx(r.e.c+1)}],u[2]=[{type:0,data:Rx(r.e.r+1)}],u[3]=[{type:0,data:Rx(f)}],u[4]=[{type:0,data:Rx(r.e.r+1)}],e.messages[0].data=Dx(u);var m=zx(Fx(n));t.content=m,t.size=t.content.length}(),P.data=Dx(D),x[3][0].data=Dx(O),v[4][0].data=Dx(x),h.messages[0].data=Dx(v);var M=zx(Fx(d));return f.content=M,f.size=f.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){rS=1024,e&&!e.SSF&&(e.SSF=Mg(Rm));e&&e.SSF&&(fg(),hg(e.SSF),t.revssf=Sg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ok?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=uS.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};eC(t=t||{});var s=Yg(),i="",o=0;t.cellXfs=[],hk(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Xg(s,i="docProps/core.xml",ow(e.Props,t)),a.coreprops.push(i),Zb(t.rels,2,i,Qb.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Xg(s,i,hw(e.Props)),a.extprops.push(i),Zb(t.rels,3,i,Qb.EXT_PROPS),e.Custprops!==e.Props&&wg(e.Custprops||{}).length>0&&(Xg(s,i="docProps/custom.xml",dw(e.Custprops)),a.custprops.push(i),Zb(t.rels,4,i,Qb.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(Xg(s,i="xl/worksheets/sheet"+o+"."+n,b_(o-1,i,t,e,u)),a.sheets.push(i),Zb(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Qb.WS[0]),h){var f=h["!comments"],d=!1,p="";f&&f.length>0&&(Xg(s,p="xl/comments"+o+"."+n,w_(f,p,t)),a.comments.push(p),Zb(u,-1,"../comments"+o+"."+n,Qb.CMNT),d=!0),h["!legacy"]&&d&&Xg(s,"xl/drawings/vmlDrawing"+o+".vml",aS(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Xg(s,Xb(i),Jb(u))}null!=t.Strings&&t.Strings.length>0&&(Xg(s,i="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?YT:QT)(e,n)}(t.Strings,i,t)),a.strs.push(i),Zb(t.wbrels,-1,"sharedStrings."+n,Qb.SST));Xg(s,i="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?c_:s_)(e,n)}(e,i,t)),a.workbooks.push(i),Zb(t.rels,1,i,Qb.WB),Xg(s,i="xl/theme/theme1.xml",YE(e.Themes,t)),a.themes.push(i),Zb(t.wbrels,-1,"theme/theme1.xml",Qb.THEME),Xg(s,i="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?VE:AE)(e,n)}(e,i,t)),a.styles.push(i),Zb(t.wbrels,-1,"styles."+n,Qb.STY),e.vbaraw&&r&&(Xg(s,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),Zb(t.wbrels,-1,"vbaProject.bin",Qb.VBA));return Xg(s,i="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?tS:nS)()}(i)),a.metadata.push(i),Zb(t.wbrels,-1,"metadata."+n,Qb.XLMETA),Xg(s,"[Content_Types].xml",Kb(a,t)),Xg(s,"_rels/.rels",Jb(t.rels)),Xg(s,"xl/_rels/workbook."+n+".rels",Jb(t.wbrels)),delete t.revssf,delete t.ssf,s}(e,t):iC(e,t)}function iC(e,t){rS=1024,e&&!e.SSF&&(e.SSF=Mg(Rm)),e&&e.SSF&&(fg(),hg(e.SSF),t.revssf=Sg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ok?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=uS.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};eC(t=t||{});var s=Yg(),i="",o=0;if(t.cellXfs=[],hk(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Xg(s,i="docProps/core.xml",ow(e.Props,t)),a.coreprops.push(i),Zb(t.rels,2,i,Qb.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Xg(s,i,hw(e.Props)),a.extprops.push(i),Zb(t.rels,3,i,Qb.EXT_PROPS),e.Custprops!==e.Props&&wg(e.Custprops||{}).length>0&&(Xg(s,i="docProps/custom.xml",dw(e.Custprops)),a.custprops.push(i),Zb(t.rels,4,i,Qb.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]];(f||{})["!type"];if(Xg(s,i="xl/worksheets/sheet"+o+"."+n,Rk(o-1,t,e,h)),a.sheets.push(i),Zb(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Qb.WS[0]),f){var d=f["!comments"],p=!1,m="";if(d&&d.length>0){var g=!1;d.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(Xg(s,m="xl/threadedComments/threadedComment"+o+"."+n,oS(d,u,t)),a.threadedcomments.push(m),Zb(h,-1,"../threadedComments/threadedComment"+o+"."+n,Qb.TCMNT)),Xg(s,m="xl/comments"+o+"."+n,iS(d)),a.comments.push(m),Zb(h,-1,"../comments"+o+"."+n,Qb.CMNT),p=!0}f["!legacy"]&&p&&Xg(s,"xl/drawings/vmlDrawing"+o+".vml",aS(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Xg(s,Xb(i),Jb(h))}return null!=t.Strings&&t.Strings.length>0&&(Xg(s,i="xl/sharedStrings."+n,QT(t.Strings,t)),a.strs.push(i),Zb(t.wbrels,-1,"sharedStrings."+n,Qb.SST)),Xg(s,i="xl/workbook."+n,s_(e)),a.workbooks.push(i),Zb(t.rels,1,i,Qb.WB),Xg(s,i="xl/theme/theme1.xml",YE(e.Themes,t)),a.themes.push(i),Zb(t.wbrels,-1,"theme/theme1.xml",Qb.THEME),Xg(s,i="xl/styles."+n,AE(e,t)),a.styles.push(i),Zb(t.wbrels,-1,"styles."+n,Qb.STY),e.vbaraw&&r&&(Xg(s,i="xl/vbaProject.bin",e.vbaraw),a.vba.push(i),Zb(t.wbrels,-1,"vbaProject.bin",Qb.VBA)),Xg(s,i="xl/metadata."+n,nS()),a.metadata.push(i),Zb(t.wbrels,-1,"metadata."+n,Qb.XLMETA),u.length>1&&(Xg(s,i="xl/persons/person.xml",function(e){var t=[ev,Dv("personList",null,{xmlns:Hv,"xmlns:x":Yv[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(Dv("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),a.people.push(i),Zb(t.wbrels,-1,"persons/person.xml",Qb.PEOPLE)),Xg(s,"[Content_Types].xml",Kb(a,t)),Xg(s,"_rels/.rels",Jb(t.rels)),Xg(s,"xl/_rels/workbook.xml.rels",Jb(t.wbrels)),delete t.revssf,delete t.ssf,s}function oC(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=um(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function lC(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return O_(e.slice(n),t);default:break e}return FT.to_workbook(e,t)}function cC(e,t,n,r){return r?(n.type="string",FT.to_workbook(e,n)):FT.to_workbook(t,n)}function uC(e,t){tm();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return uC(new Uint8Array(e),((n=Mg(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,a=e,s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),ik={},n.dateNF&&(ik.dateNF=n.dateNF),n.type||(n.type=hm&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=hm?"buffer":"binary",a=function(e){if("undefined"!==typeof vg)return vg.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||hm||(n.type="array")),"string"==n.type&&(s=!0,n.type="binary",n.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?kv(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(n=Mg(n)).type="array",uC(ym(a),n)}switch((r=oC(a,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return gg.find(e,"EncryptedPackage")?aC(e,t):K_(e,t)}(gg.read(a,n),n);break;case 9:if(r[1]<=8)return K_(a,n);break;case 60:return O_(a,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=DT.to_workbook(e,n);return n.WTF=r,a}catch(s){if(n.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return FT.to_workbook(e,t)}}(a,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return LT.to_workbook(a,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=hm&&Buffer.isBuffer(e)?"buffer":"base64"),rC(Jg(n,r),r)}(a,n):cC(e,a,n,s);case 239:return 60===r[3]?O_(a,n):cC(e,a,n,s);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=um(n)),n=am.utils.decode(1200,n.slice(2),"str"),t.type="binary",lC(n,t)}(a,n);if(0===r[1]&&2===r[2]&&0===r[3])return UT.to_workbook(a,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return UT.to_workbook(a,n);if(0===r[2]&&(8===r[3]||9===r[3]))return UT.to_workbook(a,n)}break;case 3:case 131:case 139:case 140:return PT.to_workbook(a,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return hE.to_workbook(a,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=oC(e,t);switch(t.type){case"base64":n=um(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Lg(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=Sv(n)),t.type="binary",lC(n,t)}(a,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return OT.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?PT.to_workbook(a,n):cC(e,a,n,s)}function hC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bg(t.file,gg.write(e,{type:hm?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gg.write(e,t)}function fC(e,t){var n={},r=hm?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?gg.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(gm(a))}return t.password&&"undefined"!==typeof encrypt_agile?hC(encrypt_agile(a,t.password),t):"file"===t.type?bg(t.file,a):"string"==t.type?Sv(a):a}function dC(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return cm(kv(r));case"binary":return kv(r);case"string":return e;case"file":return bg(t.file,r,"utf8");case"buffer":return hm?fm(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):dC(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function pC(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?cm(n):"string"==t.type?Sv(n):n;case"file":return bg(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function mC(e,t){tm(),r_(e);var n=Mg(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=mC(e,n);return n.type="array",gm(r)}var a=0;if(n.sheet&&(a="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return dC(U_(e,n),n);case"slk":case"sylk":return dC(DT.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return dC(dx(e.Sheets[e.SheetNames[a]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return cm(e);case"binary":case"string":return e;case"file":return bg(t.file,e,"binary");case"buffer":return hm?fm(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(EC(e.Sheets[e.SheetNames[a]],n),n);case"csv":return dC(TC(e.Sheets[e.SheetNames[a]],n),n,"\ufeff");case"dif":return dC(LT.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return pC(PT.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return dC(FT.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return dC(hE.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return dC(MT.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return dC(kx(e,n),n);case"wk1":return pC(UT.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return pC(UT.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),pC(ox(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return hC(Q_(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=Mg(t||{});return fC(sC(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function gC(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function vC(e,t,n,r,a,s,i,o){var l=Xy(n),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch(g){f.__rowNum__=n}else f.__rowNum__=n;if(!i||e[n])for(var d=t.s.c;d<=t.e.c;++d){var p=i?e[n][d]:e[r[d]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=s[d]){if(null==m)if("e"==p.t&&null===m)f[s[d]]=null;else if(void 0!==c)f[s[d]]=c;else{if(!u||null!==m)continue;f[s[d]]=null}else f[s[d]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:sb(p,m,o);null!=m&&(h=!1)}}else{if(void 0===c)continue;null!=s[d]&&(f[s[d]]=c)}}return{row:f,isempty:h}}function yC(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=rb(u);break;case"number":(l=rb(e["!ref"])).s.r=u;break;default:l=u}r>0&&(a=0);var h=Xy(l.s.r),f=[],d=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],T=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(f[y]=Jy(y),n=g?e[v][y]:e[f[y]+h],r){case 1:s[y]=y-l.s.c;break;case 2:s[y]=f[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=i=sb(n,null,c),m=b[i]||0){do{o=i+"_"+m++}while(b[o]);b[i]=m,b[o]=1}else b[i]=1;s[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(T[v]||{}).hidden){var E=vC(e,l,v,f,r,s,g,c);(!1===E.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(d[p++]=E.row)}return d.length=p,d}var bC=/"/g;function wC(e,t,n,r,a,s,i,o){for(var l=!0,c=[],u="",h=Xy(n),f=t.s.c;f<=t.e.c;++f)if(r[f]){var d=o.dense?(e[n]||[])[f]:e[r[f]+h];if(null==d)u="";else if(null!=d.v){l=!1,u=""+(o.rawNumbers&&"n"==d.t?d.v:sb(d,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===a||m===s||34===m||o.forceQuotes){u='"'+u.replace(bC,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==d.f||d.F?u="":(l=!1,(u="="+d.f).indexOf(",")>=0&&(u='"'+u.replace(bC,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(i)}function TC(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=rb(e["!ref"]),s=void 0!==r.FS?r.FS:",",i=s.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var f=r.skipHidden&&e["!cols"]||[],d=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(f[p]||{}).hidden||(h[p]=Jy(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(d[g]||{}).hidden||null!=(u=wC(e,a,g,h,i,l,s,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((m++?o:"")+u));return delete r.dense,n.join("")}function EC(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=TC(e,t);if("undefined"==typeof am||"string"==t.type)return n;var r=am.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function SC(e,t,n){var r,a=n||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?Zy(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var h=rb(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=h.e.r+1,u.e.r=o+t.length-1+s)}else-1==o&&(o=0,u.e.r=t.length-1+s);var f=a.header||[],d=0;t.forEach(function(e,t){wg(e).forEach(function(n){-1==(d=f.indexOf(n))&&(f[d=f.length]=n);var c=e[n],u="z",h="",p=eb({c:l+d,r:o+t+s});r=kC(i,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=_g(c)),h=a.dateNF||Rm[14]):null===c&&a.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):i[p]=r={t:u,v:c},h&&(r.z=h)):i[p]=c})}),u.e.c=Math.max(u.e.c,l+f.length-1);var p=Xy(o);if(s)for(d=0;d<f.length;++d)i[Jy(d+l)+p]={t:"s",v:f[d]};return i["!ref"]=nb(u),i}function kC(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=Zy(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return kC(e,eb("number"!=typeof t?t:{r:t,c:n||0}))}function _C(){return{SheetNames:[],Sheets:{}}}function xC(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=i+a);++a);}if(n_(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function CC(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var AC={encode_col:Jy,encode_row:Xy,encode_cell:eb,encode_range:nb,decode_col:Yy,decode_row:Qy,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Zy,decode_range:tb,format_cell:sb,sheet_add_aoa:ob,sheet_add_json:SC,sheet_add_dom:px,aoa_to_sheet:lb,json_to_sheet:function(e,t){return SC(null,e,t)},table_to_sheet:mx,table_to_book:function(e,t){return ib(mx(e,t),t)},sheet_to_csv:TC,sheet_to_txt:EC,sheet_to_json:yC,sheet_to_html:dx,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,s=rb(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=Jy(a);for(var u=s.s.r;u<=s.e.r;++u)for(i=Xy(u),a=s.s.c;a<=s.e.c;++a)if(n=o[a]+i,r="",void 0!==(t=c?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:yC,sheet_get_cell:kC,book_new:_C,book_append_sheet:xC,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:CC,cell_set_internal_link:function(e,t,n){return CC(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:rb(t),s="string"==typeof t?t:nb(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=kC(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Kp.version;const NC=e=>{let{quizId:t,onClose:n}=e;const[a,s]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[f,d]=(0,r.useState)(!1);return(0,$p.jsx)("div",{className:"modal show",style:{display:"block"},children:(0,$p.jsx)("div",{className:"modal-dialog modal-lg",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsxs)("div",{className:"modal-header",children:[(0,$p.jsx)("h5",{className:"modal-title",children:"Add Candidates"}),(0,$p.jsx)("button",{type:"button",className:"btn-close",onClick:n})]}),(0,$p.jsxs)("div",{className:"modal-body",children:[(0,$p.jsxs)("ul",{className:"nav nav-tabs mb-3",id:"addCandidateTab",role:"tablist",children:[(0,$p.jsx)("li",{className:"nav-item",role:"presentation",children:(0,$p.jsx)("button",{className:"nav-link active",id:"manual-add-tab","data-bs-toggle":"tab","data-bs-target":"#manual-add",type:"button",role:"tab",children:"Manual Entry"})}),(0,$p.jsx)("li",{className:"nav-item",role:"presentation",children:(0,$p.jsx)("button",{className:"nav-link",id:"excel-import-tab","data-bs-toggle":"tab","data-bs-target":"#excel-import",type:"button",role:"tab",children:"Import from Excel"})})]}),(0,$p.jsxs)("div",{className:"tab-content",id:"addCandidateTabContent",children:[(0,$p.jsx)("div",{className:"tab-pane fade show active",id:"manual-add",role:"tabpanel",children:(0,$p.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),a.trim()&&i.trim()&&l.trim()&&u.trim())try{const e=Id(Wp,"quizzes",t,"candidates");await Mp(e,{name:a,place:i,phone:l,password:u,status:"not-attended"}),s(""),o(""),c(""),h(""),alert("Candidate added successfully!")}catch(n){console.error("Error adding candidate:",n),alert("Failed to add candidate.")}else alert("Please fill in all fields.")},children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Name"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:a,onChange:e=>s(e.target.value),required:!0})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Place"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:i,onChange:e=>o(e.target.value),required:!0})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Phone Number"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:l,onChange:e=>c(e.target.value),required:!0})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Password"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:u,onChange:e=>h(e.target.value),required:!0})]}),(0,$p.jsxs)("div",{className:"modal-footer px-0 pb-0",children:[(0,$p.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:n,children:"Close"}),(0,$p.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Add Candidate"})]})]})}),(0,$p.jsxs)("div",{className:"tab-pane fade",id:"excel-import",role:"tabpanel",children:[(0,$p.jsx)("p",{children:"Upload an Excel file (.xlsx) with the required columns."}),(0,$p.jsxs)("small",{className:"d-block mb-3",children:["Columns: ",(0,$p.jsx)("strong",{children:"Name, Place, PhoneNumber, Password"})]}),(0,$p.jsx)("input",{className:"form-control",type:"file",accept:".xlsx",onChange:async e=>{const r=e.target.files[0];if(!r)return;d(!0);const a=new FileReader;a.onload=async e=>{try{const r=uC(new Uint8Array(e.target.result),{type:"array"}),a=r.SheetNames[0],s=r.Sheets[a],i=AC.sheet_to_json(s);if(0===i.length)return alert("The selected file is empty or in the wrong format."),void d(!1);const o=Id(Wp,"quizzes",t,"candidates");let l=0;for(const e of i){const t={name:String(e.Name||""),place:String(e.Place||""),phone:String(e.PhoneNumber||""),password:String(e.Password||""),status:"not-attended"};t.name&&t.place&&t.phone&&t.password&&(await Mp(o,t),l++)}alert(`${l} candidates were successfully imported!`),n()}catch(r){console.error("Error importing candidates:",r),alert("An error occurred during import. Please check the file format and column headers.")}finally{d(!1)}},a.readAsArrayBuffer(r)},disabled:f}),f&&(0,$p.jsx)("div",{className:"mt-2",children:"Processing file..."})]})]})]})]})})})};function IC(e){let{onClose:t,title:n,children:r}=e;return(0,$p.jsx)("div",{className:"modal-backdrop",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsxs)("div",{className:"modal-header",children:[(0,$p.jsx)("h5",{className:"modal-title",children:n}),(0,$p.jsx)("button",{type:"button",className:"btn-close",onClick:t})]}),(0,$p.jsx)("div",{className:"modal-body",children:r})]})})}function RC(e){let{quizId:t,candidate:n,onClose:a}=e;const[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)("");(0,r.useEffect)(()=>{n&&(i(n.name),l(n.mobile),u(n.dob))},[n]);return(0,$p.jsx)(IC,{onClose:a,title:`Edit Candidate: ${n.name}`,children:(0,$p.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!s||!o||!c)return alert("Please fill all fields.");if(!/^\d{10}$/.test(o))return alert("Enter a valid 10-digit mobile number.");const r=Rd(Wp,"quizzes",t,"candidates",n.id);await Pp(r,{name:s,mobile:o,dob:c}),alert("Candidate updated successfully."),a()},children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Name"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:s,onChange:e=>i(e.target.value),required:!0})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Mobile"}),(0,$p.jsx)("input",{type:"tel",className:"form-control",value:o,onChange:e=>l(e.target.value),required:!0})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Date of Birth"}),(0,$p.jsx)("input",{type:"date",className:"form-control",value:c,onChange:e=>u(e.target.value),required:!0})]}),(0,$p.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update Candidate"})]})})}const OC=e=>{let{quiz:t,folder:n,questionToEdit:a,onClose:s}=e;const[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(["","","",""]),[u,h]=(0,r.useState)(""),[f,d]=(0,r.useState)(""),[p,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{a?(o(a.questionText),"Multiple Choice"===t.type?(c(a.options||["","","",""]),h(a.correctAnswer||"")):d(a.answerParameters||"")):g()},[a,t.type]);const g=()=>{o(""),c(["","","",""]),h(""),d("")};return(0,$p.jsx)("div",{className:"modal show",style:{display:"block"},children:(0,$p.jsx)("div",{className:"modal-dialog modal-lg",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsxs)("div",{className:"modal-header",children:[(0,$p.jsx)("h5",{className:"modal-title",children:a?"Edit Question":"Add New Question"}),(0,$p.jsx)("button",{type:"button",className:"btn-close",onClick:s})]}),(0,$p.jsxs)("div",{className:"modal-body",children:[(0,$p.jsxs)("ul",{className:"nav nav-tabs mb-3",id:"addQuestionTab",role:"tablist",children:[(0,$p.jsx)("li",{className:"nav-item",role:"presentation",children:(0,$p.jsx)("button",{className:"nav-link active",id:"manual-tab","data-bs-toggle":"tab","data-bs-target":"#manual",type:"button",role:"tab",children:"Manual Entry"})}),(0,$p.jsx)("li",{className:"nav-item",role:"presentation",children:(0,$p.jsx)("button",{className:"nav-link",id:"excel-tab","data-bs-toggle":"tab","data-bs-target":"#excel",type:"button",role:"tab",children:"Import from Excel"})})]}),(0,$p.jsxs)("div",{className:"tab-content",id:"addQuestionTabContent",children:[(0,$p.jsx)("div",{className:"tab-pane fade show active",id:"manual",role:"tabpanel",children:(0,$p.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r={questionText:i,..."Multiple Choice"===t.type?{options:l,correctAnswer:u}:{answerParameters:f}};if(i.trim())try{const e=Id(Wp,"quizzes",t.id,"folders",n.id,"questions");if(a){const e=Rd(Wp,"quizzes",t.id,"folders",n.id,"questions",a.id);await Dp(e,r)}else await Mp(e,r);g(),s()}catch(o){console.error("Error saving question: ",o),alert("Failed to save question.")}else alert("Question text cannot be empty.")},children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Question Text"}),(0,$p.jsx)("textarea",{className:"form-control multilingual-text",rows:"3",value:i,onChange:e=>o(e.target.value),required:!0})]}),"Multiple Choice"===t.type?(0,$p.jsxs)("div",{children:[l.map((e,t)=>(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsxs)("label",{className:"form-label",children:["Option ",t+1]}),(0,$p.jsx)("input",{type:"text",className:"form-control multilingual-text",value:e,onChange:e=>((e,t)=>{const n=[...l];n[e]=t,c(n)})(t,e.target.value),required:!0})]},t)),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Correct Answer"}),(0,$p.jsx)("input",{type:"text",className:"form-control multilingual-text",value:u,onChange:e=>h(e.target.value),required:!0})]})]}):(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Answer Keywords (for auto-scoring)"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:f,onChange:e=>d(e.target.value),required:!0}),(0,$p.jsx)("small",{className:"form-text text-muted",children:"Enter essential keywords separated by commas (e.g., penicillin, alexander fleming, 1928). The answer must contain ALL keywords to be marked correct."})]}),(0,$p.jsxs)("div",{className:"modal-footer px-0 pb-0",children:[(0,$p.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:s,children:"Close"}),(0,$p.jsx)("button",{type:"submit",className:"btn btn-primary",children:a?"Save Changes":"Add Question"})]})]})}),(0,$p.jsxs)("div",{className:"tab-pane fade",id:"excel",role:"tabpanel",children:[(0,$p.jsx)("p",{children:"Upload an Excel file (.xlsx) with the required columns."}),"Multiple Choice"===t.type?(0,$p.jsxs)("small",{className:"d-block mb-3",children:["Columns:"," ",(0,$p.jsx)("strong",{children:"Question, Choice1, Choice2, Choice3, Choice4, CorrectAnswer"})]}):(0,$p.jsxs)("small",{className:"d-block mb-3",children:["Columns: ",(0,$p.jsx)("strong",{children:"Question, AnswerParameters"})," ","(comma-separated keywords)"]}),(0,$p.jsx)("input",{className:"form-control",type:"file",accept:".xlsx",onChange:async e=>{const r=e.target.files[0];if(!r)return;m(!0);const a=new FileReader;a.onload=async e=>{try{const a=uC(new Uint8Array(e.target.result),{type:"array"}),i=a.SheetNames[0],o=a.Sheets[i],l=AC.sheet_to_json(o);if(0===l.length)return alert("The selected file is empty or in the wrong format."),void m(!1);const c=Object.keys(l[0]).map(e=>e.trim()),u=("Multiple Choice"===t.type?["Question","Choice1","Choice2","Choice3","Choice4","CorrectAnswer"]:["Question","AnswerParameters"]).filter(e=>!c.includes(e));if(u.length>0)return alert(`Import failed. Missing required columns: ${u.join(", ")}`),void m(!1);const h=Id(Wp,"quizzes",t.id,"folders",n.id,"questions");let f=0;for(const e of l){var r;const n={questionText:null===(r=e.Question)||void 0===r?void 0:r.trim(),..."Multiple Choice"===t.type?{options:[String(e.Choice1),String(e.Choice2),String(e.Choice3),String(e.Choice4)],correctAnswer:String(e.CorrectAnswer)}:{answerParameters:String(e.AnswerParameters)}};n.questionText&&(await Mp(h,n),f++)}alert(`${f} questions were successfully imported!`),s()}catch(a){console.error("Error importing questions:",a),alert("An error occurred during import. Please check the file format and try again.")}finally{m(!1)}},a.readAsArrayBuffer(r)},disabled:p}),p&&(0,$p.jsx)("div",{className:"mt-2",children:"Processing file..."})]})]})]})]})})})},PC=e=>{let{quiz:t}=e;const[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)([]),[c,u]=(0,r.useState)(!0),[h,f]=(0,r.useState)(!1),[d,p]=(0,r.useState)(""),[m,g]=(0,r.useState)(!1),[v,y]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(null===t||void 0===t||!t.id)return;u(!0);const e=Fp(Id(Wp,"quizzes",t.id,"folders"),e=>{a(e.docs.map(e=>({id:e.id,...e.data()}))),u(!1)});return()=>e()},[t]),(0,r.useEffect)(()=>{if(!s)return void l([]);f(!0);const e=Fp(Id(Wp,"quizzes",t.id,"folders",s.id,"questions"),e=>{l(e.docs.map(e=>({id:e.id,...e.data()}))),f(!1)});return()=>e()},[t,s]);const b=o.filter(e=>e.questionText.toLowerCase().includes(d.toLowerCase()));return s?(0,$p.jsxs)("div",{children:[(0,$p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,$p.jsx)("button",{className:"btn btn-outline-secondary",onClick:()=>i(null),children:"\u2190 Back to Folders"}),(0,$p.jsx)("h3",{children:s.name})]}),(0,$p.jsxs)("div",{className:"card",children:[(0,$p.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,$p.jsxs)("h5",{children:["Questions (",b.length,")"]}),(0,$p.jsx)("button",{className:"btn btn-primary",onClick:()=>{y(null),g(!0)},children:"+ Add Question"})]}),(0,$p.jsx)("div",{className:"p-3 border-bottom",children:(0,$p.jsx)("input",{type:"text",className:"form-control",placeholder:"Search questions...",value:d,onChange:e=>p(e.target.value)})}),(0,$p.jsx)("div",{className:"table-responsive",children:(0,$p.jsxs)("table",{className:"table table-striped table-hover mb-0",children:[(0,$p.jsx)("thead",{children:(0,$p.jsxs)("tr",{children:[(0,$p.jsx)("th",{children:"Question"}),"Multiple Choice"===t.type&&(0,$p.jsx)("th",{children:"Correct Answer"}),"Descriptive"===t.type&&(0,$p.jsx)("th",{children:"Parameters"}),(0,$p.jsx)("th",{children:"Actions"})]})}),(0,$p.jsx)("tbody",{children:h?(0,$p.jsx)("tr",{children:(0,$p.jsx)("td",{colSpan:"3",className:"text-center",children:"Loading questions..."})}):b.map(e=>(0,$p.jsxs)("tr",{children:[(0,$p.jsx)("td",{style:{whiteSpace:"pre-wrap"},children:e.questionText}),(0,$p.jsx)("td",{children:e.correctAnswer||e.answerParameters}),(0,$p.jsxs)("td",{children:[(0,$p.jsx)("button",{className:"btn btn-sm btn-outline-primary me-2",onClick:()=>(y(e),void g(!0)),children:"Edit"}),(0,$p.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>(async e=>{window.confirm("Are you sure you want to delete this question?")&&await Lp(Rd(Wp,"quizzes",t.id,"folders",s.id,"questions",e))})(e.id),children:"Delete"})]})]},e.id))})]})})]}),m&&(0,$p.jsx)(OC,{quiz:t,folder:s,questionToEdit:v,onClose:()=>{g(!1),y(null)}})]}):(0,$p.jsxs)("div",{className:"card",children:[(0,$p.jsx)("div",{className:"card-header",children:(0,$p.jsx)("h5",{children:"Question Folders"})}),c?(0,$p.jsx)("div",{className:"card-body text-center",children:(0,$p.jsx)("p",{children:"Loading folders..."})}):(0,$p.jsx)("div",{className:"list-group list-group-flush",children:n.map(e=>(0,$p.jsxs)("div",{className:"list-group-item d-flex justify-content-between align-items-center",children:[(0,$p.jsx)("span",{children:e.name}),(0,$p.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(e),children:"View Questions"})]},e.id))})]})},DC=e=>{let{quiz:t,result:n,onClose:a}=e;const[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(null!==t&&void 0!==t&&t.id&&n){l(!0);try{const e=Id(Wp,"quizzes",t.id,"folders"),n=await Op(e);let r=[];for(const a of n.docs){const e=Id(Wp,"quizzes",t.id,"folders",a.id,"questions"),n=(await Op(e)).docs.map(e=>({id:e.id,...e.data()}));r=[...r,...n]}i(r)}catch(e){console.error("Error fetching questions for answer sheet:",e)}finally{l(!1)}}})()},[t,n]);const h=e=>s.find(t=>t.id===e),f=(e,t)=>{if(!e||!t)return!1;const n=t.split(",").map(e=>e.trim().toLowerCase()).filter(Boolean),r=e.toLowerCase();return n.length>0&&n.every(e=>r.includes(e))},d=async(e,r)=>{u(!0);try{const a={...n.overrides,[e]:r};let s=0;Object.entries(n.answers).forEach(e=>{let[n,r]=e;const i=h(n);if(!i)return;let o=!1;a.hasOwnProperty(n)?o=a[n]:"Multiple Choice"===t.type?o=r===i.correctAnswer:"Descriptive"===t.type&&(o=f(r,i.answerParameters)),o&&s++});const i=Rd(Wp,"quizzes",t.id,"results",n.id);await Dp(i,{score:s,overrides:a})}catch(a){console.error("Error updating score:",a),alert("Failed to update score.")}finally{u(!1)}};return(0,$p.jsx)("div",{className:"modal show",style:{display:"block"},children:(0,$p.jsx)("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsxs)("div",{className:"modal-header",children:[(0,$p.jsx)("h5",{className:"modal-title",children:"Answer Sheet"}),(0,$p.jsx)("button",{type:"button",className:"btn-close",onClick:a})]}),(0,$p.jsx)("div",{className:"modal-body",children:o?(0,$p.jsx)("p",{children:"Loading answers..."}):Object.entries(n.answers).map(e=>{let[r,a]=e;const s=h(r);if(!s)return null;let i;const o=n.overrides&&n.overrides.hasOwnProperty(r);return o?i=n.overrides[r]:"Multiple Choice"===t.type?i=a===s.correctAnswer:"Descriptive"===t.type&&(i=f(a,s.answerParameters)),(0,$p.jsxs)("div",{className:"mb-4 p-3 border rounded "+(i?"border-success":"border-danger"),children:[(0,$p.jsx)("p",{className:"fw-bold multilingual-text",style:{whiteSpace:"pre-wrap"},children:s.questionText}),"Multiple Choice"===t.type?(0,$p.jsxs)("div",{children:[(0,$p.jsxs)("p",{children:["Candidate's Answer:"," ",(0,$p.jsx)("span",{className:"fw-bold multilingual-text "+(i?"text-success":"text-danger"),children:a}),i?(0,$p.jsx)("span",{className:"ms-2 badge bg-success",children:"Correct"}):(0,$p.jsx)("span",{className:"ms-2 badge bg-danger",children:"Incorrect"})]}),!i&&(0,$p.jsxs)("p",{children:["Correct Answer:"," ",(0,$p.jsx)("span",{className:"text-success fw-bold multilingual-text",children:s.correctAnswer})]})]}):(0,$p.jsxs)("div",{children:[(0,$p.jsx)("p",{className:"fw-bold",children:"Candidate's Answer:"}),(0,$p.jsx)("p",{className:"multilingual-text",style:{whiteSpace:"pre-wrap"},children:a}),(0,$p.jsx)("hr",{}),(0,$p.jsxs)("p",{children:["Required Keywords:"," ",(0,$p.jsx)("span",{className:"text-info",children:s.answerParameters})]}),(0,$p.jsxs)("p",{children:["Status:",i?(0,$p.jsx)("span",{className:"ms-2 badge bg-success",children:"Correct"}):(0,$p.jsx)("span",{className:"ms-2 badge bg-danger",children:"Incorrect"}),o&&(0,$p.jsx)("span",{className:"ms-2 badge bg-warning text-dark",children:"Manually Overridden"})]}),(0,$p.jsxs)("div",{className:"mt-2",children:[(0,$p.jsx)("button",{className:"btn btn-sm btn-outline-success me-2",onClick:()=>d(r,!0),disabled:i||c,children:"Mark as Correct"}),(0,$p.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>d(r,!1),disabled:!i||c,children:"Mark as Incorrect"})]})]})]},r)})}),(0,$p.jsx)("div",{className:"modal-footer",children:(0,$p.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:a,children:"Close"})})]})})})},LC=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(null),[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(15),[h,f]=(0,r.useState)("Multiple Choice"),[d,p]=(0,r.useState)(!0),[m,g]=(0,r.useState)(20),[v,y]=(0,r.useState)(10),[b,w]=(0,r.useState)(!0),[T,E]=(0,r.useState)(""),[S,k]=(0,r.useState)("home"),[_,x]=(0,r.useState)([]),[C,A]=(0,r.useState)([]),[N,I]=(0,r.useState)(""),[R,O]=(0,r.useState)(!1),[P,D]=(0,r.useState)(!1),[M,F]=(0,r.useState)(null),[U,j]=(0,r.useState)(!1),[z,V]=(0,r.useState)(null),[B,H]=(0,r.useState)({registered:0,submissions:0,attendance:0}),[W,q]=(0,r.useState)(!1),[$,G]=(0,r.useState)(null),[K,Q]=(0,r.useState)(""),[X,Y]=(0,r.useState)("");(0,r.useEffect)(()=>{w(!0);const e=Fp(Id(Wp,"quizzes"),e=>{t(e.docs.map(e=>({id:e.id,...e.data()}))),w(!1)},e=>{E("Failed to load quizzes.")});return()=>e()},[]),(0,r.useEffect)(()=>{if(!n||!n.startTime||!n.endTime)return;const e=setInterval(async()=>{const e=new Date,t=new Date(n.startTime),r=new Date(n.endTime),s=n.status;let i=s;if(e>=t&&e<=r?"active"!==s&&(i="active"):e>r&&"active"===s&&(i="inactive"),i!==s){const e=Rd(Wp,"quizzes",n.id);await Dp(e,{status:i}),a(e=>({...e,status:i}))}},1e3);return()=>clearInterval(e)},[n]);const J=(0,r.useCallback)(e=>{if(!e)return;const t=Fp(Id(Wp,"quizzes",e,"candidates"),e=>{x(e.docs.map(e=>({id:e.id,...e.data()})))}),n=Fp(Id(Wp,"quizzes",e,"results"),e=>{A(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>{t(),n()}},[]);(0,r.useEffect)(()=>{if(n){return J(n.id)}},[n,J]),(0,r.useEffect)(()=>{if(n){const e=_.length,t=C.length,r=e>0?(t/e*100).toFixed(1):0;H({registered:e,submissions:t,attendance:r}),Q(n.startTime||""),Y(n.endTime||"")}},[_,C,n]);const Z=async()=>{var e;if(o.trim()&&c&&v&&(!d||m))try{const t=await Mp(Id(Wp,"quizzes"),{name:o,duration:parseInt(c,10),type:h,includePoolQuestions:d,poolQuestionsCount:d?parseInt(m,10):0,fixedQuestionsCount:parseInt(v,10),createdAt:Bp(),status:"inactive"}),n=(Fd(e=Vs(e=Wp,Md)),new zp(e,t=>Up(e,t))),r=Rd(Wp,"quizzes",t.id,"folders","pool_questions");n.set(r,{name:"Pool Questions",createdAt:Bp()});const a=Rd(Wp,"quizzes",t.id,"folders","fixed_questions");n.set(a,{name:"Fixed Questions",createdAt:Bp()}),await n.commit(),l(""),u(15),f("Multiple Choice"),p(!0),g(20),y(10),i(!1)}catch(T){alert("Failed to create quiz.")}else alert("Please fill in all required quiz details.")},ee=async()=>{if($&&$.name.trim()&&$.duration)try{const e=Rd(Wp,"quizzes",$.id);await Dp(e,{name:$.name,duration:parseInt($.duration,10),type:$.type,includePoolQuestions:$.includePoolQuestions,poolQuestionsCount:$.includePoolQuestions?parseInt($.poolQuestionsCount,10):0,fixedQuestionsCount:parseInt($.fixedQuestionsCount,10)}),q(!1),G(null)}catch(T){alert("Failed to update quiz.")}else alert("Please provide a valid name and duration.")},te=()=>function(e){return L(e).signOut()}(qp).catch(e=>console.error("Logout Error:",e)),ne=e=>navigator.clipboard.writeText((e=>`${window.location.origin}/quizegon-quiz/#/quiz/${e}`)(e)).then(()=>alert("Quiz link copied!")),re=_.filter(e=>{var t,n,r;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(N.toLowerCase()))||(null===(n=e.phone)||void 0===n?void 0:n.includes(N))||(null===(r=e.place)||void 0===r?void 0:r.toLowerCase().includes(N.toLowerCase()))}),ae=[...C].sort((e,t)=>{var n,r,a,s;if(t.score!==e.score)return t.score-e.score;return((null===(n=e.submittedAt)||void 0===n?void 0:n.toDate())-(null===(r=e.startTime)||void 0===r?void 0:r.toDate())||1/0)-((null===(a=t.submittedAt)||void 0===a?void 0:a.toDate())-(null===(s=t.startTime)||void 0===s?void 0:s.toDate())||1/0)});return b?(0,$p.jsx)("div",{className:"loading-container",children:"Loading Dashboard..."}):T?(0,$p.jsx)("div",{className:"error-container",children:T}):n?(0,$p.jsxs)($p.Fragment,{children:[(0,$p.jsxs)("header",{className:"d-flex justify-content-between align-items-center p-3 px-4 border-bottom bg-white",children:[(0,$p.jsx)("h1",{className:"h4 m-0 fw-bold text-dark",children:"Meem Quiz"}),(0,$p.jsx)("button",{onClick:te,className:"btn btn-outline-secondary",children:"Logout"})]}),(0,$p.jsxs)("main",{className:"container-fluid p-4",children:[(0,$p.jsx)("div",{className:"mb-4",children:(0,$p.jsx)("button",{onClick:()=>a(null),className:"btn btn-outline-secondary",children:"\u2190 Back to All Quizzes"})}),(0,$p.jsxs)("h2",{className:"h3 mb-3",children:["Manage: ",null===n||void 0===n?void 0:n.name]}),(0,$p.jsxs)("ul",{className:"nav nav-tabs mb-4",children:[(0,$p.jsx)("li",{className:"nav-item",children:(0,$p.jsx)("button",{onClick:()=>k("home"),className:"nav-link "+("home"===S?"active":""),children:"Home"})}),(0,$p.jsx)("li",{className:"nav-item",children:(0,$p.jsx)("button",{onClick:()=>k("candidates"),className:"nav-link "+("candidates"===S?"active":""),children:"Candidates"})}),(0,$p.jsx)("li",{className:"nav-item",children:(0,$p.jsx)("button",{onClick:()=>k("questions"),className:"nav-link "+("questions"===S?"active":""),children:"Questions"})}),(0,$p.jsx)("li",{className:"nav-item",children:(0,$p.jsx)("button",{onClick:()=>k("result"),className:"nav-link "+("result"===S?"active":""),children:"Result"})})]}),(0,$p.jsxs)("div",{className:"management-content",children:["home"===S&&(0,$p.jsxs)("div",{children:[(0,$p.jsxs)("div",{className:"card mb-4",children:[(0,$p.jsx)("div",{className:"card-header",children:(0,$p.jsx)("h5",{children:"Quiz Controls"})}),(0,$p.jsx)("div",{className:"card-body",children:(0,$p.jsxs)("div",{className:"row",children:[(0,$p.jsxs)("div",{className:"col-md-6",children:[(0,$p.jsx)("h6",{children:"Manual Control"}),(0,$p.jsxs)("p",{className:"mb-2",children:["Current Status:"," ",(0,$p.jsx)("strong",{className:"text-capitalize",children:n.status})]}),(0,$p.jsx)("button",{onClick:async()=>{const e="active"===n.status?"inactive":"active";try{await Dp(Rd(Wp,"quizzes",n.id),{status:e,startTime:null,endTime:null}),a(t=>({...t,status:e,startTime:null,endTime:null}))}catch(T){alert("Failed to update quiz status.")}},className:"btn "+("active"===n.status?"btn-danger":"btn-success"),children:"active"===n.status?"End Quiz Now":"Start Quiz Now"})]}),(0,$p.jsxs)("div",{className:"col-md-6",children:[(0,$p.jsx)("h6",{children:"Schedule Quiz"}),n.startTime&&n.endTime&&(0,$p.jsxs)("div",{className:"alert alert-info",children:["Scheduled from"," ",new Date(n.startTime).toLocaleString()," to"," ",new Date(n.endTime).toLocaleString()]}),(0,$p.jsxs)("div",{className:"mb-2",children:[(0,$p.jsx)("label",{className:"form-label",children:"Start Time"}),(0,$p.jsx)("input",{type:"datetime-local",value:K,onChange:e=>Q(e.target.value),className:"form-control"})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"End Time"}),(0,$p.jsx)("input",{type:"datetime-local",value:X,onChange:e=>Y(e.target.value),className:"form-control"})]}),(0,$p.jsx)("button",{onClick:async()=>{if(K&&X)try{await Dp(Rd(Wp,"quizzes",n.id),{startTime:K,endTime:X,status:"inactive"}),a(e=>({...e,startTime:K,endTime:X,status:"inactive"})),alert("Quiz schedule updated successfully.")}catch(T){alert("Failed to schedule quiz.")}else alert("Please set both a start and end time.")},className:"btn btn-secondary",children:"Set Schedule"})]})]})})]}),(0,$p.jsxs)("div",{className:"row g-4",children:[(0,$p.jsx)("div",{className:"col-md-4",children:(0,$p.jsx)("div",{className:"card text-center h-100",children:(0,$p.jsxs)("div",{className:"card-body",children:[(0,$p.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:"Total Candidates"}),(0,$p.jsx)("p",{className:"card-text fs-1 fw-bold",children:B.registered})]})})}),(0,$p.jsx)("div",{className:"col-md-4",children:(0,$p.jsx)("div",{className:"card text-center h-100",children:(0,$p.jsxs)("div",{className:"card-body",children:[(0,$p.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:"Submissions"}),(0,$p.jsx)("p",{className:"card-text fs-1 fw-bold",children:B.submissions})]})})}),(0,$p.jsx)("div",{className:"col-md-4",children:(0,$p.jsx)("div",{className:"card text-center h-100",children:(0,$p.jsxs)("div",{className:"card-body",children:[(0,$p.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:"Attendance Rate"}),(0,$p.jsxs)("p",{className:"card-text fs-1 fw-bold",children:[B.attendance,"%"]})]})})})]})]}),"candidates"===S&&(0,$p.jsxs)("div",{className:"card",children:[(0,$p.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,$p.jsxs)("h5",{children:["Candidate List (",re.length,")"]}),(0,$p.jsx)("button",{onClick:()=>O(!0),className:"btn btn-primary",children:"+ Add Candidates"})]}),(0,$p.jsx)("div",{className:"p-3 border-bottom",children:(0,$p.jsx)("input",{type:"text",placeholder:"Search by name, place, or phone...",value:N,onChange:e=>I(e.target.value),className:"form-control"})}),(0,$p.jsx)("div",{className:"table-responsive",children:(0,$p.jsxs)("table",{className:"table table-striped table-hover mb-0",children:[(0,$p.jsx)("thead",{children:(0,$p.jsxs)("tr",{children:[(0,$p.jsx)("th",{children:"Name"}),(0,$p.jsx)("th",{children:"Place"}),(0,$p.jsx)("th",{children:"Phone Number"}),(0,$p.jsx)("th",{children:"Status"}),(0,$p.jsx)("th",{children:"Actions"})]})}),(0,$p.jsx)("tbody",{children:re.map(e=>{const t=(e=>C.find(t=>t.id===e.phone)?{text:"Attended",class:"bg-success"}:"attending"===e.status?{text:"Attending",class:"bg-primary"}:{text:"Not Attended",class:"bg-secondary"})(e);return(0,$p.jsxs)("tr",{children:[(0,$p.jsx)("td",{children:e.name}),(0,$p.jsx)("td",{children:e.place}),(0,$p.jsx)("td",{children:e.phone}),(0,$p.jsx)("td",{children:(0,$p.jsx)("span",{className:`badge ${t.class}`,children:t.text})}),(0,$p.jsxs)("td",{children:[(0,$p.jsx)("button",{onClick:()=>{F(e),D(!0)},className:"btn btn-sm btn-outline-primary me-2",children:"Edit"}),(0,$p.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this candidate?"))try{if(await Lp(Rd(Wp,"quizzes",n.id,"candidates",e.id)),e.phone){const t=Rd(Wp,"quizzes",n.id,"results",e.phone);await Lp(t)}}catch(T){alert("Failed to delete candidate.")}})(e),className:"btn btn-sm btn-outline-danger",children:"Delete"})]})]},e.id)})})]})})]}),"questions"===S&&(0,$p.jsx)(PC,{quiz:n}),"result"===S&&(0,$p.jsxs)("div",{className:"card",children:[(0,$p.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,$p.jsxs)("h5",{children:["Quiz Results (",ae.length," submissions)"]}),(0,$p.jsx)("button",{onClick:async()=>{if(0===C.length)return void alert("No results to download.");const e=await Promise.all(ae.map(async e=>{var t,n;const r=_.find(t=>t.phone===e.id)||{name:"N/A",place:"N/A"},a=null===(t=e.startTime)||void 0===t?void 0:t.toDate(),s=null===(n=e.submittedAt)||void 0===n?void 0:n.toDate();let i="N/A";if(a&&s){const e=s-a;i=`${Math.floor(e/6e4)}m ${Math.round(e%6e4/1e3)}s`}return{Rank:ae.indexOf(e)+1,Name:r.name,Place:r.place,"Phone Number":e.id,Score:`${e.score} / ${e.totalQuestions}`,"Time Taken":i}})),t=AC.json_to_sheet(e),r=AC.book_new();AC.book_append_sheet(r,t,"Results"),function(e,t,n){var r=n||{};r.type="file",r.file=t,gC(r),mC(e,r)}(r,`${n.name}_Results.xlsx`)},className:"btn btn-success",children:"Download Results"})]}),(0,$p.jsx)("div",{className:"table-responsive",children:(0,$p.jsxs)("table",{className:"table table-striped table-hover mb-0",children:[(0,$p.jsx)("thead",{children:(0,$p.jsxs)("tr",{children:[(0,$p.jsx)("th",{children:"Rank"}),(0,$p.jsx)("th",{children:"Candidate Name"}),(0,$p.jsx)("th",{children:"Score"}),(0,$p.jsx)("th",{children:"Time Taken"}),(0,$p.jsx)("th",{children:"Actions"})]})}),(0,$p.jsx)("tbody",{children:ae.map((e,t)=>{var n,r;const a=_.find(t=>t.phone===e.id),s=null===(n=e.startTime)||void 0===n?void 0:n.toDate(),i=null===(r=e.submittedAt)||void 0===r?void 0:r.toDate();let o="N/A";if(s&&i){const e=i-s;o=`${Math.floor(e/6e4)}m ${Math.round(e%6e4/1e3)}s`}return(0,$p.jsxs)("tr",{children:[(0,$p.jsx)("td",{children:t+1}),(0,$p.jsx)("td",{children:a?a.name:"Unknown"}),(0,$p.jsxs)("td",{children:[e.score," / ",e.totalQuestions]}),(0,$p.jsx)("td",{children:o}),(0,$p.jsx)("td",{children:(0,$p.jsx)("button",{onClick:()=>{V(e),j(!0)},className:"btn btn-sm btn-outline-info",children:"View Answers"})})]},e.id)})})]})})]})]})]}),R&&n&&(0,$p.jsx)(NC,{quizId:n.id,onClose:()=>O(!1)}),P&&M&&n&&(0,$p.jsx)(RC,{quizId:n.id,candidate:M,onClose:()=>{D(!1),F(null)}}),U&&z&&n&&(0,$p.jsx)(DC,{quiz:n,result:z,onClose:()=>{j(!1),V(null)}})]}):(0,$p.jsxs)($p.Fragment,{children:[(0,$p.jsxs)("header",{className:"d-flex justify-content-between align-items-center p-3 px-4 border-bottom bg-white",children:[(0,$p.jsx)("h1",{className:"h4 m-0 fw-bold text-dark",children:"Meem Quiz"}),(0,$p.jsx)("button",{onClick:te,className:"btn btn-outline-secondary",children:"Logout"})]}),(0,$p.jsxs)("main",{className:"container-fluid p-4",children:[(0,$p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,$p.jsx)("h2",{className:"h3",children:"Admin Dashboard"}),(0,$p.jsx)("button",{onClick:()=>i(!0),className:"btn btn-primary",children:"+ Create New Quiz"})]}),(0,$p.jsx)("div",{className:"row g-4",children:e.map(e=>{const t=(e.includePoolQuestions&&e.poolQuestionsCount||0)+(e.fixedQuestionsCount||0);return(0,$p.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,$p.jsx)("div",{className:"card h-100 shadow-sm",children:(0,$p.jsxs)("div",{className:"card-body d-flex flex-column",children:[(0,$p.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,$p.jsx)("h5",{className:"card-title",children:e.name}),(0,$p.jsxs)("div",{className:"dropdown",children:[(0,$p.jsx)("button",{className:"btn btn-sm btn-light",type:"button","data-bs-toggle":"dropdown",children:"\u22ee"}),(0,$p.jsxs)("ul",{className:"dropdown-menu dropdown-menu-end",children:[(0,$p.jsx)("li",{children:(0,$p.jsx)("button",{className:"dropdown-item",onClick:()=>(e=>{G({...e,includePoolQuestions:!1!==e.includePoolQuestions,poolQuestionsCount:e.poolQuestionsCount||20,fixedQuestionsCount:e.fixedQuestionsCount||10}),q(!0)})(e),children:"Edit"})}),(0,$p.jsx)("li",{children:(0,$p.jsx)("button",{className:"dropdown-item text-danger",onClick:()=>(async e=>{window.confirm("Are you sure you want to delete this quiz and all its data? This action cannot be undone.")&&(await Lp(Rd(Wp,"quizzes",e)),n&&n.id===e&&a(null))})(e.id),children:"Delete"})})]})]})]}),(0,$p.jsxs)("p",{className:"card-subtitle mb-2 text-muted small",children:["Total Questions: ",t]}),(0,$p.jsxs)("div",{className:"mt-auto pt-3 d-flex justify-content-between align-items-center",children:[(0,$p.jsx)("button",{onClick:()=>a(e),className:"btn btn-primary",children:"Manage"}),(0,$p.jsx)("button",{onClick:()=>ne(e.id),className:"btn btn-outline-secondary",children:"Copy Link"})]})]})})},e.id)})})]}),s&&(0,$p.jsx)("div",{className:"modal show",style:{display:"block"},children:(0,$p.jsx)("div",{className:"modal-dialog",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsxs)("div",{className:"modal-header",children:[(0,$p.jsx)("h5",{className:"modal-title",children:"Create New Quiz"}),(0,$p.jsx)("button",{type:"button",className:"btn-close",onClick:()=>i(!1)})]}),(0,$p.jsxs)("div",{className:"modal-body",children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Quiz Name"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:o,onChange:e=>l(e.target.value)})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Duration (minutes)"}),(0,$p.jsx)("input",{type:"number",className:"form-control",value:c,onChange:e=>u(e.target.value)})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Quiz Type"}),(0,$p.jsxs)("select",{className:"form-select",value:h,onChange:e=>f(e.target.value),children:[(0,$p.jsx)("option",{children:"Multiple Choice"}),(0,$p.jsx)("option",{children:"Descriptive"})]})]}),(0,$p.jsxs)("div",{className:"form-check mb-3",children:[(0,$p.jsx)("input",{className:"form-check-input",type:"checkbox",checked:d,onChange:e=>p(e.target.checked),id:"includePoolCheck"}),(0,$p.jsx)("label",{className:"form-check-label",htmlFor:"includePoolCheck",children:"Include Pool Questions"})]}),d&&(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Number of Pool Questions"}),(0,$p.jsx)("input",{type:"number",className:"form-control",value:m,onChange:e=>g(e.target.value)})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Number of Fixed Questions"}),(0,$p.jsx)("input",{type:"number",className:"form-control",value:v,onChange:e=>y(e.target.value)})]})]}),(0,$p.jsxs)("div",{className:"modal-footer",children:[(0,$p.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),children:"Close"}),(0,$p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:Z,children:"Create Quiz"})]})]})})}),W&&$&&(0,$p.jsx)("div",{className:"modal show",style:{display:"block"},children:(0,$p.jsx)("div",{className:"modal-dialog",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsxs)("div",{className:"modal-header",children:[(0,$p.jsx)("h5",{className:"modal-title",children:"Edit Quiz"}),(0,$p.jsx)("button",{type:"button",className:"btn-close",onClick:()=>q(!1)})]}),(0,$p.jsxs)("div",{className:"modal-body",children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Quiz Name"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:$.name,onChange:e=>G({...$,name:e.target.value})})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Duration (minutes)"}),(0,$p.jsx)("input",{type:"number",className:"form-control",value:$.duration,onChange:e=>G({...$,duration:e.target.value})})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Quiz Type"}),(0,$p.jsxs)("select",{className:"form-select",value:$.type,onChange:e=>G({...$,type:e.target.value}),children:[(0,$p.jsx)("option",{children:"Multiple Choice"}),(0,$p.jsx)("option",{children:"Descriptive"})]})]}),(0,$p.jsxs)("div",{className:"form-check mb-3",children:[(0,$p.jsx)("input",{className:"form-check-input",type:"checkbox",checked:$.includePoolQuestions,onChange:e=>G({...$,includePoolQuestions:e.target.checked}),id:"editIncludePool"}),(0,$p.jsx)("label",{className:"form-check-label",htmlFor:"editIncludePool",children:"Include Pool Questions"})]}),$.includePoolQuestions&&(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Number of Pool Questions"}),(0,$p.jsx)("input",{type:"number",className:"form-control",value:$.poolQuestionsCount,onChange:e=>G({...$,poolQuestionsCount:e.target.value})})]}),(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Number of Fixed Questions"}),(0,$p.jsx)("input",{type:"number",className:"form-control",value:$.fixedQuestionsCount,onChange:e=>G({...$,fixedQuestionsCount:e.target.value})})]})]}),(0,$p.jsxs)("div",{className:"modal-footer",children:[(0,$p.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>q(!1),children:"Close"}),(0,$p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:ee,children:"Save Changes"})]})]})})})]})},MC=e=>{let{quizId:t,onLoginSuccess:n}=e;const[a,s]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[f,d]=(0,r.useState)(null),[p,m]=(0,r.useState)(!0),[g,v]=(0,r.useState)(null),[y,b]=(0,r.useState)("login");(0,r.useEffect)(()=>{(async()=>{if(!t)return c("Invalid quiz link."),void m(!1);m(!0);try{const e=Rd(Wp,"quizzes",t),n=await Ip(e);n.exists()?d({id:n.id,...n.data()}):c("This quiz does not exist.")}catch(e){c("Could not load quiz details. Please check the link.")}finally{m(!1)}})()},[t]);const w=()=>{n(g)};return p?(0,$p.jsx)("div",{className:"loading-container",children:"Loading Quiz..."}):"welcome"===y?(0,$p.jsx)("div",{className:"login-container",children:(0,$p.jsxs)("div",{className:"login-card p-4",style:{maxWidth:"600px"},children:[(0,$p.jsxs)("h2",{className:"text-center",children:["Welcome, ",g.name,"!"]}),(0,$p.jsx)("p",{className:"text-center text-muted",children:"Please confirm your details below."}),(0,$p.jsxs)("div",{className:"candidate-details my-4 p-3 bg-light rounded",children:[(0,$p.jsxs)("p",{children:[(0,$p.jsx)("strong",{children:"Place:"})," ",g.place]}),(0,$p.jsxs)("p",{children:[(0,$p.jsx)("strong",{children:"Phone Number:"})," ",g.phone]})]}),(0,$p.jsx)("hr",{}),(0,$p.jsx)("h4",{className:"text-center",children:"Quiz Guidelines"}),(0,$p.jsxs)("ul",{className:"guidelines",children:[(0,$p.jsxs)("li",{children:["The quiz duration is ",(0,$p.jsxs)("strong",{children:[f.duration," minutes"]}),"."]}),(0,$p.jsx)("li",{children:"Do not switch tabs or windows. Doing so twice will automatically submit your quiz."}),(0,$p.jsx)("li",{children:"Copying, pasting, and right-clicking are disabled."}),(0,$p.jsx)("li",{children:"Ensure you have a stable internet connection."}),(0,$p.jsx)("li",{children:'Click "Start Quiz" when you are ready to begin. The timer will start immediately.'})]}),(0,$p.jsx)("button",{onClick:w,className:"btn btn-success btn-lg w-100 mt-3",children:"Start Quiz"})]})}):(0,$p.jsx)("div",{className:"login-container",children:(0,$p.jsxs)("div",{className:"login-card",children:[(0,$p.jsx)("h2",{className:"text-center",children:"Candidate Login"}),(0,$p.jsx)("p",{className:"text-center text-muted mb-4",children:(null===f||void 0===f?void 0:f.name)||"Welcome to the Test"}),(0,$p.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),h(!0),c(""),!f)return c("Quiz details are not loaded yet. Please wait a moment."),void h(!1);const n=new Date,r=f.startTime?new Date(f.startTime):null,s=f.endTime?new Date(f.endTime):null;let o="active"===f.status;if(r&&s){if(!(n>=r&&n<=s))return c("The quiz is not active at this time."),void h(!1);o=!0}if(!o)return c("The quiz is not currently active. Please contact the administrator."),void h(!1);try{const e=function(e,t){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];t instanceof gp&&n.push(t),n=n.concat(a),function(e){const t=e.filter(e=>e instanceof bp).length,n=e.filter(e=>e instanceof yp).length;if(t>1||t>0&&n>0)throw new fs(hs.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}(Id(Wp,"quizzes",t,"candidates"),function(e,t,n){const r=t,a=pp("where",e);return yp._create(a,r,n)}("phone","==",a)),n=await Op(e);if(n.empty)return c("This phone number is not registered for this quiz."),void h(!1);let r=null;if(n.forEach(e=>{e.data().password===i&&(r={id:e.id,...e.data()})}),r){const e=Rd(Wp,"quizzes",t,"results",r.phone);if((await Ip(e)).exists())return c("You have already submitted this quiz."),void h(!1);const n=Rd(Wp,"quizzes",t,"candidates",r.id);await Dp(n,{status:"attending",startTime:Bp()}),v(r),b("welcome")}else c("Incorrect password.")}catch(l){console.error("Login error:",l),c("An error occurred. Please try again.")}finally{h(!1)}},children:[(0,$p.jsxs)("div",{className:"mb-3",children:[(0,$p.jsx)("label",{className:"form-label",children:"Phone Number"}),(0,$p.jsx)("input",{type:"text",className:"form-control",value:a,onChange:e=>s(e.target.value),required:!0,disabled:u})]}),(0,$p.jsxs)("div",{className:"mb-4",children:[(0,$p.jsx)("label",{className:"form-label",children:"Password"}),(0,$p.jsx)("input",{type:"password",className:"form-control",value:i,onChange:e=>o(e.target.value),required:!0,disabled:u})]}),l&&(0,$p.jsx)("div",{className:"alert alert-danger",children:l}),(0,$p.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:u,children:u?"Logging in...":"Login & Start Quiz"})]})]})})},FC=e=>{let{quizId:t,candidate:n,onQuizComplete:a}=e;const[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)([]),[c,u]=(0,r.useState)(0),[h,f]=(0,r.useState)({}),[d,p]=(0,r.useState)([]),[m,g]=(0,r.useState)(null),[v,y]=(0,r.useState)(!0),[b,w]=(0,r.useState)(""),[T,E]=(0,r.useState)(!1),[S,k]=(0,r.useState)(null),_=(0,r.useRef)(h),x=(0,r.useRef)();(0,r.useEffect)(()=>{_.current=h},[h]),(0,r.useEffect)(()=>{(async()=>{if(t&&null!==n&&void 0!==n&&n.id)try{const e=Rd(Wp,"quizzes",t,"candidates",n.id),r=await Ip(e);r.exists()&&k({id:r.id,...r.data()})}catch(b){console.error("Error fetching fresh candidate data:",b),w("Could not load your session details. Please try refreshing.")}})()},[t,n]);const C=e=>{const t=[...e];for(let n=t.length-1;n>0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t},A=(0,r.useCallback)(async()=>{try{const e=Rd(Wp,"quizzes",t),n=await Ip(e);if(!n.exists())throw new Error("Quiz not found.");const r={id:n.id,...n.data()};i(r),g(60*r.duration);const a=Id(Wp,"quizzes",t,"folders"),s=await Op(a);let o=[],c=[];for(const i of s.docs){const e=Id(Wp,"quizzes",t,"folders",i.id,"questions"),n=(await Op(e)).docs.map(e=>({id:e.id,...e.data()}));"Pool Questions"===i.data().name?o.push(...n):"Fixed Questions"===i.data().name&&c.push(...n)}let u=[];const h=r.fixedQuestionsCount||0,f=r.includePoolQuestions&&r.poolQuestionsCount||0;if(h>0&&u.push(...C(c).slice(0,h)),f>0&&u.push(...C(o).slice(0,f)),l(C(u)),0===u.length)throw new Error("No questions are available for this quiz at the moment.")}catch(e){console.error(e),w(e.message)}finally{y(!1)}},[t]);(0,r.useEffect)(()=>{A()},[A]);const N=(0,r.useCallback)(async()=>{const e=S,n=_.current;if(!e||!e.phone||!e.startTime)return console.error("Submission failed: Candidate data or start time is missing.",e),void w("An error occurred during submission. Missing essential data.");try{let r=0;"Multiple Choice"===s.type?o.forEach(e=>{n[e.id]===e.correctAnswer&&r++}):"Descriptive"===s.type&&o.forEach(e=>{const t=n[e.id]||"",a=(e.answerParameters||"").split(",").map(e=>e.trim().toLowerCase()).filter(Boolean),s=t.toLowerCase();a.length>0&&a.every(e=>s.includes(e))&&r++});const a={answers:n,submittedAt:Bp(),startTime:e.startTime,score:r,totalQuestions:o.length,candidateDocId:e.id};await Pp(Rd(Wp,"quizzes",t,"results",e.phone),a),E(!0)}catch(r){console.error("Error submitting quiz:",r),w("There was an error submitting your quiz. Please try again.")}},[s,o,t,S]);(0,r.useEffect)(()=>{x.current=N},[N]),(0,r.useEffect)(()=>{if(null===m||0===m)return void(0===m&&x.current());const e=setInterval(()=>g(e=>e-1),1e3);return()=>clearInterval(e)},[m]);const I=(e,t)=>f(n=>({...n,[e]:t}));if(v||!S)return(0,$p.jsx)("div",{className:"loading-container",children:"Preparing your quiz..."});if(b)return(0,$p.jsx)("div",{className:"error-container",children:b});const R=o[c],O=Math.floor(m/60),P=m%60,D=d.includes(null===R||void 0===R?void 0:R.id);return(0,$p.jsxs)("div",{className:"quiz-page-container",children:[(0,$p.jsxs)("header",{className:"quiz-page-header",children:[(0,$p.jsx)("h1",{className:"h4 m-0 fw-bold text-dark",children:"Quizegon"}),(0,$p.jsx)("button",{className:"btn btn-outline-secondary",onClick:()=>x.current(),children:"Logout"})]}),(0,$p.jsxs)("div",{className:"timer-bar",children:["Time Left: ",O,":",P<10?`0${P}`:P]}),(0,$p.jsxs)("main",{className:"quiz-main-content",children:[R&&(0,$p.jsxs)("div",{className:"question-card-main",children:[(0,$p.jsxs)("div",{className:"question-header",children:[(0,$p.jsxs)("p",{className:"question-number",children:["Question ",c+1," of ",o.length]}),(0,$p.jsx)("button",{onClick:()=>{var e;const t=null===(e=o[c])||void 0===e?void 0:e.id;t&&p(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"btn btn-sm "+(D?"btn-warning":"btn-outline-warning"),children:D?"Unmark Question":"Mark for Review"})]}),(0,$p.jsx)("h3",{className:"question-text multilingual-text",style:{whiteSpace:"pre-wrap"},children:R.questionText}),"Multiple Choice"===s.type?(0,$p.jsx)("div",{className:"options-grid-container",children:(0,$p.jsx)("div",{className:"options-grid",children:R.options.map((e,t)=>(0,$p.jsx)("button",{onClick:()=>I(R.id,e),className:"option-btn multilingual-text "+(h[R.id]===e?"selected":""),children:e},t))})}):(0,$p.jsxs)("div",{className:"descriptive-answer",children:[(0,$p.jsx)("textarea",{rows:"8",className:"form-control multilingual-text",placeholder:"Type your answer here...",value:h[R.id]||"",onChange:e=>I(R.id,e.target.value)}),R.answerParameters&&(0,$p.jsxs)("small",{className:"form-text text-muted mt-2 d-block",children:[(0,$p.jsx)("strong",{children:"Keywords:"})," ",R.answerParameters]})]})]}),(0,$p.jsxs)("div",{className:"quiz-navigation-footer",children:[(0,$p.jsxs)("div",{className:"prev-next-container",children:[(0,$p.jsx)("button",{onClick:()=>{c>0&&u(e=>e-1)},disabled:0===c,className:"btn btn-secondary nav-btn",children:"\u2190 Previous"}),(0,$p.jsx)("button",{onClick:()=>{c<o.length-1&&u(e=>e+1)},disabled:c===o.length-1,className:"btn btn-primary nav-btn",children:"Next \u2192"})]}),(0,$p.jsx)("button",{onClick:()=>x.current(),className:"btn btn-danger submit-btn",children:"Submit Quiz"})]}),(0,$p.jsxs)("div",{className:"question-navigation-card",children:[(0,$p.jsx)("h5",{children:"Question Navigation"}),(0,$p.jsx)("div",{className:"question-grid",children:o.map((e,t)=>{const n=t===c,r=!!h[e.id],a=d.includes(e.id),s=["grid-item"];return n?s.push("current"):r&&s.push("answered"),a&&s.push("marked"),(0,$p.jsx)("button",{onClick:()=>u(t),className:s.join(" "),children:t+1},e.id)})}),(0,$p.jsxs)("div",{className:"legend",children:[(0,$p.jsx)("span",{className:"legend-item answered",children:"Answered"}),(0,$p.jsx)("span",{className:"legend-item not-answered",children:"Not Answered"}),(0,$p.jsx)("span",{className:"legend-item current",children:"Current"}),(0,$p.jsx)("span",{className:"legend-item marked",children:"Marked for Review"})]})]})]}),T&&(0,$p.jsx)("div",{className:"modal show",style:{display:"block"},children:(0,$p.jsx)("div",{className:"modal-dialog",children:(0,$p.jsxs)("div",{className:"modal-content",children:[(0,$p.jsx)("div",{className:"modal-header",children:(0,$p.jsx)("h5",{className:"modal-title",children:"Submission Successful"})}),(0,$p.jsx)("div",{className:"modal-body",children:(0,$p.jsx)("p",{children:"Your quiz has been successfully submitted."})}),(0,$p.jsx)("div",{className:"modal-footer",children:(0,$p.jsx)("button",{type:"button",className:"btn btn-primary",onClick:a,children:"OK"})})]})})})]})};const UC=function(){const[e,t]=(0,r.useState)("loading"),[n,a]=(0,r.useState)(null),[s,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=window.location.hash.slice(1).split("/"),n=function(e,t,n,r){return L(e).onAuthStateChanged(t,n,r)}(qp,async n=>{n&&await(async e=>!!e&&"shakirokm@gmail.com"===e.email)(n)?t("adminDashboard"):"quiz"===e[1]&&e[2]?(a(e[2]),t("candidateLogin")):t("adminLogin")});return()=>n()},[]);const o=e=>{i(e),t("quiz")},l=()=>{i(null);const e=window.location.hash.slice(1).split("/");"quiz"===e[1]&&e[2]?t("candidateLogin"):t("adminLogin")},c=()=>{t("adminLogin")};return(0,$p.jsx)("div",{className:"app-container",children:(()=>{switch(e){case"adminLogin":return(0,$p.jsx)(Gp,{onAdminLogin:()=>t("adminDashboard")});case"adminDashboard":return(0,$p.jsx)(LC,{onLogout:c});case"candidateLogin":return(0,$p.jsx)(MC,{quizId:n,onLoginSuccess:o});case"quiz":return s?(0,$p.jsx)(FC,{quizId:n,candidate:s,onQuizComplete:l}):(l(),(0,$p.jsx)("div",{children:"Redirecting to login..."}));default:return(0,$p.jsx)("div",{className:"loading-container",children:"Loading Application..."})}})()})};!function(){var e=sessionStorage.redirect;delete sessionStorage.redirect,e&&e!==window.location.href&&history.replaceState(null,null,e)}();a.createRoot(document.getElementById("root")).render((0,$p.jsx)(r.StrictMode,{children:(0,$p.jsx)(UC,{})}))})();
//# sourceMappingURL=main.66af1c46.js.map